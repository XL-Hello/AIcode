接口协议规范

一、协议规范原则：

使用MQTT

设备相关的消息（如：设备控制、属性上报）、通知类消息使用MQTT协议， 其他服务类消息交互使用repHTTP协议（比bindToken如：天气查询、家庭管理）

MQTT只作为云服务和终端的通信链路OtaCheckgetDeviceList

MQTT的clientId 内部定义为MID。 中控屏的MID = UID， APP的MID = 安装ID。

MQTT payload分两层， 第一层为二进制数据，固定24字节。第二层为JSON格式，暂定为json字符串。

resID,  设备 = deviceID，  应用 = xxID

控制、属性消息直达（不经过云服务的业务处理）

消息的分类信息放在Topic中，  v1/{uid}/123/deviceCtrl

{"deviceId":"123", "ctrlType":"setProps/setCmd", "property":{"onoff":"on"}}

二、MQTT Topic设计

1. 变量名说明

aspId：app 唯一id（作用同appSetupId）

deviceId: 逻辑设备的id

uid： 设备通信唯一uuid,  服务器按照雪花算法生成64bit数据，表示为十六进制字符串

sourceType取值：device， app， server

souceId取值：     uid， aspId， 空（null）

cmd：业务接口名称

MID：MQTT的clientId 内部定义为MID。 中控屏的MID = UID， APP的MID = 安装ID （aspId）

srcId(dstId) : deviceId,  appId( 网关Id )

2. 发布topic

目的地为设备： v1/{MID}/{cmd}

目的地为app：   v1/{MID}/{cmd}

目的地为server：v1/server/{cmd}

目的地为家庭：  v1/family/{familyId}/{cmd}

3. 订阅topic

设备：v1/{MID}/# ,   v1/family/{所在familyId}/#

app： v1/{MID}/#,   v1/family/{所在familyId}/#

server：v1/server/# ,  v1/family/#,  v1/{deviceId}/deviceCtrl  (扫地机控制命令)

三、MQTT 协议payload公共参数

Payload header： 前64字节， 包含DST_RESID+SRC_RESID ，定义详见协议讨论

Payload json： 除去header部分其他字节码解析

请求公共参数

reqId: 请求唯一标识， 

intent: 操作指令(cmd)

sourceType：消息来源，取值：device， app， server

sourceId： uid， aspId， null(来源为服务器，为空)

loginToken: xxx.xxx.xxx 登录返回的token （https协议作为Token放Header）

响应公共参数dstResId

reqId: 对应请求ID

code: 状态码(200为成功， 其他为失败)

msg: 结果描述

sourceType：消息来源，取值：device， app， server

sourceId： uid， aspId， null(来源为服务器时，为空)

四、HTTPS接口协议公共参数

1. Host： https://api.zorme.tech

2. 请求方法：POST

3. 分页参数：

URI + "?pageNum=1&pageSize=100"

pageNum: 第几页，从1开始,  页数超过最大页数，则返回最后一页数据;

pageSize：每页数据条数，大于0

4. 协议头：

 Auth: HGXC_CLIENT（固定写法） + 空格 + 时间戳（秒级） + 空格 + 32位随机字符串 + 空格 + 签名

 Token: 登录token （登录接口返回, 登录前的业务接口不校验该项）

 Content-Type: application/json

示例：

| HTTP<br> Auth: HGXC_CLIENT 1748327138 91c4c11d27d740809c6957cc3f0f901d B17F60F1AA493CE0174C35A53F5AF98BFDD040B55FC98D175EAEAD2F54BE31C6<br> Token: eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJ1c2VySWQiLCJleHAiOjE3NTY2MzMzNzd9.ZrC6CPzzV9NH-KLCQdB70oBd-qvjXw3xWxFCA0zwh8A<br> Content-Type: application/json |
| --- |

签名规则：

构造签名串

签名串一共有四行，每一行为一个参数。结尾以\n（换行符，ASCII编码值为0x0A）结束，包括最后一行。如果参数本身以\n结束，也需要附加一个\n。

| HTTP<br>签名串<br>URI\n<br>请求时间戳（秒级）\n<br>请求随机串\n<br>请求报文主体body\n |
| --- |

签名串示例1（Get没有body）：

| HTTP<br>签名串<br>/family/fmyAdd?familyName=xxx&userId=abcddes\n <br>1554208460\n <br>91c4c11d27d740809c6957cc3f0f901d\n <br>\n |
| --- |

签名串示例2（Post包含body）：

| Bash<br>签名串<br>/family/fmyAdd\n <br>1748328523\n <br>ac7057369c70450f8af4776e748a23f5\n <br>{"reqId":"dsadfaadsfvasfsa1","familyName":"我的家庭","userId":"U123456789","sourceType":"app","sourceId":"d82a9ebd66474142ac86caad98e1e0a1"}\n |
| --- |

计算签名值

 签名算法： HMACSHA256（签名串）

 签名key：   af5f2d8ac5334d90b54d0c067c972dce （开发和测试环境使用）

如上述示例2的签名串，经过签名计算后，结果为（十六进制表示）：A060740B241AADF3E4BC997CBD77BA4D08B05BAD5666EDFD233843995158462E

协议头Auth为：

HGXC_CLIENT 1748328523 ac7057369c70450f8af4776e748a23f5 A060740B241AADF3E4BC997CBD77BA4D08B05BAD5666EDFD233843995158462E

（注意：上述分隔符都是空格）

5. 请求body：

application/json

reqId: 请求唯一标识，

6. 响应:

code: 状态码(200为成功， 其他为失败)

msg: 结果描述

data: 数据对象列表（查询特定列表数据有该字段，详见具体协议）

reqId: 请求唯一标识

total: 总条数 （分页查询返回）

page: 页数 (分页查询返回）

pageSize: 每页大小(分页查询返回）

总页数计算：total / pageSize + ((total % pageSize == 0) ? 0 : 1)

五、数据库设计

数据库表设计

六、接口协议内容

1.  设备登录 (intent = dLogin) 

请求参数：

uid: 设备唯一ID

 tim:  当前时间戳（毫秒） （通过接口12.5同步服务器时间戳），服务器校验60分钟内的tim为校验通过，否则登录失败

 auth: 登录校验信息：md5（tim + pwd）

举例：

tim： 1752650515314

pwd： a669c079dcec4eb68db2b700ac91552c

待加密原文：1752650515314a669c079dcec4eb68db2b700ac91552c

md5密文：806164a7377d20ee64987dee8c070b4a

mac: 设备MAC地址

ver: 固件版本（如"V2.3.1"）

retTag: 重置标记（与上次登录不一致，则重置设备）

deviceType: 设备类型 

Topic :  v1/server/dLogin

| JSON<br>{<br>  "reqId": "57fb756ba9a540088a9179383a420a24",<br>  "uid": "04d77ffce7801501",<br>  "auth": "806164a7377d20ee64987dee8c070b4a",<br>  "tim": "1752650515314",<br>  "mac": "001122334455",<br>  "ver": "V2.3.1",<br>  "retTag": 0,<br>  "deviceType": "pad",<br>  "pid":"",<br>  "sourceType":"device",<br>  "sourceId": "04d77ffce7801501"<br>} |
| --- |

响应参数：

loginToken 设备登录token

 expire:  过期时间戳（秒） 

familyId: 家庭id，如果未绑定返回null

Topic :  v1/04d77ffce7801501/dLogin

| JSON<br>代码块<br>{<br>  "reqId": "57fb756ba9a540088a9179383a420a24",<br>  "msg": "success",<br>  "code": 200,<br>  "sourceType":"server",<br>  "familyId":"xxx",<br>  "expire": 1748328523,<br>  "loginToken": "xxx.xxx.xxx"<br>} |
| --- |

2. 设备绑定管理

2.1  绑定Token获取 (intent = dbToken)

请求参数：

Topic :  v1/server/dbToken

| JSON<br>代码块<br>{<br>  "reqId": "aa202505131944450081",<br>  "sourceType":"device",<br>  "loginToken":"xxx.xxx.xxx",<br>  "sourceId": "9c5ca87258dd4057a28ee49888552895"<br>} |
| --- |

响应参数：

Topic : v1/9c5ca87258dd4057a28ee49888552895/dbToken

| JSON<br>代码块<br>{<br>  "reqId": "aa202505131944450081",<br>  "msg": "success",<br>  "code": 200<br>  "bindToken": "xxxx",<br>  "qrCode":"https://api.zorme.tech/mgr/app/v1?s=dbd&bindToken=xxxx&uid=xxx&expire=1672502400000&pid=xxx"<br>  "expire": 1672502400000,<br>  "sourceType":"server"<br>} |
| --- |

2.2 设备绑定 (intent = dBind)

APP → 服务器参数：

uid: 网关设备ID

familyId: 家庭ID

userId: 操作人ID

bindToken: 绑定令牌（从dBindToken获取）

Topic :  v1/server/dBind

| JSON<br>代码块<br>{<br>  "reqId": "aa20250513194445008",<br>  "uid": "9c5ca87258dd4057a28ee49888552895",<br>  "familyId": "a5df794e9f4f4d02bdb0fd6599671584",<br>  "userId": "U123456789",<br>  "bindToken": "xxxx-xxxx-xxxx",<br>  "sourceType":"app",<br>  "loginToken":"xxx.xxx.xxx",<br>  "sourceId": "d82a9ebd66474142ac86caad98e1e0a1" //aspId<br>} |
| --- |

服务器 → 中控屏参数：

uid: 网关设备ID

familyId: 家庭ID

userId: 操作人ID

Topic : v1/9c5ca87258dd4057a28ee49888552895/dBind

| JSON<br>代码块<br>{<br>  "reqId": "aa20250513194445008",<br>  "uid": "9c5ca87258dd4057a28ee49888552895",<br>  "familyId": "a5df794e9f4f4d02bdb0fd6599671584",<br>  "userId": "U123456789",<br>  "orgAspId": "d82a9ebd66474142ac86caad98e1e0a1",<br>  "sourceType":"server"<br>} |
| --- |

中控屏 → 服务器 参数

uid: 网关设备ID

familyId: 家庭ID

userId: 操作人ID

roomId: 默认房间ID 

Topic :  v1/server/dBind

| JSON<br>server/dBind<br>{<br>  "reqId": "aa20250513194445008",<br>  "uid": "9c5ca87258dd4057a28ee49888552895",<br>  "familyId": "a5df794e9f4f4d02bdb0fd6599671584",<br>  "userId": "U123456789",<br>  "orgAspId": "d82a9ebd66474142ac86caad98e1e0a1",<br>  "code": 200,<br>  "msg": "success",<br>  "sourceType":"device",<br>  "sourceId": "9c5ca87258dd4057a28ee49888552895"<br>} |
| --- |

服务器 → APP 

Topic :  v1/d82a9ebd66474142ac86caad98e1e0a1/dBind

| JSON<br>代码块<br>{<br>  "reqId": "aa20250513194445008",<br>  "uid": "9c5ca87258dd4057a28ee49888552895",<br>  "familyId": "a5df794e9f4f4d02bdb0fd6599671584",<br>  "userId": "U123456789",<br>  "code": 200,<br>  "msg": "success",<br>  "sourceType":"server"<br>} |
| --- |

2.3 绑定流程举例：

2.3 设备解绑 (intent = dUnBind)

APP → 服务器参数：

uid: 网关设备ID

familyId: 家庭ID

userId: 操作人ID

Topic :  v1/server/dUnBind

| JSON<br>代码块<br>{<br>  "reqId": "aa20250513194445008",<br>  "uid": "9c5ca87258dd4057a28ee49888552895",<br>  "familyId": "a5df794e9f4f4d02bdb0fd6599671584",<br>  "userId": "U123456789",<br>  "sourceType":"app",<br>  "sourceId": "d82a9ebd66474142ac86caad98e1e0a1"<br>} |
| --- |

服务器 → 中控屏参数：

uid: 网关设备ID

familyId: 家庭ID

userId: 操作人ID

Topic : v1/9c5ca87258dd4057a28ee49888552895/dUnBind

| JSON<br>代码块<br>{<br>  "reqId": "aa20250513194445008",<br>  "uid": "9c5ca87258dd4057a28ee49888552895",<br>  "familyId": "a5df794e9f4f4d02bdb0fd6599671584",<br>  "userId": "U123456789",<br>  "orgAspId": "d82a9ebd66474142ac86caad98e1e0a1",<br>  "sourceType":"server"<br>} |
| --- |

中控屏 → 服务器 参数

uid: 网关设备ID

familyId: 家庭ID

userId: 操作人ID

roomId: 默认房间ID 

Topic :  v1/server/dUnBind

| JSON<br>server/dBind<br>{<br>  "reqId": "aa20250513194445008",<br>  "uid": "9c5ca87258dd4057a28ee49888552895",<br>  "userId": "U123456789",<br>  "familyId": "a5df794e9f4f4d02bdb0fd6599671584",<br>  "orgAspId": "d82a9ebd66474142ac86caad98e1e0a1",<br>  "code": 200,<br>  "msg": "success",<br>  "sourceType":"device",<br>  "sourceId": "9c5ca87258dd4057a28ee49888552895"<br>} |
| --- |

服务器 → APP 

Topic :  v1/d82a9ebd66474142ac86caad98e1e0a1/dUnBind

| JSON<br>代码块<br>{<br>  "reqId": "aa20250513194445008",<br>  "uid": "9c5ca87258dd4057a28ee49888552895",<br>  "code": 200,<br>  "msg": "success",<br>  "sourceType":"server"<br>} |
| --- |

3. 设备控制 (intent = deviceCtrl)

请求参数：

properties: 控制属性(JSON对象)

ctrlType: 控制类型，如setProp设置属性， execFunc 执行方法等

Topic：v1/9c5ca87258dd4057a28ee49888552895/deviceCtrl

Topic：v1/{deviceId}/deviceCtrl  (扫地机)

写属性

| JSON<br>代码块<br>{<br>  "reqId": "dsadfaadsfvasfsa",<br>  "deviceId": "1748328523123",<br>  "uid": "9c5ca87258dd4057a28ee49888552895",<br>  "ctrlType":"setProp",<br>  "properties": {<br>    "onoff": "on"<br>  },<br>  "sourceType":"app",<br>  "sourceId": "1748328523125"<br>} |
| --- |

写命令

| JSON<br>代码块<br>{<br>  "reqId": "dsadfaadsfvasfsa",<br>  "deviceId": "1748328523123",<br>  "uid": "9c5ca87258dd4057a28ee49888552895",<br>  "ctrlType":"execFunc",<br>  "commands": {<br>    "name": "addDev",<br>    "args":{<br>    "number":250<br>    }<br>  },<br>  "sourceType":"app",<br>  "sourceId": "1748328523125"<br>} |
| --- |

响应参数：

Topic: v1/1748328523125/deviceCtrl

| JSON<br>代码块<br>{<br>  "reqId": "dsadfaadsfvasfsa",<br>  "uid": "9c5ca87258dd4057a28ee49888552895",<br>  "deviceId": "1748328523123",<br>  "code": 200,<br>  "msg": "success",<br>  "data":{<br>          "deviceId":"1748328523123_2"<br>  }<br>  "sourceType":"device",<br>  "sourceId": "9c5ca87258dd4057a28ee49888552895"<br>} |
| --- |

4.  设备报告

4.1 属性报告 (intent = reportProp)

请求参数：

deviceProps

uid: 上报设备ID

deviceId: 源设备ID 

online: 在离线 0 : 离线， 1：在线

 deviceType: 设备类型

properties: 上报属性（JSON对象） 

timestamp: 报告触发时间（UTC毫秒时间戳）

reportAll：布尔值，true： 全量属性上报；false： 增量属性上报；无字段默认增量上报

未绑定家庭：topic：v1/family/unbind/reportProp

已绑定家庭：topic：v1/family/a5df794e9f4f4d02bdb0fd6599671584/reportProp

| JSON<br><br>属性上报<br>{<br>  "reqId": "dsadfaadsfvasfsa1",<br>  "deviceProps":[<br>      {<br>          "deviceId":"1748328523123",<br>          "online":1,<br>          "uid": "9c5ca87258dd4057a28ee49888552895",<br>          "deviceType": "light",<br>          "timestamp": 1747376067607,<br>          "properties": {<br>            "onoff": "on"<br>          }<br>      },<br>      {<br>          "deviceId":"174832852322",<br>          "online":1,<br>          "uid": "9c5ca87258dd4057a28ee49888552895",<br>          "deviceType": "light",<br>          "timestamp": 1747376067607,<br>          "properties": {<br>            "onoff": "on"<br>          }<br>      }<br>  ],<br>  "sourceType":"device",<br>  "reportAll":true,<br>  "sourceId": "9c5ca87258dd4057a28ee49888552895"<br>} |
| --- |

4.2 事件报告 (intent = reportEvent)

请求参数：

uid: 上报设备ID

deviceId: 源设备ID 

 deviceType: 设备类型

event: 上报事件（JSON对象） 

timestamp: 报告触发时间（UTC毫秒时间戳）

未绑定家庭：topic：v1/family/unbind/reportEvent

已绑定家庭：topic：v1/family/a5df794e9f4f4d02bdb0fd6599671584/reportEvent

| JSON<br><br>事件上报<br>{<br>  "reqId": "dsadfaadsfvasfsa1",<br>  "deviceId":"1748328523123",<br>  "uid": "9c5ca87258dd4057a28ee49888552895",<br>  "deviceType": "light",<br>  "timestamp": 1747376067607,<br>  "event": {<br>      "name": "upgradeStatusChanged",<br>      "args":{<br>        "upgradeStatus":"downloading",<br>        "value": "keyAction"<br>       }<br>  },<br>  "sourceType":"device",<br>  "sourceId": "9c5ca87258dd4057a28ee49888552895"<br>} |
| --- |

4.3 查询属性报告 (HTTPS)

URI: /device/propQuery

请求参数：查询逻辑，按传入的条件取交集（查询条件为且的关系）

uid: 按uid查, 可选

deviceId: 按设备ID查 , 可选

 familyId：家庭ID，必填

 floorId：楼层Id, 可选

 roomId：房间id, 可选

| JSON<br><br>属性上报<br>{<br>  "reqId": "dsadfaadsfvasfsa1",<br>  "deviceId":"1748328523123",<br>  "uid": "9c5ca87258dd4057a28ee49888552895",<br>  "familyId": "xxx",<br>  "floorId":"9c5ca87258dd4057a28ee49888552895",<br>  "roomId": "9c5ca87258dd4057a28ee49888552895"<br>} |
| --- |

响应参数：

deviceProps 设备属性列表（对象数组结构，对象字段如下）

uid: 上报设备ID

deviceId: 源设备ID 

 deviceType: 设备类型

timestamp： 设备属性上报时间戳(设备时间戳）

properties：属性内容，json对象结构

updateTime: 服务器属性报告更新时间

| JSON<br><br><br>{<br>  "reqId": "dsadfaadsfvasfsa1",<br>  "deviceProps":[<br>      {<br>          "deviceId":"1748328523123",<br>          "uid": "9c5ca87258dd4057a28ee49888552895",<br>          "deviceType": "light",<br>          "timestamp": 1747376067607,<br>          "updateTime": "2025-06-25 10:22:22",<br>          "properties": {<br>            "onoff": "on"<br>          }<br>      },<br>      {<br>          "deviceId":"1748328523125",<br>          "uid": "9c5ca87258dd4057a28ee49888552895",<br>          "deviceType": "light",<br>          "timestamp": 1747376067607,<br>          "updateTime": "2025-06-25 10:22:22",<br>          "properties": {<br>            "onoff": "on"<br>          }<br>      }<br>      ...<br>  ]<br>} |
| --- |

5. APP登录 (intent = uLogin)

请求参数：

userName: 手机号 

pwd: 密码（加盐加密）

ptype: 手机类型

os 手机操作系统

ver: 应用版本号（如"V3.2.1"）

Topic :  v1/server/uLogin

| JSON<br>{<br>    "reqId": "dsadfaadsfvasfsa1",<br>    "userName": "13499999999",<br>    "pwd": "6ac7ceefc0f2477ba3dbd2ce3f5e1860",<br>    "ptype": "iPhone13,4",<br>    "os": "iOS15.2",<br>    "ver": "V3.2.1",<br>    "sourceType":"app",<br>    "sourceId":"1748328523125",<br>    "registrationId":"123123123123" // 推送注册id<br>} |
| --- |

响应参数：

loginToken 用户登录token

 expire:  过期时间戳（秒） 

Topic :  v1/1748328523125/uLogin

| JSON<br>{<br>  "reqId": "dsadfaadsfvasfsa1",<br>  "userId": "ad1234567890",<br>  "loginToken": "xxxxxx.xxxxxx.xxxxxx",<br>  "code": 200,<br>  "msg": "success",<br>  "expire": 1748328523,<br>  "sourceType":"server"<br>} |
| --- |

6.  家庭管理   (HTTPS)

6.1 创建家庭 (/family/fmyAdd)

请求参数：

familyName: 家庭名称（2-30字符）

| JSON<br>body<br>{<br>    "reqId": "dsadfaadsfvasfsa1",<br>    "sourceType":"app",<br>    "sourceId":"d82a9ebd66474142ac86caad98e1e0a1",<br>    "data":[<br>        {<br>            "name": "我的家庭2"<br>        }<br>    ]<br>} |
| --- |

响应参数：

| JSON<br>{<br>    "reqId": "dsadfaadsfvasfsa1",<br>    "msg": "success",<br>    "code": 200,<br>    "data": [<br>        {<br>            "id": 6,<br>            "familyId": "04c7fbc063401900",<br>            "name": "我的家庭",<br>            "familyType": null, //-1为默认家庭，0或null为用户手动创建的家庭<br>            "city": null,<br>            "province": null,<br>            "country": null,<br>            "lon": null, //经度，保留6位小数<br>            "lat": null, //纬度，保留6位小数<br>            "timeZone": null, //时区信息，如 Asia/Shanghai<br>            "creator": "bac",<br>            "createTime": null,<br>            "updateTime": null,<br>            "ext": null,<br>            "valid": null<br>        }<br>    ],<br>    "total": 0,<br>    "page": 0,<br>    "pageSize": 0<br>} |
| --- |

6.2 编辑家庭 (/family/fmyEdit)

请求参数：

longitude: 经度

latitude: 纬度

familyName: 新名称

familyId: 家庭ID

city: 所在城市

province: 所在省份

country: 所在国家

| JSON<br>{<br>    "reqId": "dsadfaadsfvasfsa1",<br>    "sourceType":"app",<br>    "sourceId":"d82a9ebd66474142ac86caad98e1e0a1",<br>    "data":[<br>       {<br>            "familyId": "04c7f0eb7a401600",<br>            "name": "我的家庭5555"<br>        }<br>    ]<br>} |
| --- |

响应参数：完整family对象

| JSON<br>{<br>    "reqId": "dsadfaadsfvasfsa1",<br>    "msg": "success",<br>    "code": 200,<br>    "data": [<br>        {<br>            "id": 5,<br>            "familyId": "04c7f0eb7a401600",<br>            "name": "我的家庭5555",<br>            "familyType": null,<br>            "city": null,<br>            "province": null,<br>            "country": null,<br>            "lon": null,<br>            "lat": null,<br>            "timeZone": null,<br>            "creator": "bac",<br>            "createTime": "2025-06-18 05:54:57",<br>            "updateTime": "2025-06-18 07:36:33",<br>            "ext": null,<br>            "valid": 1<br>        }<br>    ]<br>} |
| --- |

6.3 查询家庭 (/family/fmyQuery) (https/mqtt)

Mqtt Topic :  v1/server/fmyQuery

Uri: /family/fmyQuery

请求参数：

familyId: 可选家庭ID （设备不传familyId，则查该设备绑定的家庭； 手机app不传familyId，则查询用户下所有家庭）

| JSON<br>{<br>    "reqId": "dsadfaadsfvasfsa1",<br>    "sourceType":"device",         //mqtt协议 必填<br>    "sourceId":"d82a9ebd66474142ac86caad98e1e0a1"  //mqtt协议 必填<br>} |
| --- |

Mqtt Topic : v1/d82a9ebd66474142ac86caad98e1e0a1/fmyQuery

响应参数：

| JSON<br>{<br>    "reqId": "dsadfaadsfvasfsa1",<br>    "msg": "success",<br>    "code": 200,<br>    "data": [ //设备查询时，  data为空数组[]，则表示设备未绑定; 绑定设备查询只有一个家庭数据<br>        {<br>            "id": 1,<br>            "familyId": "04c7e7c514401300",<br>            "name": "我的家庭",<br>            "familyType": null,<br>            "city": null,<br>            "province": null,<br>            "country": null,<br>            "lon": null,<br>            "lat": null,<br>            "timeZone": null,<br>            "creator": "bac",<br>            "accLoginName": "137****1101", //设备查询，已登录账号的设备返回该值<br>            "createTime": "2025-06-18 05:14:58",<br>            "updateTime": "2025-06-18 05:14:58"<br>        },<br>        {<br>            "id": 2,<br>            "familyId": "04c7e83f75c01300",<br>            "name": "我的家庭",<br>            "familyType": null,<br>            "city": null,<br>            "province": null,<br>            "country": null,<br>            "lon": null,<br>            "lat": null,<br>            "timeZone": null,<br>            "creator": "bac",<br>            "createTime": "2025-06-18 05:17:03",<br>            "updateTime": "2025-06-18 05:17:03"<br>        }<br>    ],<br>    "total": 2,<br>    "page": 1,<br>    "pageSize": 1000<br>} |
| --- |

6.4 删除家庭 (/family/fmyDel)

请求参数：

familyId: 家庭ID

userId: 操作人ID

| JSON<br>{<br>    "reqId": "dsadfaadsfvasfsa1",<br>    "familyId": "F123456789",<br>    "userId": "U123456789",<br>    "sourceType":"app",<br>    "sourceId":"d82a9ebd66474142ac86caad98e1e0a1"<br>} |
| --- |

响应参数： 

| JSON<br>{<br>     "reqId": "dsadfaadsfvasfsa1",<br>     "familyId": "F123456789",<br>     "userId": "U123456789",<br>     "code": 200,<br>     "msg": "success" ,<br>     "sourceType":"server"<br>} |
| --- |

7. 账号管理  (HTTPS)

7.1  账号密码登录 (/login/accLogin) 

请求：

| JSON<br>//请求参数<br> <br>{<br>    "reqId": "dsadfaadsfvasfsa1",<br>    "userName": "13262275567",<br>    "pwd": "123123123", // 需要加密 详见 7.1.2 <br>    "ptype": "iPhone13,4",<br>    "os": "iOS15.2",<br>    "ver": "V3.2.1",<br>    "sourceType":"app",<br>    "sourceId":"1748328523125",<br>    "registrationId":"123123123123" // 推送注册id<br>}<br>//响应<br> |
| --- |

响应：

| Python<br>{<br>  "reqId": "dsadfaadsfvasfsa1",<br>  "userId": "ad1234567890",<br>  "code": 200, // 10002 失败 200 成功<br>  "msg": "success", # 是否登录成功  <br>  "expire": 1748328523,<br>  "sourceType":"server"<br>} |
| --- |

7.1.2 RSA加密

【1】通过接口获取public key  =>   接口协议规范

【2】根据public key进行rsa加密

【3】将加密后的byte数组使用base64散列成字符串

【4】将散列字符串进行URLEncodeComponent

示例：

js demo:

| JavaScript<br>// 通过接口   /account/getPublicKey 获取 详见  7.10<br>const publicKey = 'MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCUeGmR+UuuGRP4Xt6OG48OkHUjzRb8+13dq0MNAuNWK6kvOxl/eYHwC71blRTi9Zy5q8J/emw4ISYYShyp4FDBaMBGkr/s+KUkiM9bthNms+jYB5gDUit6mF2y7GEcedvxY5C871RH/k/3YsZcgZQLKmXSyjPZJBSV1UamizOWwQIDAQAB';<br><br>// 获取接口的密码<br>const pwd = pm.request.url.query.get("password");<br>console.log("pwd: " + pwd);<br><br>// 使用加签工具<br>var jsrsasign = require("jsrsasign");<br>let pubk = "-----BEGIN PUBLIC KEY-----" + publicKey + "-----END PUBLIC KEY-----";<br>let pub = jsrsasign.KEYUTIL.getKey(pubk);<br>let enc = jsrsasign.KJUR.crypto.Cipher.encrypt(pwd, pub, 'RSA');<br><br>// 转成base64字符串<br>var encryptStr =  jsrsasign.hextob64(enc);<br>console.log("encrypt pwd: " + encryptStr);<br><br>// urlEncode<br>var encodeStr = encodeURIComponent(encryptStr);<br>console.log("encode pwd: " + encodeStr);<br><br>// 反写入请求参数<br>pm.request.url.query.upsert({<br>    key: "password",<br>    value: encodeStr<br>}); |
| --- |

 golang demo 代码：

| Go<br>func EncryptPassword(publicKeyStr, password string) (string, error) {<br>    // 1. 解码Base64公钥<br>    derBytes, err := base64.StdEncoding.DecodeString(publicKeyStr)<br>    if err != nil {<br>        return "", errors.New("base64解码失败: " + err.Error())<br>    }<br><br>    // 2. 构造PEM格式的公钥<br>    pemKey := "-----BEGIN PUBLIC KEY-----\n" +<br>        base64.StdEncoding.EncodeToString(derBytes) + // 重新Base64编码为PEM标准格式<br>        "\n-----END PUBLIC KEY-----"<br><br>    // 3. 解析PEM公钥<br>    block, _ := pem.Decode([]byte(pemKey))<br>    if block == nil {<br>        return "", errors.New("PEM解码失败")<br>    }<br>    pub, err := x509.ParsePKIXPublicKey(block.Bytes)<br>    if err != nil {<br>        return "", errors.New("公钥解析失败: " + err.Error())<br>    }<br>    rsaPub, ok := pub.(*rsa.PublicKey)<br>    if !ok {<br>        return "", errors.New("非RSA公钥类型")<br>    }<br><br>    // 4. 使用PKCS#1 v1.5加密（匹配jsrsasign默认行为）<br>    ciphertext, err := rsa.EncryptPKCS1v15(rand.Reader, rsaPub, []byte(password))<br>    if err != nil {<br>        return "", errors.New("加密失败: " + err.Error())<br>    }<br><br>    // 5. Base64编码<br>    encryptedBase64 := base64.StdEncoding.EncodeToString(ciphertext)<br><br>    // 6. URL编码<br>    return url.QueryEscape(encryptedBase64), nil<br>}<br> |
| --- |

7.2 短信验证码登录  (/login/smsLogin)

请求：

| JSON<br><br>{​<br>       "reqId": "dsadfaadsfvasfsa1", //随机字符​<br>       "phone": "13499999999",​<br>        "code": "234567",​<br>        "ptype": "iPhone13,4", // pad开头​<br>        "os": "iOS15.2", // IOS 开头  ​， andorid开头，pad开头<br>        "ver": "V3.2.1", ​<br>        "sourceType": "app", // pad 填 device​<br>        "sourceId": "1748328523125", // pad 填 uid​<br>        "phoneCode": "86", // 非必填 默认 86​<br>        "registrationId":"123123123123" // 推送Id , pad 不传这个字段<br><br>} |
| --- |

  响应：

| JSON<br>{<br>        "reqId": "dsadfaadsfvasfsa1",<br>        "userId": "08345FE832401000", #用户ID<br>        "code": 200,  // 10002:失败 200:成功<br>        "msg": "success",<br>        "expire": 1748328523,<br>        "sourceType": "server"<br>} |
| --- |

7.3 获取用户信息  (/account/accUserInfo)

 请求参数：

userId  用户ID 

reqId 请求id  

请求体

| JSON<br>{<br>    "reqId": "dsadfaadsfvasfsa1",<br>    "userId": "U123456789",<br>    "sourceType":"app", <br>    "sourceId": "1748328523125" <br>} |
| --- |

响应体：

| JSON<br>代码块<br>{<br>    "code": 200,<br>    "msg": "success",<br>    "data": {<br>        "id": 1,<br>        "userId": "083990CDDEC01000",<br>        "userName": "13267075567",<br>        "nick": "明天周五",<br>        "phone": "13267075567",<br>        "ptype": "px30_evb",<br>        "email": "",<br>        "ip": "",<br>        "city": "",<br>        "province": "",<br>        "country": "CN",<br>        "lon": 0,<br>        "lat": 0,<br>        "os": "iOS15.2",<br>        "brand": "",<br>        "userType": 0,<br>        "valid": 1,<br>        "updateTime": "2025-08-28 15:21:00",<br>        "createTime": "2025-06-20 18:51:57",<br>        "pushToken": "",<br>        "timeZone": "",<br>        "dreameToken": "",<br>        "ext": "",<br>        "avatar": "https://dreame-cn.oss-cn-shanghai.aliyuncs.com/public/avatars/PI027646/4cdd8e202b7f09fce4af8155311f911d.jpg",<br>        "ver": "V3.2.1",<br>        "registrationId": "123123123123",<br>        "thirdIds": {<br>            "zm": "PI027646"<br>        }<br>    },<br>    "reqId": "dsadfaadsfvasfsa1"<br>} |
| --- |

thirdIds表示第三方id

| JSON<br>       "thirdIds": {<br>            "zm": "PI027646" #账号对应的追觅账号id,<br>            "wx": "xxxx" #账号对应的追觅账号id<br>        } |
| --- |

7.3  退出登录 (/login/accLogout)  

请求参数：

reqId 请求id #string#  必传

| JSON<br>{<br>    "reqId": "dsadfaadsfvasfsa1",<br>    "sourceType":"app",        //如果是device调用，soureType=device，那么设备会从家庭解绑<br>    "sourceId":"1748328523125", <br>    "userId":"xxx" //非必填<br>} |
| --- |

返回：

| JSON<br>{<br>     "reqId": "dsadfaadsfvasfsa1",<br>     "code": 200,<br>     "msg": "success" ,<br>     "sourceType":"server"<br>} |
| --- |

7.4 微信绑定 (/account/accWx) 

请求参数：

userId: 用户ID

openId: 微信开放平台ID

thirdUserName: 微信昵称（URL编码）

| JSON<br>{<br>  "reqId": "req_20250513194445_001",<br>  "userId": "U_123456789",<br>  "openId": "wx_OPENID_ABCD1234",<br>  "thirdUserName": "%E5%BE%AE%E4%BF%A1%E6%98%B5%E7%A7%B0",<br>  "sourceType":"app",<br>  "sourceId":"d82a9ebd66474142ac86caad98e1e0a1"<br>} |
| --- |

响应参数： 

| JSON<br>{<br>     "reqId": "dsadfaadsfvasfsa1",<br>     "code": 200,<br>     "msg": "success" ,<br>     "sourceType":"server"<br>} |
| --- |

7.5 账号编辑 (/account/accEdit)

请求参数：

nickName: 新用户名（2-20字符）

userId: 用户

| JSON<br>{<br>  "reqId": "req_20250513194445_002",<br>  "intent": "accEdit",<br>  "userId": "U_123456789",<br>  "nickName": "新用户昵称",<br>  "sourceType":"app",<br>  "sourceId":"d82a9ebd66474142ac86caad98e1e0a1"<br>} |
| --- |

响应参数： 

| JSON<br>{<br>     "reqId": "dsadfaadsfvasfsa1",<br>     "code": 200,<br>     "msg": "success" ,<br>     "sourceType":"server"<br>} |
| --- |

7.6 账号注销 (/login/accDel) 

账号删除

请求参数：

userId: 待注销用户ID

| JSON<br>{<br>  "reqId": "req_20250513194445_003",<br>  "userId": "U_123456789",<br>  "sourceType":"app",<br>  "sourceId":"d82a9ebd66474142ac86caad98e1e0a1"<br>} |
| --- |

响应参数： 

| JSON<br>{<br>     "reqId": "dsadfaadsfvasfsa1",<br>     "code": 200,<br>     "msg": "success" ,<br>     "sourceType":"server"<br>} |
| --- |

7.7 密码修改 (/account/accPwdUpdate)

请求参数：

oldPwd: 原密码  

newPwd: 新密码  

userId : 用户Id

| JSON<br>{<br>  "reqId": "req_20250513194445_004",<br>  "intent": "acc-pwd-update",<br>  "userId": "08345FE832401000",<br>  "oldPwd": "asdfasdfsdf",<br>  "newPwd": "eeeeeeee",<br>  "sourceType":"app",<br>  "sourceId":"d82a9ebd66474142ac86caad98e1e0a1"<br>} |
| --- |

响应参数： 

| JSON<br>{<br>     "reqId": "dsadfaadsfvasfsa1",<br>     "code": 200,<br>     "msg": "success" ,<br>     "sourceType":"server"<br>} |
| --- |

7.8 密码重置 (/account/accPwdReset)

请求参数：

userId: 用户ID

code: 6位短信验证码

newPwd: 新密码

| JSON<br>{<br>  "reqId": "req_20250513194445_004",<br>  "intent": "acc-pwd-update",<br>  "userId": "U_123456789",<br>  "code": "234567",<br>  "newPwd": "d8578edf8458ce06fbc5bb76a58c5ca4",<br>  "sourceType":"app",<br>  "sourceId":"d82a9ebd664741 42ac86caad98e1e0a1",<br>  "phoneCode": "86" //非必传  默认 "86"<br> } |
| --- |

响应参数： 

| JSON<br>{<br>     "reqId": "dsadfaadsfvasfsa1",<br>     "code": 200,<br>     "msg": "success" ,<br>     "sourceType":"server"<br>} |
| --- |

7.9   短信验证码 (/account/smsSendCode)

请求参数：

userName: 目标手机号

bizType: 业务类型枚举值：

acc-pwd-reset: 密码重置 

uLogin: 登录注册

accDel: 账号注销

sessionId/token/sig 是 阿里云人机接口参数 IOT接口接入

phoneCode": 手机号区号

中国：86

lang: 语言 

cn 中文

| JSON<br>{<br>        "reqId": "req_20250513194445_004",<br>        "intent": "acc-pwd-update",<br>        "phone": "13267075567",<br>        "bizType": "uLogin",  //uLogin  登录注册  acc-pwd-reset: 密码重置 <br>        "sourceType": "app",  <br>        "phoneCode": "86",   <br>        "lang": "cn",  <br>        "sourceId": "caad98e1e0a1",<br>        "sessionId": "01j8h0pMydQXo1Oevsk7Uty5px2tkTPP3kOWPYtMeBj81t04eaM2v_S0X7OOYgZCv7_tg5BRwZx0kevlGNgkrEZXZdbD3PXDptur2kNh3i54WEOYQwbbi_8HuOhd25yV26PTLVrMFPbg7VXu8pB_RxC5GrmzMBO9kxc_nqvdp7K7U",<br>        "token":"FFFF0N0000000000AFEA:nc_login_h5:1750754435349:0.8639742818934769",<br>        "sig":"05XqrtZ0EaFgmmqIQes-s-CKYw2ZPshwofQpS_PUMLQf38b1Mmxv9NSnQ5e76Eov3d_8RuCjmgdJB79F1qZWVHj1gq-V0PecbYdBIps3vzjH7aPMGWngCVrEStMpxgniCt_NFsXrmsPl5Gj8zIPv0xxhzCGRIDHMAcBt1IgRMdwQBPi5N8gr8E4I3SH0hModhilLRPNVmZG3XkJi0SAiNyfXCD0X9K2TICe6_WuRKojgkiOuDkpcSsPyPd8HSrEvvtD-rJOO3Pi0pY7cLTGBve05AtFRiDNOhH76K3VlSsJZek0Ep2nfTf1WoP7UR0_b95E_XobpNtXO2t9QXy7ZYduxGvrKskCnuB_BeFi4vCtsEe5Y-TzBAu2jCHcJT0XhmpAPgyes0GRWFFN0B2CWaFHOfix8eJavY0Q39lxHoMnY2Omww2qYmLzPYDK35ATsAo",<br>        "timestamp": 1722930863000<br>} |
| --- |

响应参数： 

| JSON<br>{<br>     "reqId": "dsadfaadsfvasfsa1",<br>     "code": 200,<br>     "msg": "success" ,<br>     "sourceType":"server"<br>} |
| --- |

7.10    获取PubilcKey (/account/getPublicKey)

请求参数：

| JSON<br>{   <br>    "reqId": "123123123",<br>    "refreshToken": ""<br> } |
| --- |

响应参数： 

| JSON<br>{<br>    "code": 200,<br>    "msg": "success",<br>    "data": "MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCUeGmR+UuuGRP4Xt6OG48OkHUjzRb8+13dq0MNAuNWK6kvOxl/eYHwC71blRTi9Zy5q8J/emw4ISYYShyp4FDBaMBGkr/s+KUkiM9bthNms+jYB5gDUit6mF2y7GEcedvxY5C871RH/k/3YsZcgZQLKmXSyjPZJBSV1UamizOWwQIDAQAB",<br>    "reqId": "123123123"<br>} |
| --- |

7.11  根据refresh_token刷新token (/account/accRefreshToken)

请求参数

| YAML<br>{   <br>    "reqId": "123123123",<br>    "refreshToken":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0ZW5hbnRfaWQiOiIwMDAwMDAiLCJjb3VudHJ5IjoiQ04iLCJpc19uZXdfcmVnaXN0ZXIiOmZhbHNlLCJ1c2VyX25hbWUiOiJQSTAyNzY0NiIsImF1dGhvcml0aWVzIjpbInVzZXIiXSwiY2xpZW50X2lkIjoiZHJlYW1lX3NtYXJ0aG9tZV9zeXN0ZW0iLCJhdXRoX2NvZGUiOiI0M2UyYmNhMDNjN2E0N2EwYjIzZDg2MDI1NjVmNjNlNCIsInJvbGVfbmFtZSI6InVzZXIiLCJ1aWQiOiJQSTAyNzY0NiIsInQiOjE3NTU1MDAxOTQsInJvbGVfaWQiOiItMSIsInUiOjE5NDcwMywic2NvcGUiOlsiYWxsIl0sImF0aSI6ImIwNzlmMGNiLWE2MDMtNDY5ZC05OWJjLTZjOTY3OWE5MjA3NyIsInVzZXJfdG9rZW4iOnRydWUsImV4cCI6MTc1NjEwNDk5NCwibGFuZyI6InpoIiwiZGVwdF9pZCI6Ii0xIiwicmVnaW9uIjoiY24iLCJqdGkiOiI3ZDNhN2RjNi1iN2QxLTQ3NjQtODZhNi0xMTMyMGE1OTVhNGMifQ.FG8mXLIbXPy1D6Hp14VkphbJ-C3qJME3gRH0DAIeNdI"<br> } |
| --- |

响应参数

| YAML<br>{<br>    "accessToken": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0ZW5hbnRfaWQiOiIwMDAwMDAiLCJjb3VudHJ5IjoiQ04iLCJpc19uZXdfcmVnaXN0ZXIiOmZhbHNlLCJ1c2VyX25hbWUiOiJQSTAyNzY0NiIsImF1dGhvcml0aWVzIjpbInVzZXIiXSwiY2xpZW50X2lkIjoiZHJlYW1lX3NtYXJ0aG9tZV9zeXN0ZW0iLCJyb2xlX25hbWUiOiJ1c2VyIiwidWlkIjoiUEkwMjc2NDYiLCJ0IjoxNzU1NTAxMTY5LCJyb2xlX2lkIjoiLTEiLCJ1IjoxOTQ3MDMsInNjb3BlIjpbImFsbCJdLCJ1c2VyX3Rva2VuIjp0cnVlLCJleHAiOjE3NTU1MDQ3NjksImxhbmciOiJ6aCIsImRlcHRfaWQiOiItMSIsInJlZ2lvbiI6ImNuIiwianRpIjoiNjRiYjliODMtMGJjMS00YTAzLWEyZjgtY2YxNjA3YjRjYWUxIn0.zKpIThdy7EOkgBLfKew8nKt72y2VBage_9QLE3LmvJo",<br>    "code": 200,<br>    "expiresIn": 3600,<br>    "msg": "success",<br>    "reqId": "123123123"<br>} |
| --- |

8. 重新获取登录token（HTTPS/MQTT）

8.1 设备重新获取登录token（需在旧登录token有效期内调用，如token过期则重新登录）

URI ： /device/findLoginToken

mqtt:  v1/server/dFindLoginToken

请求参数：

uid:  设备uid （设备获取登录token）

| JSON<br>代码块<br>{<br>    "reqId":"57fb756ba9a540088a9179383a420a24",<br>    "uid":"ac4b3456caca45079c87bf4a319bf024",<br>    //https不需要loginToken字段，因为Header里已经有了<br>    "loginToken":"eyJhbGciOiJIUzI1NiJ9.eyJ1aWQiOiJhYzRiMzQ1NmNhY2E0NTA3OWM4N2JmNGEzMTliZjAyNCIsImNsaWVudFR5cGUiOiJkZXZpY2UiLCJsb2dpblRpbWUiOjE3NTAzMDM3NjYxMzksInN1YiI6ImRlZmF1bHQiLCJhdWQiOlsibG9naW4iXSwiZXhwIjoxNzUwOTA4NTY2fQ.Kb28CyR1Klv2HzD8oVR1b8t88ofOmKMsQus6B8bUDM4",<br>    "sourceType":"device",<br>    "sourceId":"ac4b3456caca45079c87bf4a319bf024"<br>} |
| --- |

响应参数：

loginToken 登录token

expire: 过期时间戳（毫秒） 

| JSON<br>代码块<br>{<br>    "msg": "success",<br>    "code": 200,<br>    "sourceType": "server",<br>    "expire": 1750908648285,<br>    "loginToken": "eyJhbGciOiJIUzI1NiJ9.eyJ1aWQiOiJhYzRiMzQ1NmNhY2E0NTA3OWM4N2JmNGEzMTliZjAyNCIsImNsaWVudFR5cGUiOiJkZXZpY2UiLCJsb2dpblRpbWUiOjE3NTAzMDM3NjYxMzksInN1YiI6ImRlZmF1bHQiLCJhdWQiOlsibG9naW4iXSwiZXhwIjoxNzUwOTA4NjQ4fQ.XE_Q9HPlaLe_MJIv2g1H_AylPp-r8UVZorwnEOYVWqE",<br>    "reqId": "57fb756ba9a540088a9179383a420a24"<br>} |
| --- |

8.2 APP重新获取登录token（需在旧登录token有效期内调用，如token过期则重新登录）

URI ： /login/findLoginToken

请求参数：

userId: 用户账号id （app获取登录token传入）

响应参数：

loginToken 登录token

expire: 过期时间戳（毫秒） 

| JSON<br>代码块<br>{<br>    "reqId": "da08d5d9-d4da-4cb0-b011-93eae68ad5c2",<br>    "msg": "success",<br>    "code": 200,<br>    "loginToken": "eyJhbGciOiJIUzI1NiJ9.eyJjbGllbnRUeXBlIjoiYXBwIiwibG9naW5UaW1lIjoxNzU0NjIxNTU4OTE4LCJ1c2VyTmFtZSI6IjE4NjY1OTg2Mjk4IiwiYXNwSWQiOiIxODY2NTk4NjI4OSIsInVzZXJJZCI6IjA4NTg4ZmE4MjU4MDEwMDAiLCJzdWIiOiJkZWZhdWx0IiwiYXVkIjpbImxvZ2luIl0sImV4cCI6MTc1NTIzMDc3M30.yYzE7wtzK7BjAGw0yZpcUJoC6BuUifJ9-EO2q0r43g8",<br>    "expire": 1755230773780<br>} |
| --- |

9. 成员管理(https)

9.1 邀请成员

URI: /mem/memInvite

请求参数：

reqId 请求ID

userId: 邀请人ID

familyId: 家庭ID

invUserName: 被邀请人账号 (iot-accout.user_info.username)

fuType: 成员类型(admin/general)

| JSON<br>{ <br>  "reqId": "123123",<br>  "userId":"083990CDDEC01000",<br>  "familyId": "04c7e7c514401300",<br>  "invUserName": "15107553820",<br>  "fuType":1  // 1 管理员  2 普通成员<br>}<br> |
| --- |

响应参数：无单独参数

| JSON<br>{<br>    "code": 200,<br>    "msg": "success",<br>    "data": {<br>        "id": 7,<br>        "familyId": "04c7e7c514401300",<br>        "fromUserId": "083990CDDEC01000",<br>        "toUserId": "083C1F1BFD001000",<br>        "msgStatus": 0,<br>        "fuType": 1,<br>        "fuNick": "15107553820",<br>        "valid": 1,<br>        "updateTime": "2025-11-20 17:13:38",<br>        "createTime": "2025-11-20 17:13:38"<br>    },<br>    "reqId": "123123"<br>} |
| --- |

9.2 邀请通知

URI: /mem/memInviteInform

服务器推送参数：

| JSON<br>{<br>  "inviteId": "邀请记录ID",<br>  "familyId": "家庭ID",<br>  "familyName": "家庭名称"<br>} |
| --- |

响应：根据邀请记录的id找到对应的 to_user 发送通知

| JSON<br>{<br>   "code": 200,<br>   "msg": "success",<br>   "data": "推送成功",<br>   "reqId": "123123"<br>} |
| --- |

9.3 查询邀请  

URI: /mem/memInviteQuery

请求参数：

userId: 被邀请人ID 

响应参数：

| JSON<br>{<br>  "reqId": "123123",<br>  "userId":"083C1F1BFD001000"<br>} |
| --- |

| JSON<br>代码块<br>{<br>    "code": 200,<br>    "msg": "success",<br>    "data": [<br>        {<br>            "id": 7,<br>            "familyId": "04c7e7c514401300",<br>            "fromUserId": "083990CDDEC01000",<br>            "toUserId": "083C1F1BFD001000",<br>            "msgStatus": 0,<br>            "fuType": 1,<br>            "fuNick": "15107553820",<br>            "valid": 1,<br>            "updateTime": "2025-11-20 17:13:39",<br>            "createTime": "2025-11-20 17:13:39"<br>        }<br>    ],<br>    "reqId": "123123"<br>} |
| --- |

9.4 接受邀请 

URI: /mem/memAccept

请求参数：

userId: 接受人ID

familyId: 家庭ID     

| JSON<br>{<br>    "reqId": "123123",<br>    "familyId":"04c7e7c514401300",<br>    "userId":"083C1F1BFD001000"<br>} |
| --- |

响应：

| JSON<br>{<br>        "code": 200,<br>        "msg": "success",<br>        "data": "接受邀请成功",<br>        "reqId": "123123"<br>} |
| --- |

9.5 拒绝邀请 

URI: /mem/memRefuse

请求参数：

userId: 拒绝人ID

familyId: 家庭ID

| JSON<br>{  <br>    "reqId": "123123",<br>    "familyId":"123123123",<br>    "userId":"123123"<br>} |
| --- |

响应参数： 

| JSON<br>{<br>    "code": 200,<br>    "msg": "success",<br>    "data": "拒绝邀请成功",<br>    "reqId": "123123"<br>} |
| --- |

9.6 编辑成员 

URI: /mem/memEdit

请求参数：

reqId 请求ID

userId: 操作人ID

familyId: 家庭ID

targetUserId: 被修改成员ID 

FnType: 成员类型

fuNick： 成员家庭昵称

响应参数：

| JSON<br>{<br>  "reqId": "123123",<br>  "userId": "083990CDDEC01000",<br>  "familyId": "04c7e7c514401300",<br>  "targetUserId": "083C1F1BFD001000",<br>  "fuType": 2,<br>  "fuNick":"rico"<br>} |
| --- |

9.7 删除成员 

URI: /mem/memDel

请求参数：

reqId 请求ID

userId: 操作人ID

familyId: 家庭ID

targetUserId: 被删除成员ID 
ota/check
发送通知 

| JSON<br>{<br>  "reqId": "123123",<br>  "userId": "083990CDDEC01000",<br>  "familyId": "04c7e7c514401300",<br>  "targetUserId": "083C1F1BFD001000"<br>  } |
| --- |

响应参数：无单独参数

| JSON<br>{<br>    "code": 200,<br>    "msg": "success",<br>    "data": null,<br>    "reqId": "123123"<br>} |
| --- |

9.8 查询成员 

URI: /mem/memQuery

请求参数：

userId: 操作人ID

familyId: 家庭ID

targetUserId: 可选成员ID # 如不传，表示所有成员

updateTime： 最新更新时间戳

| JSON<br>{<br>  "reqId": "123123",<br>  "userId": "083C1F1BFD001000",<br>  "familyId": "04c7e7c514401301"，<br>  "targetUserId": "083C1F1BFD001000"<br>  } |
| --- |

响应参数：

| JSON<br>代码块<br>{<br>    "code": 200,<br>    "msg": "success",<br>    "data": [<br>        {<br>            "id": 43,<br>            "familyId": "055c13d5bf019f00",<br>            "userId": "08c5d579ba001000",<br>            "fuType": 0,<br>            "fuNick": "18182720764",<br>            "valid": 1,<br>            "updateTime": "2025-10-11 17:22:41",<br>            "createTime": "2025-10-11 17:22:41",<br>            "thirdId": "PC196169", // 追觅id,<br>            "phone": "18182720764"， // 手机号<br>            }<br>    ],<br>    "reqId": "123123"<br>} |
| --- |

9.9 获取邀请二维码

URI: /family/invite/qrCode

请求参数：

| JSON<br>{<br>  "reqId": "req_20250513194445_003",<br>  "fuType": 2, //1 管理员； 2普通成员；（不传，默认管理员，兼容旧版本）<br>  "familyId":"adfsadfasd"<br>} |
| --- |

响应参数： 

| JSON<br>{<br>     "reqId": "dsadfaadsfvasfsa1",<br>     "qrCode":"https://api.zorme.tech/mgr/app/v1?s=fmv&token=xxx&familyName=xxx"<br>     "code": 200,<br>     "msg": "success" <br>} |
| --- |

qrCode， s: 业务类型，fmv家庭邀请

9.10 二维码加入家庭

URI: /family/invite/joinByCode

请求参数：

| JSON<br>{<br>  "reqId": "req_20250513194445_003",<br>  "token":"adfsadfasd"<br>} |
| --- |

响应参数： 

| JSON<br>{<br>     "reqId": "dsadfaadsfvasfsa1",<br>     "familyId":"xxxxx"<br>     "code": 200,<br>     "msg": "success" <br>} |
| --- |

9.11 检查二维码状态

URI: /family/invite/checkQrToken

请求参数：

| JSON<br>{<br>  "reqId": "req_20250513194445_003",<br>  "token":"adfsadfasd"<br>} |
| --- |

响应参数： 

| JSON<br>{<br>     "reqId": "dsadfaadsfvasfsa1",<br>     "code": 200, //200有效； 10009 二维码过期， 10025二维码使用次数耗尽（已使用）<br>     "msg": "success" <br>} |
| --- |

10. OTA升级（HTTPS)

OTA  签名key： 同公共签名key

     OTA独立token获取接口：

OTA HTTPS 接口采用独立的校验方式：OTA HTTPS接口独立校验方式， 获取独立token接口如下：

URI: /auth/token/otaToken

请求参数：

uid: 设备唯一ID

 tim:  当前时间戳（毫秒） （通过接口12.6 HTTPS获取服务器时间戳），服务器校验60分钟内的tim为校验通过，否则登录失败

 auth: 登录校验信息：md5（tim + pwd）

举例：

tim： 1752650515314

pwd： a669c079dcec4eb68db2b700ac91552c

待加密原文：1752650515314a669c079dcec4eb68db2b700ac91552c

md5密文：806164a7377d20ee64987dee8c070b4a

| JSON<br>{<br>    "reqId": "dsadfaadsfvasfsa1",<br>    "uid": "04d77ffce7801501",<br>    "auth": "806164a7377d20ee64987dee8c070b4a",<br>    "tim": 1752650515314<br>} |
| --- |

返回：

| JSON<br>{<br>    "reqId": "dsadfaadsfvasfsa1",<br>    "msg": "success",<br>    "code": 200,<br>    "token": "eyJhbGciOiJIUzI1NiJ9.eyJ1aWQiOiIwNGQ3N2ZmY2U3ODAxNTAxIiwibG9naW5UaW1lIjoxNzUyNjUyOTg5MzQ4LCJzdWIiOiJkZWZhdWx0IiwiYXVkIjpbIm90YSJdLCJleHAiOjE3NTMyNTc3ODl9.uB9wW3AaV3iz8j6K70Cm7mW1tLgY3owWBwtohezGvCc",<br>    "expire": 1753257789348<br>} |
| --- |

10.1 检查更新接口 （/ota/check）

请求参数

reqId： 请求id #string #必传

deviceId: 设备唯一ID  #必传：记录信息

deviceType: 设备类型 #必传

subdeviceType：子设备类型 #必传 //暂时不用

pid 设备型号  #必传

ver: 当前固件版本  #必传 （子设备举例：1.0.0，smartPad举例 1.0.0.0 ）

hardwareVersion: 硬件版本(可选) 

modelName 模块名称 #可选 暂时只有总包OS（zigbee子设备升级，不传modelName； smartPad必传该字段）

OS //总包，暂时只有总包

dreame //分区image 包 

all_apps //软件总包

core  //内核， 分区，image， 软件总包

centralControl

launcher

gateway

voice

   "queryConditions": [

{"pid":"", "ver":"", "modelName":""}

 ]

| SQL<br>/ota/check<br>请求实例：<br>{<br>    "reqId": "12345",<br>    #"modelName": "system",<br>    #"ver": "123",<br>    #"pid": "123123",<br>    "queryConditions":[<br>        {"pid":"", "ver":"", "modelName":""}, //modelName 可为空<br>        {"pid":"", "ver":""}<br>    ]<br>}<br>响应：<br>{<br>  "reqId": "57fb756ba9a540088a9179383a420a24",<br>  "code": 200,<br>  "msg": "success",<br>  "data": {<br>    [<br>        {<br>        "hasUpdate": true, # 有没有版本更新<br>        "isForce": false,<br>        "firmware": {<br>              "ver": "1.2.0",<br>              "versionName": "1.2.0 Release",<br>              "modelName":"模块名称",<br>              "fileUrl": "https://ota.example.com/firmware/1.2.0.bin",<br>              "ossParams": {<br>                    "endpoint": "https://oss-cn-shenzhen.aliyuncs.com",<br>                    "bucketName": "dreame-download",<br>                    "objectName": "ota/pad/test.zip",<br>                    "region": "cn-shenzhen"<br>                }<br>               "ossParams": {<br>                   "bucketName":"dreame-download",<br>                   "objectName":"ota/pad/test.zip"<br>                }<br>              "fileSize": 5242880,<br>              "fileMd5": "a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6",<br>              "description": "优化系统稳定性",<br>              "releaseNotes": "1. 修复已知bug\n2. 提升系统性能"<br>            },<br>         "pid":"2xxx"<br>        }<br>    ]<br>  }<br>}<br>curl:<br>curl -X POST http://127.0.0.1:8080/check   -H "Content-Type: application/json"   -d '{"reqId": "12345","modelName":"fkaer","firmwareVersion":"123","subdeviceType":"123","pid":"123123","deviceType":"手机","deviceId":"33"}' |
| --- |

当 ossParams 不为空的时，会根据配置好的json数据去获取oss下载地址，并且填充到  fileUrl

| JSON<br>{<br>    "code": 200,<br>    "msg": "success",<br>    "data": [<br>        {<br>            "pid": "2000000001",<br>            "isForce": false,<br>            "firmware": {<br>                "ver": "0.0.0.9",<br>                "versionName": "V1.2.0 Release",<br>                "modelName": "core",<br>                "fileUrl": "https://dreame-download.oss-cn-shenzhen.aliyuncs.com/ota/pad/test.zip?x-oss-date=20251015T072649Z&x-oss-expires=3600&x-oss-signature-version=OSS4-HMAC-SHA256&x-oss-credential=LTAI5t622gGNm6FUUAh7STpu%2F20251015%2Fcn-shenzhen%2Foss%2Faliyun_v4_request&x-oss-signature=ea941551a3f166d50c9533d7f23b9b03b4cd914590c2ab0f46d2cf23471cf443",<br>                "fileSize": 114665555,<br>                "fileMd5": "5ad221803713b838d502ef78225f74b4",<br>                "description": "内网下载0905OTA",<br>                "releaseNotes": "内网下载0905OTA",<br>                "ossParams": {<br>                    "bucketName": "dreame-download",<br>                    "objectName": "ota/pad/test.zip"<br>                }<br>            }<br>        }<br>    ],<br>    "reqId": "12345"<br>} |
| --- |

| JSON<br>// 查询设备 [{deviceId + version}, {deviceId + version}{deviceId + version} ]<br>// send ota : [{deviceId + version}, {deviceId + version}{deviceId + version} ]<br> |
| --- |

10.2 上报下载进度 

| Plain Text<br>POST /ota/progress<br>请求体：<br>{<br>  "reqId": "57fb756ba9a540088a9179383a420a24",<br>  "deviceId": "device123",<br>  "uid": "xxx",<br>  "taskId": 123,<br>  "progress": 50,<br>  "status": 1, // 1-下载中，2-下载完成，3-验证中<br>  "timestamp": 1620000000<br>}<br><br>响应：<br>{<br>  "reqId": "57fb756ba9a540088a9179383a420a24",<br>  "code": 200,<br>  "msg": "success"<br>} |
| --- |

10.3 上报升级结果 (/ota/result)

| Plain Text<br>POST /ota/result<br>请求体：<br>{<br>  "reqId": "57fb756ba9a540088a9179383a420a24",<br>  "deviceId": "device123",<br>  "uid": "xxx",<br>  "taskId": 123,<br>  "fromVersion": "1.1.0",<br>  "toVersion": "1.2.0",<br>  "status": 5, //状态：0-待升级，1-下载中，2-下载完成，3-验证中，4-升级中，5-升级成功，6-升级失败<br>  "timestamp": 1620000000<br>}<br><br>响应：<br>{<br>  "reqId": "57fb756ba9a540088a9179383a420a24",<br>  "code": 200,<br>  "msg": "success"<br>} |
| --- |

10.4 上传升级日志

| Plain Text<br>POST /ota/logs<br>请求体：<br>{<br>  "reqId": "57fb756ba9a540088a9179383a420a24",<br>  "deviceId": "device123",<br>  "uid": "xxx",<br>  "taskId": 123,<br>  "recordId": 456,<br>  "logs": [<br>    {<br>      "type": 1, //1为升级日志<br>      "level": 2, //1 debug，2 info， 3 warn， 4 error<br>      "content": "开始下载固件",<br>      "timestamp": 1620000000<br>    },<br>    {<br>      "type": 1,<br>      "level": 4,<br>      "content": "下载失败: 网络中断",<br>      "timestamp": 1620000005<br>    }<br>  ]<br>}<br><br>响应：<br>{<br>  "reqId": "57fb756ba9a540088a9179383a420a24",<br>  "code": 200,<br>  "msg": "success"<br>} |
| --- |

10.5  固件版本

10.5.1 创建固件版本 （/ota/firmware/add） 

| Plain Text<br>POST /ota/firmware/add<br>请求体：<br>{<br>    "reqId": "57fb756ba9a540088a9179383a420a24",<br>    "firmwareName": "智能门锁固件",<br>    "versionCode": "1.2.1",<br>    "versionName": "V1.2.0 Release",<br>    "modelName": "LOCK-X1",<br>    "deviceType": "light",<br>    "subDeviceType": "lock",<br>    "pid": "2xxx",<br>    "minHardwareVersion": "1.0",<br>    "filePath": "firmware/12345678.bin",<br>    "fileSize": 5242880,<br>    "fileMD5": "a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6",<br>    "description": "优化系统稳定性",<br>    "releaseNotes": "1. 修复已知bug\n2. 提升系统性能",<br>    "isForceUpdate": 1,<br>    "creator":"Rico",<br>    "scopes":"123,1231,123",<br>    "ossParams": {<br>                    "endpoint": "https://oss-cn-shenzhen.aliyuncs.asddasdfasdfasdf ",<br>                    "bucketName": "dreame-download",<br>                    "objectName": "ota/pad/test.zip",<br>                    "region": "cn-shenzhen"<br>                }<br>}<br>响应：<br>{<br>    "code": 200,<br>    "msg": "success",<br>    "data": {<br>        "ID": 6034,<br>        "FirmwareName": "智能门锁固件",<br>        "VersionCode": "1.2.1",<br>        "VersionName": "V1.2.0 Release",<br>        "ModelName": "LOCK-X1",<br>        "DeviceType": "light",<br>        "SubDeviceType": "lock",<br>        "PID": "2xxx",<br>        "MinHardwareVersion": "1.0",<br>        "FilePath": "firmware/12345678.bin",<br>        "FileSize": 5242880,<br>        "OssParams": {<br>            "endpoint": "https://oss-cn-shenzhen.aliyuncs.asddasdfasdfasdf ",<br>            "bucketName": "dreame-download",<br>            "objectName": "ota/pad/test.zip",<br>            "region": "cn-shenzhen"<br>        },<br>        "FileMd5": "a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6",<br>        "Description": "优化系统稳定性",<br>        "ReleaseNotes": "1. 修复已知bug\n2. 提升系统性能",<br>        "IsForceUpdate": 1,<br>        "Status": 0,<br>        "PublishTime": "2026-01-21 11:23:47",<br>        "CreateTime": "2026-01-21 11:23:47",<br>        "UpdateTime": "2026-01-21 11:23:47",<br>        "Creator": "",<br>        "Valid": 1,<br>        "Scopes": "123,1231,123"<br>    },<br>    "reqId": "57fb756ba9a540088a9179383a420a24"<br>} |
| --- |

10.5.2 删除固件版本（/ota/firmware/delete）

请求参数： 

reqId： 请求id #string #必传

id： 数据库唯一ID #uint #必传

| Plain Text<br>POST /ota/firmware/delete <br>请求体：<br>{  <br>    "reqId": "57fb756ba9a540088a9179383a420a24",<br>     "id":1<br>}<br><br>响应：<br>{<br>  "reqId": "57fb756ba9a540088a9179383a420a24",<br>  "code": 200,<br>  "msg": "success",<br>}<br><br> |
| --- |

10.5.3  查询固件版本 （/ota/firmware/query）

请求参数：

reqId： 请求id #string #必传

id： 数据库唯一ID #uint #必传

| Plain Text<br>代码块<br>POST /ota/firmware/query<br>请求体：<br>{<br>    "reqId": "57fb756ba9a540088a9179383a420a24",<br>     "id":3<br>}<br><br>响应：<br>{<br>    "code": 200,<br>    "msg": "success",<br>    "data": {<br>        "ID": 3,<br>        "FirmwareName": "智能门锁固件",<br>        "VersionCode": "1.3.2.2",<br>        "VersionName": "V1.2.0 Release",<br>        "ModelName": "LOCK-X1",<br>        "DeviceType": "light",<br>        "SubDeviceType": "lock",<br>        "PID": "p1",<br>        "MinHardwareVersion": "1.0",<br>        "FilePath": "firmware/12345678.bin",<br>        "FileSize": 5242880,<br>        "OssParams": {<br>            "endpoint": "https://oss-cn-shenzhen.aliyuncs.com",<br>            "bucketName": "dreame-download",<br>            "objectName": "ota/pad/test.zip",<br>            "region": "cn-shenzhen"<br>        },<br>        "FileMd5": "a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6",<br>        "Description": "优化系统稳定性",<br>        "ReleaseNotes": "1. 修复已知bug\n2. 提升系统性能",<br>        "IsForceUpdate": 1,<br>        "Status": 1,<br>        "PublishTime": "2025-08-05 17:13:29",<br>        "CreateTime": "2025-08-05 17:13:29",<br>        "UpdateTime": "2025-09-09 11:06:24",<br>        "Creator": "",<br>        "Valid": 1<br>    },<br>    "reqId": "57fb756ba9a540088a9179383a420a24"<br>} |
| --- |

10.5.4 修改固件版本  （/ota/firmware/update)

| Bash<br>{<br>    "data":{<br>        "id": 6035,<br>        "firmwareName": "22123123",<br>        "versionCode": "1.2.1",<br>        "versionName": "V1.2.0 Release",<br>        "modelName": "LOCK-X1",<br>        "deviceType": "light",<br>        "subDeviceType": "lock",<br>        "pid": "2xxx",<br>        "minHardwareVersion": "1.0",<br>        "filePath": "firmware/12345678.bin",<br>        "fileSize": 5242880,<br>        "ossParams": {<br>            "endpoint": "https://oss-cn-shenzhen.aliyuncs.asddasdfasdfasdf ",<br>            "bucketName": "dreame-download",<br>            "objectName": "ota/pad/test.zip",<br>            "region": "cn-shenzhen"<br>        },<br>        "fileMd5": "a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6",<br>        "description": "优化系统稳定性",<br>        "releaseNotes": "1. 修复已知bug\n2. 提升系统性能",<br>        "isForceUpdate": 1,<br>        "status": 0,<br>        "publishTime": "2026-01-21 11:36:17",<br>        "createTime": "2026-01-21 11:36:17",<br>        "updateTime": "2026-01-21 11:36:17",<br>        "creator": "",<br>        "valid": 1,<br>        "scopes": "123,1231,123"<br>    },<br>    "reqId": "57fb756ba9a540088a9179383a420a24"<br>}<br>响应<br>{<br>    "code": 200,<br>    "msg": "success",<br>    "data": "固件更新成功.",<br>    "reqId": "57fb756ba9a540088a9179383a420a24"<br>} |
| --- |

10.5.5 发布固件版本  （/ota/firmware/publish)

请求参数：

reqId： 请求id #string #必传

id： 数据库唯一ID #uint #必传

| Plain Text<br>POST /ota/firmware/publish<br>请求体：<br>{<br> "reqId": "57fb756ba9a540088a9179383a420a24",<br> "id": 123 #要发布的版本记录id<br>}<br>响应：<br>{<br>    "code":200,<br>    "msg":"success",<br>    "data":"固件发布成功.",<br>    "reqId":"57fb756ba9a540088a9179383a420a24"<br>} |
| --- |

Note: 发布之后要做定义扫描。发送消息

10.5.6 撤回固件版本  （/ota/firmware/withdraw)

请求参数：

reqId： 请求id #string #必传

id： 数据库唯一ID #uint #必传

| Bash<br>POST /ota/firmware/publish<br>请求体：<br>{<br> "reqId": "57fb756ba9a540088a9179383a420a24",<br> "id": 123 #要发布的版本记录id<br>}<br>响应：<br>{<br>    "code":200,<br>    "msg":"success",<br>    "data":"固件发布成功.",<br>    "reqId":"57fb756ba9a540088a9179383a420a24"<br>} |
| --- |

10.7 升级任务

10.7.1 创建升级任务 （ /ota/task/add）

| Plain Text<br>POST /ota/task/add<br>请求头:<br>familyId: family_id # 必传 <br>请求体：<br>{<br>  "reqId": "57fb756ba9a540088a9179383a420a24",<br>  "taskName": "LOCK-X1批量升级",<br>  "firmwareId": 123,<br>  "deviceType": "light",<br>  "subDeviceType":"home light",<br>  "targetVerison": "v2.2.1",<br>  "pid": "2xxx",<br>  "upgradeStrategy": 2, //'升级策略：0-立即升级，1-定时升级，2-分批升级',<br>  "startTime": "2023-05-01 02:00:00",<br>  "endTime": "2023-05-31 23:59:59", <br>  "batchConfig": {<br>    "batchType": "percentage",<br>    "batchValue": 10, <br>    "interval": 3600<br>  }<br>}<br><br>响应：<br>{ <br>     "code": 200,<br>     "msg": "success",<br>     "data": "添加OTA任务成功.",<br>     "reqId": "57fb756ba9a540088a9179383a420a24"<br>} |
| --- |

10.7.2  删除升级任务（ /ota/task/delete）

请求参数： 

reqId： 请求id #string #必传

id： 数据库唯一ID #uint #必传

| Plain Text<br>POST /ota/task/delete <br>请求体：<br>{<br>    "reqId": "57fb756ba9a540088a9179383a420a24",<br>     "id":1<br>}<br><br>响应：<br>{<br>  "reqId": "57fb756ba9a540088a9179383a420a24",<br>  "code": 200,<br>  "msg": "success",<br>}<br><br> |
| --- |

10.7.3 修改升级任务 （ /ota/task/update）

| YAML<br>代码块<br>POST /ota/task/update<br>请求体：<br>{<br>  "id": 2,<br>  "reqId": "57fb756ba9a540088a9179383a420a24",<br>  "taskName": "LOCK-X1批量升级asdfasdfasdf2",<br>  "subDeviceType":"home light3",<br>  "targetVerison":"123",<br>  "firmwareId": 123,<br>  "deviceType": "light",<br>  "pid": "2xxx",<br>  "upgradeStrategy": 2,<br>  "startTime": "2023-05-01 02:00:00",<br>  "endTime": "2023-05-31 23:59:59",<br>  "batchConfig": {<br>    "batchType": "percentage",<br>    "batchValue": 10,<br>    "interval": 3600<br>  }<br>}<br><br>响应：<br>{<br>        "code": 200,<br>        "msg": "success",<br>        "data": {<br>                "ID": 1,<br>                "TaskName": "LOCK-X1批量升级asdfasdfasdf2",<br>                "FirmwareID": 123,<br>                "DeviceType": "light",<br>                "SubDeviceType": "",<br>                "PID": "2xxx",<br>                "TargetVersion": "",<br>                "UpgradeStrategy": 2,<br>                "start_time": "2023-05-01 02:00:00",<br>                "end_time": "2023-05-31T23:59:59",<br>                "BatchConfig": "",<br>                "Status": 0,<br>                "CreateTime": "0001-01-01 00:00:00",<br>                "UpdateTime": "2025-06-13 19:28:30",<br>                "Valid": 0,<br>                "Creator": ""<br>        },<br>        "reqId": "57fb756ba9a540088a9179383a420a24"<br>} |
| --- |

10.7.4 查询升级任务  （ /ota/task/query）

| SQL<br>代码块<br>POST /ota/task/query<br>请求体：<br>{<br>    "reqId": "57fb756ba9a540088a9179383a420a24",<br>     "id":1<br>}<br><br>响应：<br>{<br>        "code": 200,<br>        "msg": "success",<br>        "data": {<br>                "ID": 2,<br>                "TaskName": "LOCK-X1批量升级1",<br>                "FirmwareID": 123,<br>                "DeviceType": "light",<br>                "SubDeviceType": "",<br>                "PID": "2xxx",<br>                "TargetVersion": "",<br>                "UpgradeStrategy": 2,<br>                "start_time": "2023-05-01 02:00:00",<br>                "end_time": "2023-05-31T23:59:59",<br>                "BatchConfig": "{\"batchType\":\"percentage\",\"batchValue\":10,\"interval\":3600}",<br>                "Status": 0,<br>                "CreateTime": "2025-06-13 18:23:27",<br>                "UpdateTime": "2025-06-13 18:23:27",<br>                "Valid": 1,<br>                "Creator": ""<br>        },<br>        "reqId": "12345"<br>} |
| --- |

10.8 查询升级任务状态  

| Plain Text<br>POST /ota/tasks/{id}<br>请求体：<br>{<br> "reqId": "57fb756ba9a540088a9179383a420a24",<br> "id": 123<br>}<br>响应：<br>{<br>  "reqId": "57fb756ba9a540088a9179383a420a24",<br>  "code": 0,<br>  "msg": "success",<br>  "data": {<br>    "id": 456,<br>    "taskName": "LOCK-X1批量升级",<br>    "firmwareId": 123,<br>    "deviceType": "light",<br>    "pid": "2xxx",<br>    "targetVersion": "1.2.0",<br>    "upgradeStrategy": 2,<br>    "startTime": "2023-05-01 02:00:00",<br>    "endTime": "2023-05-31 23:59:59",<br>    "status": 1,  //'状态：0-未开始，1-进行中，2-已完成，3-已取消',<br>    "statistics": {<br>      "total": 1000,<br>      "pending": 200,<br>      "downloading": 100,<br>      "success": 600,<br>      "failed": 100<br>    },<br>    "createTime": "2023-04-28 15:30:00"<br>  }<br>} |
| --- |

10.9 设备升级记录

10.9.1  新增设备升级记录 (/ota/records/add)

请求参数： 

reqId： "57fb756ba9a540088a9179383a420a24" 请求id #string #必传 

device_id: "DEV2025" , 设备ID 必传

"task_id": 1001, # 任务id 可选

"from_version": "1.2.0", #升级前版本 必传

"to_version": "2.0.0", #升级后版本   必传

"status": 0, # 状态 可选  默认为0 

"retry_count": 0,  # 重试次数 可选 默认为0 

"download_progress": 0 下载进度0-100 可选 默认为0

| JSON<br>代码块<br>POST /ota/records/add<br>请求参数<br>{<br>    "reqId": "57fb756ba9a540088a9179383a420a24",   <br>    "device_id": "DEV2025",<br>    "task_id": 1001,<br>    "from_version": "1.2.0",<br>    "to_version": "2.0.0",<br>    "status": 0,<br>    "retry_count": 0,<br>    "download_progress": 0<br>}<br>响应：<br>{<br>        "code": 200,<br>        "msg": "success",<br>        "data": {<br>                "id": 0,<br>                "device_id": "DEV2025",<br>                "task_id": 1001,<br>                "from_version": "1.2.0",<br>                "to_version": "2.0.0",<br>                "status": 0,<br>                "retry_count": 0,<br>                "error_code": "",<br>                "error_msg": "",<br>                "download_progress": 0,<br>                "upgrade_time": null,<br>                "valid": false,<br>                "create_time": "0001-01-01 00:00:00",<br>                "update_time": "0001-01-01 00:00:00"<br>        },<br>        "reqId": "57fb756ba9a540088a9179383a420a24"<br>} |
| --- |

10.9.2  删除设备升级记录 (/ota/records/delete)

请求参数： 

reqId： "57fb756ba9a540088a9179383a420a24" 请求id #string #必传 

id： 数据库唯一ID #uint #必传

| SQL<br>POST /ota/records/delete <br>请求体：<br>{<br>    "reqId": "57fb756ba9a540088a9179383a420a24",<br>     "id":1<br>}<br><br>响应：<br>{<br>  "reqId": "57fb756ba9a540088a9179383a420a24",<br>  "code": 200,<br>  "msg": "success",<br>}<br><br> |
| --- |

10.9.3  修改设备升级记录 (/ota/records/update)

请求参数：

参数  类型   是否必传  说明 

id  uint    是   -   需更新的OTA升级记录唯一ID，通过路径参数或Body传递

reqId   string  是   -   请求唯一标识，用于链路追踪（如 req_20250616_001）

device_id   string  是   max=64  设备唯一标识（如IMEI/MAC地址）

task_id  uint   否   -   关联的OTA任务ID，指针类型区分零值与未传递

from_version    string  是   semver  当前设备版本（如 1.2.0），需符合语义化版本规范

to_version  string  是   semver  目标升级版本（如 2.0.1）

status  int8    否   oneof=0 1 2 3 4 状态码：    0：待升级     1：升级中     2：升级成功     3：升级失败     4：升级超时

retry_count int8    否   0≤x≤127 重试次数（默认0），失败时建议递增

download_progress   int  否   0≤x≤100 下载进度百分比（如 50）

error_code  string  否   max=32  错误代码 

error_msg   string  否   max=255 错误详情（如“网络连接超时”）

upgrade_time  时间字串    否   RFC3339格式  

valid   bool    否   -   记录有效性（默认 true） 

| JSON<br>代码块<br>请求：<br>{<br>    "reqId": "57fb756ba9a540088a9179383a420a24",<br>    "id": 2,<br>    "device_id": "device_001",<br>    "task_id": 1001,<br>    "from_version": "1.0.0",<br>    "to_version": "2.0.0",<br>    "status": 2,<br>    "retry_count": 3,<br>    "download_progress": 50,<br>    "error_msg": "Timeout occurred",<br>    "error_code": "ERR_408",<br>    "upgrade_time": "2025-06-16 15:04:05",<br>    "valid": true<br>}<br>响应：<br>{<br>        "code": 200,<br>        "msg": "success",<br>        "data": {<br>                "ID": 2,<br>                "device_id": "device_001",<br>                "task_id": 1001,<br>                "from_version": "1.0.0",<br>                "to_version": "2.0.0",<br>                "status": 2,<br>                "retry_count": 3,<br>                "error_code": "ERR_408",<br>                "error_msg": "Timeout occurred",<br>                "download_progress": 50,<br>                "upgrade_time": "2025-06-16 15:04:05",<br>                "valid": true,<br>                "create_time": "0001-01-01 00:00:00",<br>                "update_time": "2025-06-16 12:02:12"<br>        },<br>        "reqId": "57fb756ba9a540088a9179383a420a24"<br>}<br> |
| --- |

10.9.4  查询设备升级记录 (/ota/records/query)

请求参数：

reqId： "57fb756ba9a540088a9179383a420a24" 请求id #string #必传 

id： 数据库唯一ID #uint #必传

| Plain Text<br>代码块<br>POST /ota/records/query<br>请求体：<br>{<br>    "reqId": "57fb756ba9a540088a9179383a420a24",<br>     "id":2<br>}<br><br>响应：<br>{<br>    "code": 200,<br>    "msg": "success",<br>    "data": {<br>        "id": 2,<br>        "device_id": "DEV2025",<br>        "task_id": 1001,<br>        "from_version": "1.2.0",<br>        "to_version": "2.0.0",<br>        "status": 0,<br>        "retry_count": 0,<br>        "error_code": "",<br>        "error_msg": "",<br>        "download_progress": 0,<br>        "upgrade_time": null,<br>        "valid": true,<br>        "create_time": "2025-06-16 11:03:12",<br>        "update_time": "2025-06-16 11:03:12"<br>    },<br>    "reqId": "57fb756ba9a540088a9179383a420a24"<br>} |
| --- |

暂放：分页查询

| Plain Text<br>POST /ota/records<br>查询参数：<br>- deviceId: 可选<br>- taskId: 可选<br>- status: 可选<br>- page: 页码，默认为1<br>- pageSize: 每页数量，默认为20<br><br>响应：<br>{<br>  "reqId": "57fb756ba9a540088a9179383a420a24",<br>  "code": 200,<br>  "msg": "success",<br>  "data": {<br>    "total": 100,<br>    "list": [<br>      {<br>        "id": 789,<br>        "deviceId": "device123",<br>        "deviceName": "客厅灯",<br>        "taskId": 456,<br>        "taskName": "LOCK-X1批量升级",<br>        "fromVersion": "1.1.0",<br>        "toVersion": "1.2.0",<br>        "status": 5,<br>        "upgradeTime": "2023-05-01 03:12:34",<br>        "createTime": "2023-05-01 02:00:00"<br>      }<br>    ]<br>  }<br>} |
| --- |

10.10  OTA 白名单

10.10.1 创建白名单

10.10.2 删除白名单

10.10.3 修改白名单

10.10.4 查询白名单

11. 天气（HTTPS)

11.1 实时天气查询 (/weather/now)

请求参数

location： 地区ID/经纬度  #string  

地区id： 101010100

经纬度格式： 116.41,39.92

city: 城市拼音，如（Shenzhen） #string

reqId： 请求id #string

familyId ：家庭id # string

| Plain Text<br>代码块<br>POST /now <br><br>查询参数：<br>- reqId: 必填<br>- location: 必填<br>请求体：<br>{<br> "reqId": "57fb756ba9a540088a9179383a420a24",<br> "location": "101010100" #北京<br>}<br>响应：<br>{<br>        "code": 200,<br>        "msg": "success",<br>        "data": {<br>                "cloud": "0",<br>                "dew": "9",<br>                "feelsLike": "28",<br>                "humidity": "29",<br>                "icon": "100",<br>                "obsTime": "2025-06-11 10:25",<br>                "precip": "0.0",<br>                "pressure": "1007",<br>                "temp": "30",<br>                "text": "晴",<br>                "vis": "17",<br>                "wind360": "225",<br>                "windDir": "西南风",<br>                "windScale": "3",<br>                "windSpeed": "18"<br>        },<br>        "reqId": "57fb756ba9a540088a9179383a420a24"<br>} |
| --- |

相应天气字段说明：

weather.obsTime 数据观测时间

weather.temp 温度，默认单位：摄氏度

weather.feelsLike 体感温度，默认单位：摄氏度

weather.icon 天气状况的图标代码，另请参考天气图标项目

weather.text 天气状况的文字描述，包括阴晴雨雪等天气状态的描述

weather.wind360 风向360角度

weather.windDir 风向

weather.windScale 风力等级

weather.windSpeed 风速，公里/小时

weather.humidity 相对湿度，百分比数值

weather.precip 过去1小时降水量，默认单位：毫米

weather.pressure 大气压强，默认单位：百帕

weather.vis 能见度，默认单位：公里

weather.cloud 云量，百分比数值。可能为空

weather.dew 露点温度。可能为空

11.2 三天内天气预报(/weather/3d)

请求参数

location： 地区ID #string

reqId： 请求id #string

| Bash<br>POST /3d<br>查询参数：<br>- reqId: 必填<br>- location: 必填<br>请求体：<br>{<br> "reqId": "57fb756ba9a540088a9179383a420a24",<br> "location": "101010100" #北京<br>}<br>响应：<br>{<br>        "code": 200,<br>        "msg": "success",<br>        "data": [{<br>                "cloud": "1",<br>                "fxDate": "2025-06-11",<br>                "humidity": "32",<br>                "iconDay": "100",<br>                "iconNight": "151",<br>                "moonPhase": "满月",<br>                "moonPhaseIcon": "804",<br>                "moonrise": "20:04",<br>                "moonset": "04:04",<br>                "precip": "0.0",<br>                "pressure": "1002",<br>                "sunrise": "04:46",<br>                "sunset": "19:43",<br>                "tempMax": "35",<br>                "tempMin": "25",<br>                "textDay": "晴",<br>                "textNight": "多云",<br>                "uvIndex": "11",<br>                "vis": "25",<br>                "wind360Day": "180",<br>                "wind360Night": "180",<br>                "windDirDay": "南风",<br>                "windDirNight": "南风",<br>                "windScaleDay": "1-3",<br>                "windScaleNight": "1-3",<br>                "windSpeedDay": "3",<br>                "windSpeedNight": "3"<br>        }, {<br>                "cloud": "3",<br>                "fxDate": "2025-06-12",<br>                "humidity": "40",<br>                "iconDay": "101",<br>                "iconNight": "104",<br>                "moonPhase": "亏凸月",<br>                "moonPhaseIcon": "805",<br>                "moonrise": "20:57",<br>                "moonset": "04:52",<br>                "precip": "0.0",<br>                "pressure": "1002",<br>                "sunrise": "04:46",<br>                "sunset": "19:44",<br>                "tempMax": "34",<br>                "tempMin": "22",<br>                "textDay": "多云",<br>                "textNight": "阴",<br>                "uvIndex": "11",<br>                "vis": "24",<br>                "wind360Day": "180",<br>                "wind360Night": "180",<br>                "windDirDay": "南风",<br>                "windDirNight": "南风",<br>                "windScaleDay": "1-3",<br>                "windScaleNight": "1-3",<br>                "windSpeedDay": "16",<br>                "windSpeedNight": "3"<br>        }, {<br>                "cloud": "25",<br>                "fxDate": "2025-06-13",<br>                "humidity": "73",<br>                "iconDay": "104",<br>                "iconNight": "305",<br>                "moonPhase": "亏凸月",<br>                "moonPhaseIcon": "805",<br>                "moonrise": "21:45",<br>                "moonset": "05:49",<br>                "precip": "0.0",<br>                "pressure": "998",<br>                "sunrise": "04:46",<br>                "sunset": "19:44",<br>                "tempMax": "32",<br>                "tempMin": "22",<br>                "textDay": "阴",<br>                "textNight": "小雨",<br>                "uvIndex": "6",<br>                "vis": "24",<br>                "wind360Day": "135",<br>                "wind360Night": "90",<br>                "windDirDay": "东南风",<br>                "windDirNight": "东风",<br>                "windScaleDay": "1-3",<br>                "windScaleNight": "1-3",<br>                "windSpeedDay": "3",<br>                "windSpeedNight": "3"<br>        }],<br>        "reqId": "57fb756ba9a540088a9179383a420a24"<br>} |
| --- |

返回天气字段说明

data.fxDate 预报日期

data.sunrise 日出时间，在高纬度地区可能为空

data.sunset 日落时间，在高纬度地区可能为空

data.moonrise 当天月升时间，可能为空

data.moonset 当天月落时间，可能为空

data.moonPhase 月相名称

data.moonPhaseIcon 月相图标代码，另请参考天气图标项目

data.tempMax 预报当天最高温度

data.tempMin 预报当天最低温度

data.iconDay 预报白天天气状况的图标代码，另请参考天气图标项目

data.textDay 预报白天天气状况文字描述，包括阴晴雨雪等天气状态的描述

data.iconNight 预报夜间天气状况的图标代码，另请参考天气图标项目

data.textNight 预报晚间天气状况文字描述，包括阴晴雨雪等天气状态的描述

data.wind360Day 预报白天风向360角度

data.windDirDay 预报白天风向

data.windScaleDay 预报白天风力等级

data.windSpeedDay 预报白天风速，公里/小时

data.wind360Night 预报夜间风向360角度

data.windDirNight 预报夜间当天风向

data.windScaleNight 预报夜间风力等级

data.windSpeedNight 预报夜间风速，公里/小时

data.precip 预报当天总降水量，默认单位：毫米

data.uvIndex 紫外线强度指数

data.humidity 相对湿度，百分比数值

data.pressure 大气压强，默认单位：百帕

data.vis 能见度，默认单位：公里

data.cloud 云量，百分比数值。可能为空

11.3 七天内天气预报(/weather/7d)

请求参数

location： 地区ID #string

reqId： 请求id #string

| Bash<br>POST /7d<br>查询参数：<br>- reqId: 必填<br>- location: 必填<br>请求体：<br>{<br> "reqId": "57fb756ba9a540088a9179383a420a24",<br> "location": "101010100" #北京<br>}<br>响应：<br>{<br>        "code": 200,<br>        "msg": "success",<br>        "data": [{<br>                "cloud": "1",<br>                "fxDate": "2025-06-11",<br>                "humidity": "32",<br>                "iconDay": "100",<br>                "iconNight": "151",<br>                "moonPhase": "满月",<br>                "moonPhaseIcon": "804",<br>                "moonrise": "20:04",<br>                "moonset": "04:04",<br>                "precip": "0.0",<br>                "pressure": "1002",<br>                "sunrise": "04:46",<br>                "sunset": "19:43",<br>                "tempMax": "35",<br>                "tempMin": "25",<br>                "textDay": "晴",<br>                "textNight": "多云",<br>                "uvIndex": "11",<br>                "vis": "25",<br>                "wind360Day": "180",<br>                "wind360Night": "180",<br>                "windDirDay": "南风",<br>                "windDirNight": "南风",<br>                "windScaleDay": "1-3",<br>                "windScaleNight": "1-3",<br>                "windSpeedDay": "3",<br>                "windSpeedNight": "3"<br>        }, {<br>                "cloud": "3",<br>                "fxDate": "2025-06-12",<br>                "humidity": "40",<br>                "iconDay": "101",<br>                "iconNight": "104",<br>                "moonPhase": "亏凸月",<br>                "moonPhaseIcon": "805",<br>                "moonrise": "20:57",<br>                "moonset": "04:52",<br>                "precip": "0.0",<br>                "pressure": "1002",<br>                "sunrise": "04:46",<br>                "sunset": "19:44",<br>                "tempMax": "34",<br>                "tempMin": "22",<br>                "textDay": "多云",<br>                "textNight": "阴",<br>                "uvIndex": "11",<br>                "vis": "24",<br>                "wind360Day": "180",<br>                "wind360Night": "180",<br>                "windDirDay": "南风",<br>                "windDirNight": "南风",<br>                "windScaleDay": "1-3",<br>                "windScaleNight": "1-3",<br>                "windSpeedDay": "16",<br>                "windSpeedNight": "3"<br>        }, {<br>                "cloud": "25",<br>                "fxDate": "2025-06-13",<br>                "humidity": "73",<br>                "iconDay": "104",<br>                "iconNight": "305",<br>                "moonPhase": "亏凸月",<br>                "moonPhaseIcon": "805",<br>                "moonrise": "21:45",<br>                "moonset": "05:49",<br>                "precip": "0.0",<br>                "pressure": "998",<br>                "sunrise": "04:46",<br>                "sunset": "19:44",<br>                "tempMax": "32",<br>                "tempMin": "22",<br>                "textDay": "阴",<br>                "textNight": "小雨",<br>                "uvIndex": "6",<br>                "vis": "24",<br>                "wind360Day": "135",<br>                "wind360Night": "90",<br>                "windDirDay": "东南风",<br>                "windDirNight": "东风",<br>                "windScaleDay": "1-3",<br>                "windScaleNight": "1-3",<br>                "windSpeedDay": "3",<br>                "windSpeedNight": "3"<br>        }],<br>        "reqId": "57fb756ba9a540088a9179383a420a24"<br>} |
| --- |

返回天气字段说明

data.fxDate 预报日期

data.sunrise 日出时间，在高纬度地区可能为空

data.sunset 日落时间，在高纬度地区可能为空

data.moonrise 当天月升时间，可能为空

data.moonset 当天月落时间，可能为空

data.moonPhase 月相名称

data.moonPhaseIcon 月相图标代码，另请参考天气图标项目

data.tempMax 预报当天最高温度

data.tempMin 预报当天最低温度

data.iconDay 预报白天天气状况的图标代码，另请参考天气图标项目

data.textDay 预报白天天气状况文字描述，包括阴晴雨雪等天气状态的描述

data.iconNight 预报夜间天气状况的图标代码，另请参考天气图标项目

data.textNight 预报晚间天气状况文字描述，包括阴晴雨雪等天气状态的描述

data.wind360Day 预报白天风向360角度

data.windDirDay 预报白天风向

data.windScaleDay 预报白天风力等级

data.windSpeedDay 预报白天风速，公里/小时

data.wind360Night 预报夜间风向360角度

data.windDirNight 预报夜间当天风向

data.windScaleNight 预报夜间风力等级

data.windSpeedNight 预报夜间风速，公里/小时

data.precip 预报当天总降水量，默认单位：毫米

data.uvIndex 紫外线强度指数

data.humidity 相对湿度，百分比数值

data.pressure 大气压强，默认单位：百帕

data.vis 能见度，默认单位：公里

data.cloud 云量，百分比数值。可能为空

11.4  逐小时天气预报 (/weather/hour/[24h/72h/168h])

http://服务器地址/weather/hour/24h  #查询24小时

http://服务器地址/weather/hour/72h  #查询72小时

http://服务器地址/weather/hour/168h  #查询168小时

请求参数：

location： 地区ID #string# 必传

reqId： 请求id #string #必传

| Plain Text<br>POST /hour/24h<br>{<br> "reqId": "57fb756ba9a540088a9179383a420a24",<br> "location": "101280604",  <br>}<br>响应体：<br>{<br>    "code": 200,<br>    "msg": "success",<br>    "data": [<br>        {<br>            "cloud": "100",<br>            "dew": "26",<br>            "fxTime": "2025-07-21T12:00+08:00",<br>            "humidity": "85",<br>            "icon": "101",<br>            "pop": "38",<br>            "precip": "0.0",<br>            "pressure": "994",<br>            "temp": "28",<br>            "text": "多云",<br>            "wind360": "158",<br>            "windDir": "南风",<br>            "windScale": "3-4",<br>            "windSpeed": "20"<br>        },<br>        {<br>            "cloud": "100",<br>            "dew": "26",<br>            "fxTime": "2025-07-21T13:00+08:00",<br>            "humidity": "85",<br>            "icon": "305",<br>            "pop": "58",<br>            "precip": "2.5",<br>            "pressure": "995",<br>            "temp": "29",<br>            "text": "小雨",<br>            "wind360": "168",<br>            "windDir": "南风",<br>            "windScale": "3-4",<br>            "windSpeed": "20"<br>        },<br>        {<br>            "cloud": "100",<br>            "dew": "26",<br>            "fxTime": "2025-07-21T14:00+08:00",<br>            "humidity": "82",<br>            "icon": "305",<br>            "pop": "70",<br>            "precip": "0.9",<br>            "pressure": "995",<br>            "temp": "29",<br>            "text": "小雨",<br>            "wind360": "174",<br>            "windDir": "南风",<br>            "windScale": "3-4",<br>            "windSpeed": "22"<br>        },<br>        {<br>            "cloud": "100",<br>            "dew": "26",<br>            "fxTime": "2025-07-21T15:00+08:00",<br>            "humidity": "85",<br>            "icon": "305",<br>            "pop": "70",<br>            "precip": "0.36",<br>            "pressure": "996",<br>            "temp": "29",<br>            "text": "小雨",<br>            "wind360": "175",<br>            "windDir": "南风",<br>            "windScale": "3-4",<br>            "windSpeed": "22"<br>        },<br>        {<br>            "cloud": "100",<br>            "dew": "26",<br>            "fxTime": "2025-07-21T16:00+08:00",<br>            "humidity": "85",<br>            "icon": "305",<br>            "pop": "70",<br>            "precip": "0.6",<br>            "pressure": "996",<br>            "temp": "28",<br>            "text": "小雨",<br>            "wind360": "174",<br>            "windDir": "南风",<br>            "windScale": "3-4",<br>            "windSpeed": "20"<br>        },<br>        {<br>            "cloud": "100",<br>            "dew": "26",<br>            "fxTime": "2025-07-21T17:00+08:00",<br>            "humidity": "86",<br>            "icon": "305",<br>            "pop": "70",<br>            "precip": "0.12",<br>            "pressure": "995",<br>            "temp": "28",<br>            "text": "小雨",<br>            "wind360": "171",<br>            "windDir": "南风",<br>            "windScale": "3-4",<br>            "windSpeed": "20"<br>        },<br>        {<br>            "cloud": "100",<br>            "dew": "26",<br>            "fxTime": "2025-07-21T18:00+08:00",<br>            "humidity": "86",<br>            "icon": "305",<br>            "pop": "70",<br>            "precip": "0.2",<br>            "pressure": "995",<br>            "temp": "27",<br>            "text": "小雨",<br>            "wind360": "166",<br>            "windDir": "南风",<br>            "windScale": "3-4",<br>            "windSpeed": "20"<br>        },<br>        {<br>            "cloud": "100",<br>            "dew": "25",<br>            "fxTime": "2025-07-21T19:00+08:00",<br>            "humidity": "88",<br>            "icon": "305",<br>            "pop": "63",<br>            "precip": "0.3",<br>            "pressure": "995",<br>            "temp": "27",<br>            "text": "小雨",<br>            "wind360": "160",<br>            "windDir": "南风",<br>            "windScale": "1-3",<br>            "windSpeed": "18"<br>        },<br>        {<br>            "cloud": "100",<br>            "dew": "25",<br>            "fxTime": "2025-07-21T20:00+08:00",<br>            "humidity": "89",<br>            "icon": "305",<br>            "pop": "70",<br>            "precip": "1.0",<br>            "pressure": "995",<br>            "temp": "26",<br>            "text": "小雨",<br>            "wind360": "155",<br>            "windDir": "东南风",<br>            "windScale": "1-3",<br>            "windSpeed": "18"<br>        },<br>        {<br>            "cloud": "100",<br>            "dew": "25",<br>            "fxTime": "2025-07-21T21:00+08:00",<br>            "humidity": "89",<br>            "icon": "306",<br>            "pop": "63",<br>            "precip": "0.3",<br>            "pressure": "995",<br>            "temp": "26",<br>            "text": "中雨",<br>            "wind360": "151",<br>            "windDir": "东南风",<br>            "windScale": "1-3",<br>            "windSpeed": "16"<br>        },<br>        {<br>            "cloud": "100",<br>            "dew": "25",<br>            "fxTime": "2025-07-21T22:00+08:00",<br>            "humidity": "90",<br>            "icon": "305",<br>            "pop": "70",<br>            "precip": "0.37",<br>            "pressure": "995",<br>            "temp": "26",<br>            "text": "小雨",<br>            "wind360": "148",<br>            "windDir": "东南风",<br>            "windScale": "1-3",<br>            "windSpeed": "16"<br>        },<br>        {<br>            "cloud": "100",<br>            "dew": "25",<br>            "fxTime": "2025-07-21T23:00+08:00",<br>            "humidity": "90",<br>            "icon": "306",<br>            "pop": "70",<br>            "precip": "1.6",<br>            "pressure": "996",<br>            "temp": "26",<br>            "text": "中雨",<br>            "wind360": "147",<br>            "windDir": "东南风",<br>            "windScale": "1-3",<br>            "windSpeed": "14"<br>        },<br>        {<br>            "cloud": "100",<br>            "dew": "25",<br>            "fxTime": "2025-07-22T00:00+08:00",<br>            "humidity": "91",<br>            "icon": "305",<br>            "pop": "70",<br>            "precip": "0.24",<br>            "pressure": "996",<br>            "temp": "26",<br>            "text": "小雨",<br>            "wind360": "149",<br>            "windDir": "东南风",<br>            "windScale": "1-3",<br>            "windSpeed": "14"<br>        },<br>        {<br>            "cloud": "100",<br>            "dew": "25",<br>            "fxTime": "2025-07-22T01:00+08:00",<br>            "humidity": "89",<br>            "icon": "305",<br>            "pop": "70",<br>            "precip": "0.13",<br>            "pressure": "997",<br>            "temp": "26",<br>            "text": "小雨",<br>            "wind360": "152",<br>            "windDir": "东南风",<br>            "windScale": "1-3",<br>            "windSpeed": "14"<br>        },<br>        {<br>            "cloud": "100",<br>            "dew": "25",<br>            "fxTime": "2025-07-22T02:00+08:00",<br>            "humidity": "88",<br>            "icon": "306",<br>            "pop": "60",<br>            "precip": "0.5",<br>            "pressure": "997",<br>            "temp": "26",<br>            "text": "中雨",<br>            "wind360": "154",<br>            "windDir": "东南风",<br>            "windScale": "1-3",<br>            "windSpeed": "14"<br>        },<br>        {<br>            "cloud": "100",<br>            "dew": "25",<br>            "fxTime": "2025-07-22T03:00+08:00",<br>            "humidity": "88",<br>            "icon": "306",<br>            "pop": "66",<br>            "precip": "1.4",<br>            "pressure": "997",<br>            "temp": "26",<br>            "text": "中雨",<br>            "wind360": "152",<br>            "windDir": "东南风",<br>            "windScale": "1-3",<br>            "windSpeed": "14"<br>        },<br>        {<br>            "cloud": "100",<br>            "dew": "25",<br>            "fxTime": "2025-07-22T04:00+08:00",<br>            "humidity": "89",<br>            "icon": "305",<br>            "pop": "70",<br>            "precip": "0.41",<br>            "pressure": "997",<br>            "temp": "26",<br>            "text": "小雨",<br>            "wind360": "149",<br>            "windDir": "东南风",<br>            "windScale": "1-3",<br>            "windSpeed": "14"<br>        },<br>        {<br>            "cloud": "100",<br>            "dew": "25",<br>            "fxTime": "2025-07-22T05:00+08:00",<br>            "humidity": "89",<br>            "icon": "306",<br>            "pop": "61",<br>            "precip": "0.7",<br>            "pressure": "996",<br>            "temp": "26",<br>            "text": "中雨",<br>            "wind360": "147",<br>            "windDir": "东南风",<br>            "windScale": "1-3",<br>            "windSpeed": "14"<br>        },<br>        {<br>            "cloud": "100",<br>            "dew": "25",<br>            "fxTime": "2025-07-22T06:00+08:00",<br>            "humidity": "90",<br>            "icon": "305",<br>            "pop": "61",<br>            "precip": "0.7",<br>            "pressure": "996",<br>            "temp": "26",<br>            "text": "小雨",<br>            "wind360": "147",<br>            "windDir": "东南风",<br>            "windScale": "1-3",<br>            "windSpeed": "14"<br>        },<br>        {<br>            "cloud": "100",<br>            "dew": "25",<br>            "fxTime": "2025-07-22T07:00+08:00",<br>            "humidity": "91",<br>            "icon": "305",<br>            "pop": "70",<br>            "precip": "0.46",<br>            "pressure": "996",<br>            "temp": "26",<br>            "text": "小雨",<br>            "wind360": "147",<br>            "windDir": "东南风",<br>            "windScale": "1-3",<br>            "windSpeed": "13"<br>        },<br>        {<br>            "cloud": "100",<br>            "dew": "25",<br>            "fxTime": "2025-07-22T08:00+08:00",<br>            "humidity": "90",<br>            "icon": "305",<br>            "pop": "70",<br>            "precip": "0.12",<br>            "pressure": "996",<br>            "temp": "27",<br>            "text": "小雨",<br>            "wind360": "146",<br>            "windDir": "东南风",<br>            "windScale": "1-3",<br>            "windSpeed": "13"<br>        },<br>        {<br>            "cloud": "99",<br>            "dew": "25",<br>            "fxTime": "2025-07-22T09:00+08:00",<br>            "humidity": "87",<br>            "icon": "305",<br>            "pop": "63",<br>            "precip": "8.0",<br>            "pressure": "996",<br>            "temp": "28",<br>            "text": "小雨",<br>            "wind360": "142",<br>            "windDir": "东南风",<br>            "windScale": "1-3",<br>            "windSpeed": "14"<br>        },<br>        {<br>            "cloud": "98",<br>            "dew": "25",<br>            "fxTime": "2025-07-22T10:00+08:00",<br>            "humidity": "81",<br>            "icon": "305",<br>            "pop": "70",<br>            "precip": "0.12",<br>            "pressure": "996",<br>            "temp": "29",<br>            "text": "小雨",<br>            "wind360": "138",<br>            "windDir": "东南风",<br>            "windScale": "1-3",<br>            "windSpeed": "16"<br>        },<br>        {<br>            "cloud": "98",<br>            "dew": "25",<br>            "fxTime": "2025-07-22T11:00+08:00",<br>            "humidity": "78",<br>            "icon": "305",<br>            "pop": "70",<br>            "precip": "1.0",<br>            "pressure": "997",<br>            "temp": "30",<br>            "text": "小雨",<br>            "wind360": "136",<br>            "windDir": "东南风",<br>            "windScale": "1-3",<br>            "windSpeed": "18"<br>        }<br>    ],<br>    "reqId": "57fb756ba9a540088a9179383a420a24"<br>} |
| --- |

返回天气字段说明 data:

fxTime 预报时间

temp 温度，默认单位：摄氏度

icon 天气状况的图标代码，另请参考天气图标项目

text 天气状况的文字描述，包括阴晴雨雪等天气状态的描述

wind360 风向360角度

```
windDir 风向
windScale 风力等级
```
windSpeed 风速，公里/小时

humidity 相对湿度，百分比数值

precip 当前小时累计降水量，默认单位：毫米

pop 逐小时预报降水概率，百分比数值，可能为空

pressure 大气压强，默认单位：百帕

cloud 云量，百分比数值。可能为空

dew 露点温度。可能为空

sources 原始数据来源，或数据源说明，可能为空

license 数据许可或版权声明，可能为空

11.5 查询地区ID (/weather/location)

请求参数

locationname: 地区名称 (英文缩写) #string

reqId： 请求id #string

| Plain Text<br>代码块<br>POST /location<br>请求体：<br>{<br> "reqId": "57fb756ba9a540088a9179383a420a24",<br> "locationname": "beijing # 注意：使拼音简写，也支持模糊查询 例如 beijin <br>}<br>响应体：<br>{<br>        "code": 200,<br>        "location": [{<br>                "adm1": "北京市",<br>                "adm2": "北京",<br>                "country": "中国",<br>                "fxLink": "https://www.qweather.com/weather/beijing-101010100.html",<br>                "id": "101010100",<br>                "isDst": "0",<br>                "lat": "39.90499",<br>                "lon": "116.40529",<br>                "name": "北京",<br>                "rank": "10",<br>                "type": "city",<br>                "tz": "Asia/Shanghai",<br>                "utcOffset": ""<br>        }, {<br>                "adm1": "北京市",<br>                "adm2": "北京",<br>                "country": "中国",<br>                "fxLink": "https://www.qweather.com/weather/haidian-101010200.html",<br>                "id": "101010200",<br>                "isDst": "0",<br>                "lat": "39.95607",<br>                "lon": "116.31032",<br>                "name": "海淀",<br>                "rank": "15",<br>                "type": "city",<br>                "tz": "Asia/Shanghai",<br>                "utcOffset": ""<br>        }, {<br>                "adm1": "北京市",<br>                "adm2": "北京",<br>                "country": "中国",<br>                "fxLink": "https://www.qweather.com/weather/chaoyang-101010300.html",<br>                "id": "101010300",<br>                "isDst": "0",<br>                "lat": "39.92149",<br>                "lon": "116.48641",<br>                "name": "朝阳",<br>                "rank": "15",<br>                "type": "city",<br>                "tz": "Asia/Shanghai",<br>                "utcOffset": ""<br>        }, {<br>                "adm1": "北京市",<br>                "adm2": "北京",<br>                "country": "中国",<br>                "fxLink": "https://www.qweather.com/weather/shunyi-101010400.html",<br>                "id": "101010400",<br>                "isDst": "0",<br>                "lat": "40.12894",<br>                "lon": "116.65353",<br>                "name": "顺义",<br>                "rank": "33",<br>                "type": "city",<br>                "tz": "Asia/Shanghai",<br>                "utcOffset": ""<br>        }, {<br>                "adm1": "北京市",<br>                "adm2": "北京",<br>                "country": "中国",<br>                "fxLink": "https://www.qweather.com/weather/huairou-101010500.html",<br>                "id": "101010500",<br>                "isDst": "0",<br>                "lat": "40.32427",<br>                "lon": "116.63712",<br>                "name": "怀柔",<br>                "rank": "33",<br>                "type": "city",<br>                "tz": "Asia/Shanghai",<br>                "utcOffset": ""<br>        }, {<br>                "adm1": "北京市",<br>                "adm2": "北京",<br>                "country": "中国",<br>                "fxLink": "https://www.qweather.com/weather/tongzhou-101010600.html",<br>                "id": "101010600",<br>                "isDst": "0",<br>                "lat": "39.90249",<br>                "lon": "116.65860",<br>                "name": "通州",<br>                "rank": "23",<br>                "type": "city",<br>                "tz": "Asia/Shanghai",<br>                "utcOffset": ""<br>        }, {<br>                "adm1": "北京市",<br>                "adm2": "北京",<br>                "country": "中国",<br>                "fxLink": "https://www.qweather.com/weather/changping-101010700.html",<br>                "id": "101010700",<br>                "isDst": "0",<br>                "lat": "40.21809",<br>                "lon": "116.23591",<br>                "name": "昌平",<br>                "rank": "23",<br>                "type": "city",<br>                "tz": "Asia/Shanghai",<br>                "utcOffset": ""<br>        }, {<br>                "adm1": "北京市",<br>                "adm2": "北京",<br>                "country": "中国",<br>                "fxLink": "https://www.qweather.com/weather/yanqing-101010800.html",<br>                "id": "101010800",<br>                "isDst": "0",<br>                "lat": "40.46532",<br>                "lon": "115.98501",<br>                "name": "延庆",<br>                "rank": "33",<br>                "type": "city",<br>                "tz": "Asia/Shanghai",<br>                "utcOffset": ""<br>        }, {<br>                "adm1": "北京市",<br>                "adm2": "北京",<br>                "country": "中国",<br>                "fxLink": "https://www.qweather.com/weather/fengtai-101010900.html",<br>                "id": "101010900",<br>                "isDst": "0",<br>                "lat": "39.86364",<br>                "lon": "116.28696",<br>                "name": "丰台",<br>                "rank": "25",<br>                "type": "city",<br>                "tz": "Asia/Shanghai",<br>                "utcOffset": ""<br>        }, {<br>                "adm1": "北京市",<br>                "adm2": "北京",<br>                "country": "中国",<br>                "fxLink": "https://www.qweather.com/weather/shijingshan-101011000.html",<br>                "id": "101011000",<br>                "isDst": "0",<br>                "lat": "39.91460",<br>                "lon": "116.19544",<br>                "name": "石景山",<br>                "rank": "35",<br>                "type": "city",<br>                "tz": "Asia/Shanghai",<br>                "utcOffset": ""<br>        }],<br>        "msg": "success",<br>        "reqId": "57fb756ba9a540088a9179383a420a24"<br>} |
| --- |

12. 设备信息上报(设备->服务器)

12.1 添加设备上报 (intent = dAdd)

请求参数：

newScan:  int  // 0 或不填表示非新增设备（同步）；  1.新增设备 (用于app扫描判断新增)

deviceList

  - deviceId: String  // 设备ID

  - deviceType: String  // 设备类型（如 light）

  - deviceName: String  // 设备名称

  - parentId: String  // 父设备ID

  - logicalType: int  // 逻辑类型，0.物理设备，1.逻辑设备

  - endPoint: int  // 设备端点1，2

  - modelId: String  // 物模型定义id

  - uid: String  // 网关ID

  - suid:  String  // 子设备UID （网关可以不填）

  - mac: String  // 设备MAC地址（格式 001122334455）

  - roomId: String  // 所属房间ID

  - floorId: String  // 所属楼层ID

  - familyId: String  // 所属家庭ID

  - ver: String  // 版本号

  - pid: String  // 产品型号

  - remoteIndexId: int // 红外子设备必填，遥控码索引ID,通过35.6接口获取

  - createTime: long  // 设备创建时间

  - updateTime: long  // 设备更新时间

  - properties: Map结构， 全量属性报告，详见属性上报接口

Topic :  v1/server/dAdd

| JSON<br>{<br>    "reqId": "57fb756ba9a540088a9179383a420a24",<br>    "sourceType":"device",<br>    "sourceId": "9c5ca87258dd4057a28ee49888552895",<br>    "loginToken":"xxx.xxx.xxx", //公共参数loginToken<br>    "deviceList": [<br>        {<br>          "deviceName": "灯1",<br>          "deviceType": "light",<br>          "deviceId": "adc59afd85974796a72a3e538cab97ee",<br>          "uid": "9c5ca87258dd4057a28ee49888552895",<br>          "suid":"1234567890",<br>          "mac": "001122334455",<br>          "roomId": "adc59afd85974796a72a3e538cab97e1",<br>          "ver": "V2.3.1",<br>          "pid":"2000000001",<br>          "retTag": 0,<br>          "online": 1,<br>          "properties":{<br>              "onoff":"off",<br>              // 属性上报全量<br>          }<br>        },<br>        {<br>          "deviceName": "灯2",<br>          "deviceType": "light",<br>          "deviceId": "adc59afd85974796a72a3e538cab97ee",<br>          "uid": "9c5ca87258dd4057a28ee49888552895",<br>          "suid":"1234567890",<br>          "mac": "001122334455",<br>          "roomId": "adc59afd85974796a72a3e538cab97e1",<br>          "ver": "V2.3.1",<br>          "pid":"2000000001",<br>          "retTag": 0,<br>          "properties":{<br>              "onoff":"off",<br>              // 属性上报全量<br>          }<br>        }<br>    ]<br>} |
| --- |

响应参数： 

Topic :  v1/9c5ca87258dd4057a28ee49888552895/dAdd

| JSON<br>{<br>  "reqId": "57fb756ba9a540088a9179383a420a24",<br>  "msg": "success",<br>  "code": 200,<br>  "sourceType":"server" <br>} |
| --- |

12.2 编辑设备上报 (intent = dEdit)

请求参数：

deviceList

  - deviceId: String  // 设备ID

  - deviceType: String  // 设备类型（如 light）

  - subDeviceType: String  // 设备类型二级分类

  - deviceName: String  // 设备名称

  - parentId: String  // 父设备ID

  - logicalType: int  // 逻辑类型，0.物理设备，1.逻辑设备

  - endPoint: int  // 设备端点 1，2

  - modelId: String  // 物模型配置id

  - uid: String  // 网关ID

  - mac: String  // 设备MAC地址（格式 001122334455）

  - blueMac: String  // 蓝牙MAC地址

  - roomId: String  // 所属房间ID

  - floorId: String  // 所属楼层ID

  - familyId: String  // 所属家庭ID

  - ver: String  // 版本号

  - firmwareVersion: String  // 固件版本号

  - pid: String  // 产品型号

  - display: tinyint  // 是否显示（0-隐藏，1-显示)

  - createTime: long  // 设备创建时间

  - updateTime: long  // 设备更新时间

Topic :  v1/server/dEdit

| JSON<br>{<br>    "reqId": "57fb756ba9a540088a9179383a420a24",<br>    "deviceList": [<br>        {<br>          "deviceName": "灯1",<br>          "deviceType": "light",<br>          "deviceId": "adc59afd85974796a72a3e538cab97ee",<br>          "uid": "9c5ca87258dd4057a28ee49888552895",<br>          "mac": "00:11:22:33:44:55",<br>          "roomId": "adc59afd85974796a72a3e538cab97e1",<br>          "ver": "V2.3.1",<br>          "retTag": 0,<br>          "sourceType":"device",<br>          "sourceId":"9c5ca87258dd4057a28ee49888552895",<br>        },<br>        {<br>          "deviceName": "灯2",<br>          "deviceType": "light",<br>          "deviceId": "dac59afd85974796a72a3e538cab97ee",<br>          "uid": "9c5ca87258dd4057a28ee49888552895",<br>          "mac": "00:11:22:33:44:55",<br>          "roomId": "adc59afd85974796a72a3e538cab97e1",<br>          "ver": "V2.3.1",<br>          "retTag": 0,<br>          "sourceType":"device",<br>          "sourceId":"9c5ca87258dd4057a28ee49888552895"<br>        }<br>    ]<br>} |
| --- |

响应参数： 

Topic :  v1/9c5ca87258dd4057a28ee49888552895/dEdit

| JSON<br>{<br>  "reqId": "57fb756ba9a540088a9179383a420a24",<br>  "msg": "success",<br>  "code": 200,<br>  "sourceType":"server" <br>} |
| --- |

12.3 删除设备上报 (intent = dDel)

设备-> 服务器

请求参数：

deviceIdList: 设备ID列表，必填

 familyId， 家庭id，必填

uid: 网关ID，必填

Topic :  v1/server/dDel

| JSON<br>{<br>  "reqId": "57fb756ba9a540088a9179383a420a24",   <br>  "deviceIdList": ["ddacccdee","ddaccceeda"],<br>  "uid": "9c5ca87258dd4057a28ee49888552895",<br>  "familyId": "xxx",<br>  "sourceType":"device",<br>  "sourceId":"9c5ca87258dd4057a28ee49888552895"<br>} |
| --- |

响应参数： 

Topic :  v1/9c5ca87258dd4057a28ee49888552895/dDel

| JSON<br>{<br>  "reqId": "57fb756ba9a540088a9179383a420a24",<br>  "msg": "success",<br>  "code": 200,<br>  "sourceType":"server" <br>} |
| --- |

12.4 查询设备 (mqtt或https)

请求参数：

familyId: 家庭ID

uid/userId: 网关或用户ID或为空

updateTimestamp: 增量查询时间戳（毫秒）

needProps： 是否需要设备属性，默认false;   建议不传该值，通过propQuery属性查询接口单独查询属性

Mqtt Topic :  v1/server/dQuery

Http uri: /device/dQuery

| JSON<br>{<br>  "reqId": "57fb756ba9a540088a9179383a420a24",<br>  "familyId": "adc59afd85974796a72a3e538cab97e2", //必填，查询该家庭下设备<br>  "userId": "adc59afd85974796a72a3e538cab97ee", //非必填，app查询需带userId<br>  "uid": "9c5ca87258dd4057a28ee49888552895",  //非必填，传了uid则查该uid下的设备<br>  "updateTimestamp": 12323243000,<br>  //"brand":"dreame"<br>  "needProps" : true, <br>  "sourceType":"device",<br>  "sourceId":"9c5ca87258dd4057a28ee49888552895"<br>} |
| --- |

响应参数： 

deviceList.valid: 有效标志，1正常，0删除，2-已删除但设备未确认 (设备查询时返回)

deviceList.remoteIndexId: int // 红外子设备的遥控码索引ID （红外设备会返回该字段）

Topic :  v1/9c5ca87258dd4057a28ee49888552895/dQuery

| JSON<br>{<br>  "reqId": "57fb756ba9a540088a9179383a420a24",<br>  "msg": "success",<br>  "code": 200,<br>  "sourceType":"server" ,<br>  "deviceList": [<br>    {<br>            "id": 3,<br>            "deviceName": "灯1",<br>            "deviceType": "light",<br>            "subDeviceType": null,<br>            "deviceId": "adc59afd85974796a72a3e538cab97ee",<br>            "parentId": null,<br>            "uid": "ac4b3456caca45079c87bf4a319bf024",<br>            "suid":"123456",<br>            "mac": "001122334455",<br>            "blueMac": null,<br>            "roomId": "adc59afd85974796a72a3e538cab97e1",<br>            "floorId": null,<br>            "familyId": null,<br>            "ver": "V2.3.1",<br>            "firmwareVersion": null,<br>            "pid": null,<br>            "modelId": null,<br>            "endPoint": null,<br>            "logicalType": 0,<br>            "display": 1,<br>            "online": 0<br>            // needProps = true 时返回properties<br>            "properties": {<br>                "onoff": "on"<br>            },<br>            "createTime": "2025-06-10 11:18:42",<br>            "updateTime": "2025-06-10 11:18:42",<br>            "valid": 1<br>        },<br>        {<br>            "id": 4,<br>            "deviceName": "灯2",<br>            "deviceType": "light",<br>            "subDeviceType": null,<br>            "deviceId": "adc59afd85974796a72a3e538cab97e2",<br>            "parentId": null,<br>            "uid": "ac4b3456caca45079c87bf4a319bf024",<br>            "suid":"123456",<br>            "mac": "001122334455",<br>            "blueMac": null,<br>            "roomId": "adc59afd85974796a72a3e538cab97e1",<br>            "floorId": null,<br>            "familyId": null,<br>            "ver": "V2.3.1",<br>            "firmwareVersion": null,<br>            "pid": null,<br>            "modelId": null,<br>            "endPoint": null,<br>            "logicalType": 0,<br>            "display": 1,<br>            // needProps = true 时返回properties<br>            "properties": {<br>                "onoff": "on"<br>            },<br>            "createTime": "2025-06-10 11:18:42",<br>            "updateTime": "2025-06-10 11:18:42",<br>            "valid": 1<br>        },<br>        {<br>            "id": 5,<br>            "deviceName": "扫地机xxx",<br>            "deviceType": "cleanRobot",<br>            "brand": "dreame",<br>            "deviceId": "xxx",<br>            "uid": "xxx",<br>            "familyId": "adc59afd85974796a72a3e538cab97e2",<br>            "display": 1,<br>            "properties": {<br>                "onoff": "on"<br>            },<br>            "createTime": "2025-06-10 11:18:42",<br>            "updateTime": "2025-06-10 11:18:42",<br>            "valid": 1<br>        }<br>  ],<br>    "total": 2,<br>    "page": 1,<br>    "pageSize": 100<br>} |
| --- |

12.5 获取服务器时间戳 (intent = timGet)

请求参数：

uid: 网关ID

Topic :  v1/server/timGet

| JSON<br>{<br>  "reqId": "57fb756ba9a540088a9179383a420a24",<br>  "uid": "9c5ca87258dd4057a28ee49888552895",<br>  "sourceType":"device",<br>  "sourceId":"9c5ca87258dd4057a28ee49888552895"<br>} |
| --- |

响应参数： 

tim: 毫秒级时间戳

Topic :  v1/9c5ca87258dd4057a28ee49888552895/timGet

| JSON<br>{<br>  "reqId": "57fb756ba9a540088a9179383a420a24",<br>  "tim": 1747711905000,<br>  "msg": "success",<br>  "code": 200,<br>  "sourceType":"server" <br>} |
| --- |

12.6 HTTPS获取服务器时间戳(/auth/token/tim)

URI: /auth/token/tim

请求参数：

| JSON<br>{<br>  "reqId": "57fb756ba9a540088a9179383a420a24"<br>} |
| --- |

响应参数： 

tim: 毫秒级时间戳

| JSON<br>{<br>  "reqId": "57fb756ba9a540088a9179383a420a24",<br>  "tim": 1747711905000,<br>  "msg": "success",<br>  "code": 200<br>} |
| --- |

13. 楼层房间管理（https）

13.1 添加楼层 (/family/floor/flrAdd)

请求参数：

| JSON<br>{<br>    "reqId": "dsadfaadsfvasfsa1",<br>    "sourceType":"app",<br>    "sourceId":"d82a9ebd66474142ac86caad98e1e0a1",<br>    "familyId": "04c90073d5002700",<br>    "data":[<br>        {<br>            "name": "二楼"<br>        }<br>    ]<br>} |
| --- |

响应参数： 

| JSON<br>{<br>    "reqId": "dsadfaadsfvasfsa1",<br>    "msg": "success",<br>    "code": 200,<br>    "data": [<br>        {<br>            "id": 11,<br>            "familyId": "04c90073d5002700",<br>            "floorId": "04c909ae57802b00",<br>            "floorType": 1,<br>            "name": "二楼",<br>            "creator": "bac1",<br>            "createTime": null,<br>            "updateTime": null,<br>            "valid": null<br>        }<br>    ]<br>} |
| --- |

13.2 编辑楼层(/family/floor/flrEdit)

请求参数：

| JSON<br>{<br>    "reqId": "dsadfaadsfvasfsa1",<br>    "sourceType":"app",<br>    "sourceId":"d82a9ebd66474142ac86caad98e1e0a1",<br>    "familyId": "04c90073d5002700",<br>    "data":[<br>       {<br>            "floorId": "04c909ae57802b00",<br>            "name": "二楼"<br>        }<br>    ]<br>} |
| --- |

响应参数： 

| JSON<br>{<br>    "reqId": "dsadfaadsfvasfsa1",<br>    "msg": "success",<br>    "code": 200,<br>    "data": [<br>        {<br>            "id": 11,<br>            "familyId": null,<br>            "floorId": "04c909ae57802b00",<br>            "floorType": 1,<br>            "name": "二楼",<br>            "creator": null,<br>            "createTime": null,<br>            "updateTime": null,<br>            "valid": null<br>        }<br>    ]<br>} |
| --- |

13.3 删除楼层(/family/floor/flrDel)

请求参数：

| JSON<br>{<br>    "reqId": "dsadfaadsfvasfsa1",<br>    "familyId": "04c90073d5002700",<br>    "floorId": "04c909ae57802b00"<br>} |
| --- |

响应参数：无单独参数

| JSON<br>{<br>    "reqId": "dsadfaadsfvasfsa1",<br>    "msg": "success",<br>    "code": 200<br>} |
| --- |

13.4 查询楼层(/family/floor/flrQuery)

请求参数：

familyId: 家庭ID

updateTimestamp: 增量查询时间戳（毫秒）， 增量查询必填（返回更新时间大于该时间戳的数据，包括已删除的）

| JSON<br>{<br>    "familyId": "04c90073d5002700",  //必填<br>    "floorId": "xxx",   // 非必填，按floorId查询<br>    "floorIds": ["xxx","xxx2"],   // 非必填，按floorIds查询<br>    "reqId": "04c9006a7fc02700"  //必填<br>} |
| --- |

响应参数：

| JSON<br>{<br>    "reqId": "04c9006a7fc02700",<br>    "msg": "success",<br>    "code": 200,<br>    "data": [<br>        {<br>            "id": 9,<br>            "familyId": "04c90073d5002700",<br>            "floorId": "04c90073d5002701",<br>            "floorType": -1,<br>            "name": "一楼",<br>            "creator": "bac1",<br>            "createTime": "2025-06-19 11:41:17",<br>            "updateTime": "2025-06-19 11:41:17",<br>            "valid": 1<br>        },<br>        {<br>            "id": 11,<br>            "familyId": "04c90073d5002700",<br>            "floorId": "04c909ae57802b00",<br>            "floorType": 1,<br>            "name": "二楼",<br>            "creator": "bac1",<br>            "createTime": "2025-06-19 12:21:36",<br>            "updateTime": "2025-06-19 12:24:29",<br>            "valid": 0<br>        }<br>    ],<br>    "total": 2,<br>    "page": 1,<br>    "pageSize": 1000<br>} |
| --- |

13.5 添加房间 (/family/room/rAdd)

请求参数：

familyId: 所属家庭ID

| JSON<br>{<br>    "reqId": "dsadfaadsfvasfsa1",<br>    "sourceType":"app",<br>    "sourceId":"d82a9ebd66474142ac86caad98e1e0a1",<br>    "familyId": "04c90073d5002700",<br>    "data":[<br>        {<br>            "floorId": "04c90073d5002701",<br>            "name": "我的房间222"<br>        }<br>    ]<br>} |
| --- |

| JSON<br>{<br>    "reqId": "dsadfaadsfvasfsa1",<br>    "msg": "success",<br>    "code": 200,<br>    "data": [<br>        {<br>            "id": 2,<br>            "roomId": "04caa68fce800600",<br>            "floorId": "04caa683bbc00600",<br>            "familyId": "04caa5cf81000600",<br>            "roomType": null,<br>            "name": "我的房间222",<br>            "creator": "bac1",<br>            "createTime": null,<br>            "updateTime": null,<br>            "valid": null<br>        }<br>    ]<br>} |
| --- |

房间类型：

[该同步块已在源文档删除]

13.6 编辑房间  (/family/room/rEdit)

请求参数：

roomName: 新名称

roomId: 房间ID

| JSON<br>{<br>    "reqId": "dsadfaadsfvasfsa1",<br>    "sourceType":"app",<br>    "sourceId":"d82a9ebd66474142ac86caad98e1e0a1",<br>    "familyId": "04caa5cf81000600",<br>    "data":[<br>       {<br>            "roomId": "04caa68fce800600",<br>            "indexNum": 2  //修改排序号<br>            "name": "我的房间253"<br>        }<br>    ]<br>} |
| --- |

响应参数：更新后的room对象

| JSON<br>{<br>    "reqId": "dsadfaadsfvasfsa1",<br>    "msg": "success",<br>    "code": 200,<br>    "data": [<br>        {<br>            "id": 2,<br>            "roomId": "04caa68fce800600",<br>            "floorId": null,<br>            "familyId": "04caa5cf81000600",<br>            "roomType": null,<br>            "name": "我的房间253",<br>            "creator": null,<br>            "createTime": null,<br>            "updateTime": null,<br>            "valid": null<br>        }<br>    ]<br>} |
| --- |

13.7 删除房间  (/family/room/rDel)

请求参数：

familyId: 家庭id

roomId: 房间ID

| JSON<br>{<br>    "reqId": "dsadfaadsfvasfsa1",<br>    "familyId": "04caa5cf81000600",<br>    "roomId": "04caa68fce800600"<br>} |
| --- |

响应参数：无单独参数

| JSON<br>{<br>    "reqId": "dsadfaadsfvasfsa1",<br>    "msg": "success",<br>    "code": 200<br>} |
| --- |

13.8 查询房间 (/family/room/rQuery)

请求参数：

familyId: 家庭ID

uid/userId: 网关或用户ID

updateTimestamp: 增量查询时间戳（毫秒）

| JSON<br>{<br>    "familyId": "04caa5cf81000600", //必填<br>    "roomId": "xxx",   // 非必填，按roomId查询<br>    "roomIds": ["xxx","xxx2"],   // 非必填，按roomIds查询<br>    "reqId": "04c9006a7fc02700"<br>} |
| --- |

响应参数：

| JSON<br>{<br>    "reqId": "04c9006a7fc02700",<br>    "msg": "success",<br>    "code": 200,<br>    "data": [<br>        {<br>            "id": 1,<br>            "roomId": "04caa5cf82000600",<br>            "floorId": "04caa5cf81800600",<br>            "familyId": "04caa5cf81000600",<br>            "roomType": -1,<br>            "name": "默认房间",<br>            "creator": "bac1",<br>            "createTime": "2025-06-20 18:22:14",<br>            "updateTime": "2025-06-20 18:22:14",<br>            "valid": 1<br>        },<br>        {<br>            "id": 2,<br>            "roomId": "04caa68fce800600",<br>            "floorId": "04caa683bbc00600",<br>            "familyId": "04caa5cf81000600",<br>            "roomType": null,<br>            "name": "我的房间222",<br>            "creator": "bac1",<br>            "createTime": "2025-06-20 18:25:30",<br>            "updateTime": "2025-06-20 18:25:30",<br>            "valid": 1<br>        }<br>    ],<br>    "total": 2,<br>    "page": 1,<br>    "pageSize": 1000<br>} |
| --- |

14. 设备参数管理（https）

14.1 添加设备参数 

Uri: /device/deviceParams/add

请求参数：

data: 设备参数列表

  - deviceId: String  // 设备ID或familyId（family为家庭参数）

  - uid: String  // 网关ID

-  familyId  //家庭id

-  roomId  //房间id

-  floorId   //楼层id

  - paramType: String 参数类型

 -  paramId: String 参数id

 -  paramValue: String 参数值

| JSON<br>{<br>        "reqId": "57fb756ba9a540088a9179383a420a24",<br>        "data": [{<br>                        "deviceId": "DEV001",<br>                        "uid": "GW001",<br>                        "paramType": "json",<br>                        "paramId": "homeScreen",<br>                        "paramValue": { //String类型的json<br>                                "homeTheme": "left_small",<br>                                "layout": [{}],<br>                                "screen": [<br>                                  {<br>                                        "screenId": "xxx-id",<br>                                        "screenTheme": "small",<br>                                        "layout": [{<br>                                                        "index": 0,<br>                                                        "type": "device",<br>                                                        "id": "device-id"<br>                                                },<br>                                                {<br>                                                        "index": 1,<br>                                                        "type": "scene",<br>                                                        "id": "scene-id"<br>                                                }<br>                                        ]<br>                                }, {<br>                                        "screenId": "yyy-id",<br>                                        "screenTheme": "small",<br>                                        "layout": [{<br>                                                        "index": 0,<br>                                                        "type": "device",<br>                                                        "id": "device-id"<br>                                                },<br>                                                {<br>                                                        "index": 1,<br>                                                        "type": "scene",<br>                                                        "id": "scene-id"<br>                                                }<br>                                        ]<br>                                }]<br>                        }<br>                }<br><br>        ]<br>} |
| --- |

响应参数： 

data: 设备参数列表

| JSON<br>{<br>  "msg": "success",<br>  "code": 200,<br>    "reqId": "57fb756ba9a540088a9179383a420a24",<br>  "data": [<br>        {<br>          "id": 1,<br>          "deviceId": "DEV001",<br>          "uid": "GW001",<br>          "paramType": "xxx",<br>          "paramId": "temp001",<br>          "paramValue": "24.0",<br>          "createTime": "2025-06-05 18:34:30",<br>          "updateTime": "2025-06-05 18:35:30",<br>          "valid": 1<br>        },<br>        {<br>          "id": 2,<br>          "deviceId": "DEV002",<br>          "uid": "GW001",<br>          "paramType": "xxx",<br>          "paramId": "temp001",<br>          "paramValue": "24.0",<br>          "createTime": "2025-06-05 18:34:30",<br>          "updateTime": "2025-06-05 18:35:30",<br>          "valid": 1<br>        }<br>  ]<br>} |
| --- |

14.2 编辑设备参数 

Uri: /device/deviceParams/edit

请求参数：

data: 设备参数列表

  - id 主键 

 -  deviceId: String  // 设备ID

 -  uid: String  // 网关ID

-  familyId  //家庭id

-  roomId  //房间id

-  floorId   //楼层id

  - paramType 参数类型

 -  paramId 参数id

 -  paramValue 参数值

| JSON<br>{<br>    "reqId": "57fb756ba9a540088a9179383a420a24",<br>    "data": [<br>        {<br>          "id": 1,<br>          "deviceId": "DEV001",  <br>          "uid": "GW001", <br>          "familyId": "xx",   <br>          "roomId": "xx",  <br>          "floorId":"xxx"<br>          "paramType": "xxx",<br>          "paramId": "temp001",<br>          "paramValue": "24.0",<br>        },<br>        {<br>          "id": 2,<br>          "deviceId": "DEV002",<br>          "uid": "GW001",   <br>          "paramType": "xxx",<br>          "paramId": "temp001",<br>          "paramValue": "24.0"<br>        }<br>  ]<br>} |
| --- |

响应参数： 

data: 设备参数列表

| JSON<br>{<br>  "msg": "success",<br>  "reqId": "57fb756ba9a540088a9179383a420a24",<br>  "code": 200,<br>    "data": [<br>        {<br>          "id": 1,<br>          "deviceId": "DEV001",<br>          "uid": "GW001",<br>          "paramType": "xxx",<br>          "paramId": "temp001",<br>          "paramValue": "24.0",<br>          "createTime": "2025-06-05 18:34:30",<br>          "updateTime": "2025-06-05 18:35:30",<br>          "valid": 1<br>        },<br>        {<br>          "id": 2,<br>          "deviceId": "DEV002",<br>          "uid": "GW001",<br>          "paramType": "xxx",<br>          "paramId": "temp001",<br>          "paramValue": "24.0",<br>          "createTime": "2025-06-05 18:34:30",<br>          "updateTime": "2025-06-05 18:35:30",<br>          "valid": 1<br>        }<br>  ]<br>} |
| --- |

14.3 删除设备参数

Uri: /device/deviceParams/del

请求参数：

  id: 主键

 -  deviceId: String  // 设备ID

  - uid: String  // 网关ID

-  familyId  //家庭id

-  roomId  //房间id

-  floorId   //楼层id

  - paramType 参数类型

 -  paramId 参数id

 -  deviceIds 设备id列表List<String> ， 根据deviceIds删除

-   ids 主键id列表List<Long> ， 根据ids 删除

| JSON<br>{<br>   "reqId": "57fb756ba9a540088a9179383a420a24",<br>  "id": 1233440099888,<br>  "ids": [1,2],<br>  "deviceId": "DEV001",<br>  "uid": "GW001",<br>  "paramType": "xxx",<br>  "paramId": "temp001"<br>} |
| --- |

响应参数： 

| JSON<br>{<br>"reqId": "57fb756ba9a540088a9179383a420a24",<br>  "msg": "success",<br>  "code": 200<br>} |
| --- |

14.4 查询设备参数

Uri: /device/deviceParams/query

请求参数：

  id: 主键

 -  deviceId: String  // 设备ID

  - uid: String  // 网关ID

-  familyId  //家庭id

-  roomId  //房间id

-  floorId   //楼层id

  - paramType 参数类型

 -  paramId 参数id

-   deviceIds 设备id列表List<String> ， 根据deviceIds查询

-   ids 主键id列表List<Long> ， 根据ids 查询

| JSON<br>{<br>  "reqId": "57fb756ba9a540088a9179383a420a24",<br>  "deviceId": "DEV001",        //可选<br>  "uid": "GW001",             //可选<br>  "paramType": "json",         //可选<br>  "paramId": "homeScreen"     //可选<br>} |
| --- |

响应参数： 

| JSON<br>{<br>  "msg": "success",<br>  "code": 200,<br>  "reqId": "57fb756ba9a540088a9179383a420a24",<br>    "data": [<br>        {<br>          "id": 1,<br>          "deviceId": "DEV001",<br>          "uid": "GW001",<br>          "paramType": "xxx",<br>          "paramId": "temp001",<br>          "paramType": "xxx",<br>          "familyId": "xxx",<br>          "roomId": "xxx",<br>          "createTime": "2025-06-05 18:34:30",<br>          "updateTime": "2025-06-05 18:35:30",<br>          "valid": 1<br>        },<br>        {<br>          "id": 2,<br>          "deviceId": "DEV002",<br>          "uid": "GW001",<br>          "paramType": "xxx",<br>          "paramId": "temp001",<br>          "paramValue": "24.0",<br>          "createTime": "2025-06-05 18:34:30",<br>          "updateTime": "2025-06-05 18:35:30",<br>          "valid": 1<br>        }<br>  ]<br><br>} |
| --- |

15. 情景管理

15.1 添加情景 (intent = sceneAdd)

请求参数：

userId: 操作人ID

sceneName: 情景名称

familyId: 家庭ID

actList: 动作列表

响应参数：完整scene对象

15.2 编辑情景 (intent = sceneEdit)

请求参数：

userId: 操作人ID

sceneName: 新名称

sceneId: 情景ID

响应参数：更新后的scene对象

15.3 删除情景 (intent = sceneDel)

请求参数：

userId: 操作人ID

sceneId: 情景ID

uid: 网关ID

响应参数：无单独参数

15.4 查询情景 (intent = sceneQuery)

请求参数：

familyId: 家庭ID

uid/userId: 网关或用户ID

updateTimestamp: 增量查询时间戳（毫秒）

响应参数：

| JSON<br>{<br>  "intellList": [{<br>    "intellId": "1234568998",<br>    "name": "场景1",<br>    "type": 0,<br>    "intentType": "custom",    <br>    "iconUrl": "/icons/scenes/bright.png",<br>    "roomId": "123456789",<br>    "createTime": "2023-08-25 14:30:00",<br>    "updateTime": "2023-08-25 14:30:00",<br>    "valid": 0        <br>  }],<br>  "intellActionList": [<br>    {<br>      "intellActionId": "123456789",<br>      "intellId": "1234568998",<br>      "targetId": "123456789",  <br>      "actionName": "开灯",<br>      "actionCommand": "setProp",    <br>      "actionParams": {            <br>        "brightness": 100,<br>        "colorTemp": 5000<br>      },<br>      "delayTime": 0,<br>      "createTime": "2023-08-25 14:30:00",<br>      "updateTime": "2023-08-25 14:30:00",<br>      "valid": 0                  <br>    },<br>    {<br>      "intellActionId": "123456783",<br>      "intellId": "1234568998",<br>      "targetId": "123456783",  <br>      "actionName": "翻转",<br>      "actionCommand": "execFunc",    <br>      "actionParams": {            <br>        "name": "toggle"<br>      },<br>      "delayTime": 5000,<br>      "createTime": "2023-08-25 14:30:00",<br>      "updateTime": "2023-08-25 14:30:00",<br>      "valid": 0                  <br>    }<br>  ]<br>} |
| --- |

16. APP管理设备(https/MQTT)

16.1 APP添加（红外）子设备 (intent = addDev)

Http uri : /device/addDev

请求参数：

deviceList

  - deviceType: String  // 设备类型（如 light）

  - subDeviceType: String  // 设备类型二级分类

  - deviceName: String  // 设备名称

  - parentId: String  // 父设备ID

  - logicalType: int  // 逻辑类型，0.物理设备，1.逻辑设备

  - endPoint: int  // 设备端点1，2

  - modelId: String  // 物模型定义id

  - uid: String  // 网关ID

  - mac: String  // 设备MAC地址（格式 001122334455）

  - blueMac: String  // 蓝牙MAC地址

  - roomId: String  // 所属房间ID

  - floorId: String  // 所属楼层ID

  - familyId: String  // 所属家庭ID

  - remoteIndexId: int // 红外子设备必填，遥控码索引ID,通过35.6接口获取

  - ver: String  // 版本号

  - firmwareVersion: String  // 固件版本号

  - pid: String  // 产品型号

  - display: tinyint  // 是否显示（0-隐藏，1-显示)

Topic :  v1/server/addDev

| JSON<br>{<br>    "reqId": "57fb756ba9a540088a9179383a420a24",<br>    "sourceType":"app",<br>    "sourceId": "d82a9ebd66474142ac86caad98e1e0a1",<br>    "familyId":"d82a9ebd66474142ac86caad98e1e0a2",<br>    "deviceList": [<br>        {<br>          "deviceName": "灯1",<br>          "deviceType": "light",<br>          "uid": "9c5ca87258dd4057a28ee49888552895",<br>          "mac": "00:11:22:33:44:55",<br>          "roomId": "adc59afd85974796a72a3e538cab97e1",<br>          "ver": "V2.3.1",<br>          "retTag": 0<br>        },<br>        {<br>          "deviceName": "灯2",<br>          "deviceType": "light",<br>          "uid": "9c5ca87258dd4057a28ee49888552895",<br>          "mac": "00:11:22:33:44:55",<br>          "roomId": "adc59afd85974796a72a3e538cab97e1",<br>          "ver": "V2.3.1",<br>          "retTag": 0<br>        }<br>    ]<br>} |
| --- |

响应参数： 

Topic :  v1/9c5ca87258dd4057a28ee49888552895/addDev

| JSON<br>{<br>  "reqId": "57fb756ba9a540088a9179383a420a24",<br>  "msg": "success",<br>  "code": 200,<br>  "sourceType":"server",<br>  "deviceList": [<br>        {<br>          "deviceName": "灯1",<br>          "deviceType": "light",<br>          "deviceId": "adc59afd85974796a72a3e538cab97ee",<br>          "uid": "9c5ca87258dd4057a28ee49888552895",<br>          "mac": "00:11:22:33:44:55",<br>          "roomId": "adc59afd85974796a72a3e538cab97e1",<br>          "ver": "V2.3.1",<br>          "retTag": 0<br>        },<br>        {<br>          "deviceName": "灯2",<br>          "deviceType": "light",<br>          "deviceId": "adc59afd85974796a72a3e538cab97ee",<br>          "uid": "9c5ca87258dd4057a28ee49888552895",<br>          "mac": "00:11:22:33:44:55",<br>          "roomId": "adc59afd85974796a72a3e538cab97e1",<br>          "ver": "V2.3.1",<br>          "retTag": 0<br>        }<br>    ]<br>} |
| --- |

16.2  APP编辑设备 (intent = editDev)

Http uri : /device/editDev

请求参数：

familyId

deviceList

  - deviceId: String  // 设备ID

  - deviceType: String  // 设备类型（如 light）

  - subDeviceType: String  // 设备类型二级分类

  - deviceName: String  // 设备名称

  - parentId: String  // 父设备ID

  - logicalType: int  // 逻辑类型，0.物理设备，1.逻辑设备

  - endPoint: int  // 设备端点 1，2

  - modelId: String  // 物模型配置id

  - uid: String  // 网关ID

  - mac: String  // 设备MAC地址（格式 001122334455）

  - blueMac: String  // 蓝牙MAC地址

  - roomId: String  // 所属房间ID

  - floorId: String  // 所属楼层ID

  - familyId: String  // 所属家庭ID

  - ver: String  // 版本号

  - firmwareVersion: String  // 固件版本号

  - pid: String  // 产品型号

  - display: tinyint  // 是否显示（0-隐藏，1-显示)

  -  changeSubRoom Boolean， 修改房间时，是否同步修改子设备房间，true修改，false不修改；默认false

app->服务器:     Topic :  v1/server/editDev

| JSON<br>{<br>    "reqId": "57fb756ba9a540088a9179383a420a24",<br>     "sourceType":"app",<br>     "sourceId":"d82a9ebd66474142ac86caad98e1e0a1",<br>     "familyId":"d82a9ebd66474142ac86caad98e1e0a2",<br>    "deviceList": [<br>        {<br>          "deviceName": "灯1",<br>          "deviceType": "light",<br>          "deviceId": "adc59afd85974796a72a3e538cab97ee",<br>          "uid": "9c5ca87258dd4057a28ee49888552895",<br>          "mac": "00:11:22:33:44:55",<br>          "roomId": "adc59afd85974796a72a3e538cab97e1",<br>          "ver": "V2.3.1"<br>        },<br>        {<br>          "deviceName": "灯2",<br>          "deviceType": "light",<br>          "deviceId": "adc59afd85974796a72a3e538cab97ee",<br>          "uid": "9c5ca87258dd4057a28ee49888552895",<br>          "mac": "00:11:22:33:44:55",<br>          "roomId": "adc59afd85974796a72a3e538cab97e1",<br>          "ver": "V2.3.1"<br>        }<br>    ]<br>} |
| --- |

服务器 -> APP

Topic :  v1/d82a9ebd66474142ac86caad98e1e0a1/editDev

| JSON<br>{<br>  "reqId": "57fb756ba9a540088a9179383a420a24",<br>  "msg": "success",<br>  "code": 200,<br>  "sourceType":"server" <br>} |
| --- |

16.3 APP删除设备 (intent = delDev)

Http uri : /device/delDev

设备-> 服务器

请求参数：

deviceIdList: 设备ID列表

uid: 网关ID

familyId 家庭id

delSubs：  boolean值，非必填，是否根据parentId删除级联子设备，true删除，false不删除；不填，默认false;

app->服务器:  

Topic :  v1/server/delDev

| JSON<br>{<br>  "reqId": "57fb756ba9a540088a9179383a420a24",    // 32-strings[0~9,a~z]<br>  "deviceIdList": ["ddacccdee","ddaccceeda"],<br>  "uid": "9c5ca87258dd4057a28ee49888552895",<br>  "familyId": "9c5ca87258dd4057a28ee49888552890",<br>  "sourceType":"app",<br>  "sourceId":"d82a9ebd66474142ac86caad98e1e0a1"<br>} |
| --- |

服务器 -> APP:

Topic :  v1/d82a9ebd66474142ac86caad98e1e0a1/delDev

| JSON<br>{<br>  "reqId": "57fb756ba9a540088a9179383a420a24",<br>  "msg": "success",<br>  "code": 200,<br>  "sourceType":"server" <br>} |
| --- |

16.4 查询设备 (intent = queryDev)

Http uri : /device/queryDev

请求返回参数同12.4

17. 设备重置 (intent = dReset)

请求参数：

uid: 网关ID

familyId: 家庭ID

响应参数：无单独参数

19. 推送设置

19.1 添加设置 (intent = pushSettingAdd)

请求参数：

userId: 用户ID

familyId: 家庭ID

enable: 是否启用

deviceId: 关联设备

startTime: 开始时间

endTime: 结束时间

week: 生效星期(bitmap)

响应参数：推送设置对象

19.2 编辑设置 (intent = pushSettingEdit)

请求参数：

userId: 用户ID

familyId: 家庭ID

pushSettingId: 设置ID

enable: 是否启用

startTime: 新开始时间

endTime: 新结束时间

week: 新生效星期

响应参数：更新后的设置对象

20. 定时管理

20.1 添加定时 (intent = timAdd)

请求参数：

userId: 用户ID

deviceId: 设备ID

uid: 网关ID

hour: 小时

min: 分钟

sec: 秒数

week: 生效星期

properties: 执行属性

响应参数：定时任务对象

20.2 编辑定时 (intent = timEdit)

请求参数：

userId: 用户ID

timingId: 定时ID

deviceId: 设备ID

uid: 网关ID

hour: 新小时

min: 新分钟

sec: 新秒数

week: 新生效星期

enable: 是否启用

properties: 新执行属性

响应参数：更新后的定时对象

20.3 删除定时 (intent = timDel)

请求参数：

userId: 用户ID

timingId: 定时ID

响应参数：无单独参数

20.4 查询定时 (intent = timQuery)

请求参数：

familyId: 家庭ID

uid/userId: 网关或用户ID

updateTimestamp: 增量查询时间戳（毫秒）

响应参数：

| JSON<br>{<br>  "timingList": [<br>    {定时对象1},<br>    {定时对象2}<br>  ]<br>} |
| --- |

21. 倒计时管理

21.1 添加倒计时 (intent = cdAdd)

请求参数：

userId: 用户ID

deviceId: 设备ID

uid: 网关ID

sec: 倒计时秒数

properties: 执行属性

响应参数：倒计时对象

21.2 编辑倒计时 (intent = cdEdit)

请求参数：

userId: 用户ID

countingId: 倒计时ID

deviceId: 设备ID

uid: 网关ID

sec: 新倒计时秒数

enable: 是否启用

properties: 新执行属性

响应参数：更新后的倒计时对象

21.3 删除倒计时 (intent = cdDel)

请求参数：

userId: 用户ID

countingId: 倒计时ID

响应参数：无单独参数

21.4 查询倒计时 (intent = cdQuery)

请求参数：

familyId: 家庭ID

uid/userId: 网关或用户ID

updateTimestamp: 增量查询时间戳（毫秒）

响应参数：

| JSON<br>{<br>  "countingList": [<br>    {倒计时对象1},<br>    {倒计时对象2}<br>  ]<br>} |
| --- |

22. 安防管理

22.1 布防 (intent = security-enable)

请求参数：

securityId: 安防配置ID

userId: 操作人ID

famiyId: 家庭ID

响应参数：安防状态对象

22.2 撤防 (intent = security-disable)

请求参数：

securityId: 安防配置ID

userId: 操作人ID

famiyId: 家庭ID

响应参数：安防状态对象

22.3 查询状态 (intent = securityQuery)

请求参数：

famiyId: 家庭ID

uid/userId: 网关或用户ID

响应参数：安防配置对象

22.4 编辑配置 (intent = securityEdit)

请求参数：

securityId: 配置ID

userId: 操作人ID

famiyId: 家庭ID

conditionDeviceList: 触发设备列表

响应参数：更新后的安防配置

24. 自动化管理

自动化

24.1 创建自动化 /auto/autoAdd

24.1.1 请求参数：

  intell段说明：

| JSON<br>{<br>    "intell": {<br>    "familyId": "04c7e7c514401300",<br>    "name": "智能灯光场景",<br>    "type": 1,<br>    "enable":1,<br>    "intentType": "AUTO",<br>    "iconUrl": "/icons/lighting.png",<br>    "roomIds": ["ROOM_987654321", "12312312312"], // 列表<br>    "period": {<br>      "circleType": 0,<br>      "periodType": 1,<br>      "startTime": "12:01",<br>      "endTime": "12:03"<br>    },<br>    "valid": 1，<br>    "actions":[]，  //动作, 参照下面的"actions段说明"<br>    "conditions":[]  //条件, 参照下面的"conditions段说明"<br>  } |
| --- |

period 本身为json格式，根据circleType 变化而变化：

| JSON<br>{<br>  "circleType": 1, //重复类型： 0单次，1每天，2每周，3每月<br>  "day":[1,2,3], //每周类型：0周日，1周一，2周二，... 6周六； 每月类型：1日，2日，3日...31日<br>  "periodType": 1, //时间段类型： 0全天，1指定时间段 <br>  "startTime": "12:01", //指定时间段开始时间（小时：分钟）<br>  "endTime": "22:02" //指定时间段结束时间（小时：分钟）<br>} |
| --- |

当 circleType = 0 day参数没有意义。

当 circleType = 1 day 参数没有意义。 periodType 不能为1 

当 circleType = 2 day 表示周一到周六  比如 [1,3,4] = 周二，周三和周四

当circleType  = 3 是 day表示日期 ： 比如 [1,2,30]  = 一号 二号和30号

```
actions段说明
```

| JSON<br> <br>  "actions": [<br>    {<br>      "actionName": "string(必填)",<br>      "targetType": "int(必填,0-设备 3-推送)",<br>      "actionCommand": "string(setProp/execFunc)",<br>      "actionParams": {<br>        // 设备操作（targetType=0）<br>        "properties": {"字段": "值"},  // setProp时必填<br>        "commands": {"name": "功能名"，"args":{"xx":"yy"}} // execFunc时必填<br>        // 推送配置（targetType=3）<br>        "title": "string(必填)",<br>        "content": "string(必填)",<br>        "sound": "string(default)",<br>        "extras": {"扩展字段": "值"}<br>      }<br>    }<br>  ],<br> |
| --- |

action_params 为存放字典，数据结构随着 target_type改变而改变

target_type = 0 且 action_command =setProp

| JSON<br>{ <br>    "properties": {<br>        "onoff": "on"<br>     }<br> } |
| --- |

target_type = 0 且 action_command =execFunc

| JSON<br>{<br>    "commmands": {<br>        "name": "addDev",<br>        "args":{<br>        "number":250<br>        }<br>      }<br> } |
| --- |

target_type=3 目标为设备 时， action_params为推送信息配置

| JSON<br>{<br>    "title":"推送标题",<br>    "content":"推送内容",<br>    "sound": "default", <br>    //extras额外字段 ：非必传<br>     "extras": {<br>        "msg1": "order_update",<br>        "msg2": "ORD_20230001"<br>      }<br> } |
| --- |

target_type=5 表示为 延时动作时

| JSON<br> {<br>    "delay":10,<br>    "unit":"s" #默认<br> }<br> |
| --- |

且创建actiion时候 如果有多个延时动作（target_type=5） 合并为一个延时动作:

合并前：

| JSON<br>"actions": [{<br>    "actionName": "1234132",<br>    "targetId": "DEVICE_123456789",<br>    "targetType": 0,<br>    "actionCommand": "execFunc",<br>    "actionParams": {<br>      "properties": {<br>        "onoff": "on"<br>      }<br>    },<br>    "delayTime": 0,<br>    "valid": 1<br>  }, {<br>    "actionName": "delay1",<br>    "targetId": "DEVICE_123456789",<br>    "targetType": 5,<br>    "actionCommand": "execFunc",<br>    "actionParams": {<br>      "delay": 10,<br>      "unit": "s"<br>    },<br>    "delayTime": 0,<br>    "valid": 1<br>  }, {<br>    "actionName": "delay2",<br>    "targetId": "DEVICE_123456789",<br>    "targetType": 5,<br>    "actionCommand": "execFunc",<br>    "actionParams": {<br>      "delay": 1,<br>      "unit": "s"<br>    },<br>    "delayTime": 0,<br>    "valid": 1<br>  }], |
| --- |

合并后

| JSON<br>        "actions": [<br>            {<br>                "id": 0,<br>                "actionName": "1234132",<br>                "intellActionId": "089c8f18aac01001",<br>                "intellId": "089c8f18aac01000",<br>                "familyId": "04eec8d1bac09200",<br>                "targetId": "DEVICE_123456789",<br>                "targetType": 0,<br>                "actionCommand": "execFunc",<br>                "actionParams": {<br>                    "properties": {<br>                        "onoff": "on"<br>                    }<br>                },<br>                "delayTime": 0,<br>                "createTime": "2025-09-09 15:57:28",<br>                "updateTime": "2025-09-09 15:57:28"<br>            },<br>            {<br>                "id": 0,<br>                "actionName": "delay1",<br>                "intellActionId": "089c8f18aac01002",<br>                "intellId": "089c8f18aac01000",<br>                "familyId": "04eec8d1bac09200",<br>                "targetId": "DEVICE_123456789",<br>                "targetType": 5,<br>                "actionCommand": "execFunc",<br>                "actionParams": {<br>                    "delay": 11,<br>                    "uint": "s"<br>                },<br>                "delayTime": 0,<br>                "createTime": "2025-09-09 15:57:28",<br>                "updateTime": "2025-09-09 15:57:28"<br>            }<br>        ], |
| --- |

```
conditions段说明
```

| JSON<br>  "conditions": [<br>    {<br>      "intellConditionId": "string(必填,32位唯一ID)",<br>      "intellId": "string(必填,关联规则ID)",<br>      "familyId": "string(必填,家庭ID)",<br>      "deviceId": "string(必填,设备ID)",<br>      "conditionType": "int(必填,条件类型)",<br>      "ruleType": "int(必填,0-通用 1-定时 2-地理围栏)",<br>      "rule": {<br>        // 根据ruleType不同结构变化<br>        "common": {<br>          "op": "string(必填,运算符)",<br>          "key": "string(必填,设备属性)",<br>          "value": "string(必填,比较值)"<br>        },<br>        "timed": {<br>          "timeType": "string(必填,common/sunrise/sunset)",<br>          "circleType": "int(必填,0-3)",<br>          "day": "int数组(必填)",<br>          "triggerTime": "string(HH:MM格式)"<br>        },<br>        "geo_fence": {<br>          "action": "string(必填,in/out)",<br>          "radius": "int(必填,100-5000)",<br>          "lon": "string(必填,经度)",<br>          "lat": "string(必填,纬度)"<br>        }<br>      }<br>    }<br>  ] |
| --- |

rule 本身存放json格式数据，随着 ruleType 而变化

当rule_type=0  （设备状态匹配规则）

rule 为数组

| JSON<br>[<br>    {<br>      "op": "in",<br>      "key": "properties.onoff",<br>      "value": "[on, off]"<br>    },<br>    {<br>      "op": "=",<br>      "key": "properties.temp",<br>      "value": "27"<br>    }<br>] |
| --- |

当 rule_typo =1时（ 特定时间）

rule为map

根据timeType的不同，数据结构不同。具体如下所示

| JSON<br> <br> //普通定时<br> <br>{<br>  "timeType":"common"， // common:普通定时， sunrise：日出， sunset:日落<br>  "circleType": 3, //重复类型： 0单次，1每天，2每周，3每月<br>  "day":[1,2,3], //每周类型：0周日，1周一，2周二，... 6周六； 每月类型：1日，2日，3日...31日<br>  "triggerTime": "12:22", //小时:分钟<br>}<br><br>//日出<br>{<br>  "timeType":"sunrise"， // common:普通定时， sunrise：日出， sunset:日落<br>  "circleType": 3, //重复类型： 0单次，1每天，2每周，3每月<br>  "day":[1,2,3], //每周类型：0周日，1周一，2周二，... 6周六； 每月类型：1日，2日，3日...31日<br>  "area": "深圳市南山区百度大厦", // 日出地区名称<br>  "lon": "xx.xxxxxx", // 经度<br>  "lat": "xx.xxxxxx", //纬度<br>}<br><br>//日落<br>{<br>  "timeType":"sunset"， // common:普通定时， sunrise：日出， sunset:日落<br>  "circleType": 3, //重复类型： 0单次，1每天，2每周，3每月<br>  "day":[1,2,3], //每周类型：0周日，1周一，2周二，... 6周六； 每月类型：1日，2日，3日...31日<br>  "area": "深圳市南山区百度大厦", // 日落地区名称<br>  "lon": "xx.xxxxxx", // 经度<br>  "lat": "xx.xxxxxx", //纬度<br>} |
| --- |

当rute_type =2 时候（ 特定时间）rule 为：

| JSON<br>{<br>  "action":"in"， // in 回家， out 离家<br>  "radius": 500, // 以经纬度为中心的范围半径（米）<br>  "area": "深圳市南山区百度大厦", // 日出地区名称<br>  "lon": "xx.xxxxxx", // 经度<br>  "lat": "xx.xxxxxx", //纬度<br>} |
| --- |

24.1.1 请求示例：

| JSON<br>{<br>  "intell": {<br>    "familyId": "04eec8d1bac09200",<br>    "name": "key_bindings",<br>    "type": 4,<br>    "intentType": "custom",<br>    "enable": 1,<br>    "valid": 1<br>  },<br>  "actions": [<br>    {<br>      "familyId": "04eec8d1bac09200",<br>      "targetId": "04d77ffce6c0150ad_ge_1",<br>      "targetType": 0,<br>      "actionName": "key_bindings_action",<br>      "actionCommand": "execFunc",<br>      "actionParams": {<br>        "commands": {<br>          "name": "toggle"<br>        }<br>      },<br>      "delayTime": 0,<br>      "valid": 1<br>    }<br>  ],<br>  "conditions": [<br>    {<br>      "familyId": "04eec8d1bac09200",<br>      "deviceId": "04d77ffce6c0150ad_ge_1",<br>      "conditionType": 0,<br>      "ruleType": 0,<br>      "rule": [<br>        {<br>          "op": "=",<br>          "key": "event.args.keyNo",<br>          "value": 2<br>        },<br>        {<br>          "op": "=",<br>          "key": "event.name",<br>          "value": "keyAction"<br>        },<br>        {<br>          "op": "=",<br>          "key": "event.args.action",<br>          "value": "shortPress"<br>        }<br>      ],<br>      "valid": 1<br>    }<br>  ],<br>  "sourceType": "app",<br>  "sourceId": "S0w3UrXxZV4Mm2Z1",<br>  "reqId": "1757666525420_387354"<br>} |
| --- |

24.1.1 响应参数： 

| JSON<br>代码块<br>{<br>    "code": 200,<br>    "msg": "success",<br>    "data": [<br>        {<br>            "intell": {<br>                "id": 49,<br>                "intellId": "08a081eddac01000",<br>                "familyId": "04eec8d1bac09200",<br>                "name": "key_bindings",<br>                "type": 4,<br>                "intentType": "custom",<br>                "iconUrl": "",<br>                "roomIds": [],<br>                "enable": 1,<br>                "period": {},<br>                "createTime": "2025-09-12 17:33:51",<br>                "updateTime": "2025-09-12 17:33:51",<br>                "valid": 1<br>            },<br>            "actions": [<br>                {<br>                    "id": 0,<br>                    "actionName": "key_bindings_action",<br>                    "intellActionId": "08a081eddac01001",<br>                    "intellId": "08a081eddac01000",<br>                    "familyId": "04eec8d1bac09200",<br>                    "targetId": "04d77ffce6c0150ad_ge_1",<br>                    "targetType": 0,<br>                    "actionCommand": "execFunc",<br>                    "actionParams": {<br>                        "commands": {<br>                            "name": "toggle"<br>                        }<br>                    },<br>                    "delayTime": 0,<br>                    "createTime": "2025-09-12 17:33:51",<br>                    "updateTime": "2025-09-12 17:33:51"<br>                }<br>            ],<br>            "conditions": [<br>                {<br>                    "id": 0,<br>                    "intellConditionId": "08a081eddac01002",<br>                    "intellId": "08a081eddac01000",<br>                    "familyId": "04eec8d1bac09200",<br>                    "deviceId": "04d77ffce6c0150ad_ge_1",<br>                    "conditionType": 0,<br>                    "ruleType": 0,<br>                    "rule": [<br>                        {<br>                            "op": "=",<br>                            "key": "event.args.keyNo",<br>                            "value": 2<br>                        },<br>                        {<br>                            "op": "=",<br>                            "key": "event.name",<br>                            "value": "keyAction"<br>                        },<br>                        {<br>                            "op": "=",<br>                            "key": "event.args.action",<br>                            "value": "shortPress"<br>                        }<br>                    ],<br>                    "createTime": "2025-09-12 17:33:51",<br>                    "updateTime": "2025-09-12 17:33:51"<br>                }<br>            ]<br>        }<br>    ],<br>    "reqId": "1757666525420_387354"<br>} |
| --- |

24.2 编辑自动化 /auto/autoUpdate

请求参数：

| JSON<br> {<br>  "reqId": "req_1234567890",<br>  "intell": {<br>    "intellId": "INTELL_9bsss8c7d6e5f",<br>    "familyId": "04c7e7c514401300",<br>    "name": "222222",<br>    "type": 1,<br>    "enable":1,<br>    "intentType": "2222",<br>    "iconUrl": "/wwicons/lighting.png",<br>    "roomIds": "ROOM_987654321",<br>    "period": {<br>      "circleType": 0,<br>      "periodType": 1,<br>      "startTime": "12:01",<br>      "endTime": "12:03"<br>    },<br>    "valid": 1<br>  },<br>  "actions": [   <br> <br>    {<br>      "intellActionId": "AwCTION_1a2b3c4d5e",<br>      "actionName":"change_2sss222test",<br>      "intellId": "INTELL_9bsss8c7d6e5f",<br>      "targetId": "DEVICE_123456789",<br>      "targetType": 0 ,<br>      "actionCommand": "execFunc",<br>      "actionParams":{<br>            "properties": {<br>                "onoff": "on"<br>            }<br>        },<br>      "delayTime": 0 <br>    },<br>    {<br>      "intellActionId": "ACTwION_1a2b3c242d5e",<br>      "actionName":"1234132",<br>      "familyId": "FAMILY_1234567890",<br>      "intellId": "INTELL_9bsss8c7d6e5f",<br>      "targetId": "DEVICE_12223456789",<br>      "targetType": 0 ,<br>      "actionCommand": "execFunc",<br>      "actionParams":{<br>            "properties": {<br>                "onoff": "on"<br>            }<br>        },<br>      "delayTime": 0 <br>    }<br>  ],<br>  "conditions": [<br>    {<br>      "ruleType": 1,<br>      "intellConditionId": "COND_6f5e4d32c2b",<br>      "intellId": "INTELL_9bsss8c7d6e5f",<br>      "familyId": "FAMILY_123qq4567890",<br>      "deviceId": "SENS22OR_22d2987654321",<br>      "conditionType": 2,<br>      "rule":{<br>                "action":"iD2ss22 sssD1n",<br>                "radius":1222,<br>                "timeType":"sunrise",<br>                "circleType": 1,    <br>                "day":[1,2,3], <br>                "triggerTime":"12:22",<br>                "area": "深圳市南山区百度大厦" ,<br>                  "lon": "xx.xxxxxx", <br>                    "lat": "xx.xxxxxx"   <br>    } <br>    },{<br>      "ruleType":1,<br>      "intellConditionId": "COND2_6f52e4d23c2b",<br>      "intellId": "INTELL_9bsss8c7d6e5f",<br>      "familyId": "FAMILY_1234wss567890",<br>      "deviceId": "SENSOR_987654321",<br>      "conditionType": 1,<br>      "rule":{<br>                "action":"2222",<br>                "radius":1222,<br>                "timeType":"sunrise",<br>                "circleType": 1,    <br>                "day":[1,2,3], <br>                "triggerTime":"12:22",<br>                "area": "changetest" ,<br>                  "lon": "xx.xxxxxx", <br>                    "lat": "xx.xxxxxx"   <br>    }<br>    } <br>  ]<br>} |
| --- |

响应参数：更新后的自动化对象

| JSON<br>{    "code": 200,<br>    "msg": "success",<br>    "data": null,<br>    "reqId": "req_1234567890"<br>}} |
| --- |

24.3 删除自动化 /auto/autoDelete

请求参数：

userId: 用户ID

intellId: 自动化ID

| JSON<br>{   <br>    "reqId": "123123123",<br>    "IntellIds":["08ad610459801000","08ad61052f801000"],<br>    "userId":"083990CDDEC01000"<br> } |
| --- |

响应参数：

| JSON<br>{<br>    "code": 200,<br>    "msg": "success",<br>    "data": null,<br>    "reqId": "123123123"<br>} |
| --- |

24.4 查询自动化 /auto/autoQuery 

请求参数：

famiyId: 家庭ID

updateTimestamp: 增量查询时间戳（毫秒） // null或不传查全量有效数据

 types: 数组类型,  对应过滤intell表type字段； 示例：[0, 4]

 pageNum 请求页面 默认为1

pageSize 请求size 默认为1000

请求参数

| JSON<br>{<br>    "reqId":"123123123",<br>    "familyId":"04c7e7c514401300",<br>    "userId":"083990CDDEC01000",<br>    "updateTimestamp":1715243888000,<br>    "types": [0, 4] // 可选<br>} |
| --- |

响应参数：

| JSON<br>代码块<br>{<br>    "code": 200,<br>    "msg": "success",<br>    "data": [<br>        {<br>            "intell": {<br>                "id": 70,<br>                "intellId": "INTELL_9bsss8c7d6e5f",<br>                "familyId": "04c7e7c514401300",<br>                "name": "222222",<br>                "type": 1,<br>                "intentType": "2222",<br>                "iconUrl": "/wwicons/lighting.png",<br>                 "roomIds": [<br>                    "ROOM_987654321",<br>                    "12312312312"<br>                ],<br>                "enable": 1,<br>                "period": {<br>                    "day": [],<br>                    "circleType": 0,<br>                    "periodType": 1,<br>                    "startTime": "12:01",<br>                    "endTime": "12:03"<br>                },<br>                "createTime": "2025-07-09 17:20:55",<br>                "updateTime": "2025-07-10 18:22:50",<br>                "valid": 1<br>            },<br>            "actions": [<br>                {<br>                    "id": 15,<br>                    "actionName": "1234132",<br>                    "intellActionId": "ACTwION_1a2b3c242d5e",<br>                    "intellId": "INTELL_9bsss8c7d6e5f",<br>                    "familyId": "FAMILY_1234567890",<br>                    "targetId": "DEVICE_12223456789",<br>                    "targetType": 0,<br>                    "actionCommand": "execFunc",<br>                    "actionParams": {<br>                        "properties": {<br>                            "onoff": "on"<br>                        }<br>                    },<br>                    "delayTime": 0,<br>                    "createTime": "2025-07-09 17:20:55",<br>                    "updateTime": "2025-07-10 16:34:29",<br>                },<br>                {<br>                    "id": 20,<br>                    "actionName": "change_2sss222test",<br>                    "intellActionId": "AwCTION_1a2b3c4d5e",<br>                    "intellId": "INTELL_9bsss8c7d6e5f",<br>                    "familyId": "FAMILY_1234567890",<br>                    "targetId": "DEVICE_123456789",<br>                    "targetType": 0,<br>                    "actionCommand": "execFunc",<br>                    "actionParams": {<br>                        "properties": {<br>                            "onoff": "on"<br>                        }<br>                    },<br>                    "delayTime": 0,<br>                    "createTime": "2025-07-10 16:05:52",<br>                    "updateTime": "2025-07-10 17:29:41",<br>                    "valid": 1<br>                }<br>            ],<br>            "conditions": [<br>                {<br>                    "id": 11,<br>                    "intellConditionId": "COND2_6f52e4d23c2b",<br>                    "intellId": "INTELL_9bsss8c7d6e5f",<br>                    "familyId": "FAMILY_1234wss567890",<br>                    "deviceId": "SENSOR_987654321",<br>                    "conditionType": 1,<br>                    "ruleType": 1,<br>                    "rule": {<br>                      "timeType":"common", // common:普通定时， sunrise：日出， sunset:日落<br>                      "circleType": 3, //重复类型： 0单次，1每天，2每周，3每月<br>                      "day":[1,2,3], //每周类型：0周日，1周一，2周二，... 6周六； 每月类型：1日，2日，3日...31日<br>                      "triggerTime": "12:22", //小时:分钟<br>                    },<br>                    "createTime": "2025-07-09 17:20:55",<br>                    "updateTime": "2025-07-10 18:14:24"<br>                },<br>                {<br>                    "id": 13,<br>                    "intellConditionId": "COND_6f5e4d32c2b",<br>                    "intellId": "INTELL_9bsss8c7d6e5f",<br>                    "familyId": "FAMILY_123qq4567890",<br>                    "deviceId": "SENS22OR_22d2987654321",<br>                    "conditionType": 2,<br>                    "ruleType": 1,<br>                    "rule": {<br>                      "timeType":"sunrise", // common:普通定时， sunrise：日出， sunset:日落<br>                      "circleType": 3, //重复类型： 0单次，1每天，2每周，3每月<br>                      "day":[1,2,3], //每周类型：0周日，1周一，2周二，... 6周六； 每月类型：1日，2日，3日...31日<br>                      "area": "深圳市南山区百度大厦", // 日出地区名称<br>                      "lon": "114.06563", // 经度<br>                      "lat": "22.566479", //纬度 114.06563,22.566479<br>                    },<br>                        "createTime": "2025-07-10 17:27:54",<br>                    "updateTime": "2025-07-10 17:51:26" <br>                }<br>            ]<br>        },<br>        {<br>            "intell": {<br>                "id": 79,<br>                "intellId": "INTELL_9bsss8c7d6e52f",<br>                "familyId": "04c7e7c514401300",<br>                "name": "智能灯光场景",<br>                "type": 1,<br>                "intentType": "AUTO",<br>                "iconUrl": "/icons/lighting.png",<br>                "roomIds": [<br>                    "ROOM_987654321",<br>                    "12312312312"<br>                ],<br>                "enable": 1,<br>                "period": {<br>                    "day": [<br>                        0<br>                    ],<br>                    "circleType": 0,<br>                    "periodType": 1,<br>                    "startTime": "12:01",<br>                    "endTime": "12:03"<br>                },<br>                "createTime": "2025-07-10 18:03:09",<br>                "updateTime": "2025-07-10 18:03:09" <br>            },<br>            "actions": [<br>                {<br>                    "id": 29,<br>                    "actionName": "1234132",<br>                    "intellActionId": "AwCTION_1a2b3c4d52e",<br>                    "intellId": "INTELL_9bsss8c7d6e52f",<br>                    "familyId": "FAMILY_1234567890",<br>                    "targetId": "DEVICE_123456789",<br>                    "targetType": 0,<br>                    "actionCommand": "execFunc",<br>                    "actionParams": {<br>                        "properties": {<br>                            "onoff": "on"<br>                        }<br>                    },<br>                    "delayTime": 0,<br>                    "createTime": "2025-07-10 18:03:09",<br>                    "updateTime": "2025-07-10 18:03:09" <br>                },<br>                {<br>                    "id": 30,<br>                    "actionName": "1234132",<br>                    "intellActionId": "ACTwION_1a2b3c242d52e",<br>                    "intellId": "INTELL_9bsss8c7d6e52f",<br>                    "familyId": "FAMILY_1234567890",<br>                    "targetId": "DEVICE_123456789",<br>                    "targetType": 0,<br>                    "actionCommand": "execFunc",<br>                    "actionParams": {<br>                        "properties": {<br>                            "onoff": "on"<br>                        }<br>                    },<br>                    "delayTime": 0,<br>                    "createTime": "2025-07-10 18:03:09",<br>                    "updateTime": "2025-07-10 18:03:09" <br>                }<br>            ],<br>            "conditions": [<br>                {<br>                    "id": 18,<br>                    "intellConditionId": "COND_6f5e4d322c2b",<br>                    "intellId": "INTELL_9bsss8c7d6e52f",<br>                    "familyId": "FAMILY_1234567890",<br>                    "deviceId": "SENSOR_987654321",<br>                    "conditionType": 2,<br>                    "ruleType": 2,<br>                    "rule": {<br>                          "action":"in"， // in 回家， out 离家<br>                          "radius": 500, // 以经纬度为中心的范围半径（米）<br>                          "area": "深圳市南山区百度大厦", // 日出地区名称<br>                          "lon": "xx.xxxxxx", // 经度<br>                          "lat": "xx.xxxxxx", //纬度<br>                        },<br>                    "createTime": "2025-07-10 18:03:09",<br>                    "updateTime": "2025-07-10 18:03:09" <br>                },<br>                {<br>                    "id": 19,<br>                    "intellConditionId": "COND2_6f252e4d23c2b",<br>                    "intellId": "INTELL_9bsss8c7d6e52f",<br>                    "familyId": "FAMILY_1234567890",<br>                    "deviceId": "SENSOR_987654321",<br>                    "conditionType": 2,<br>                    "ruleType": 2,<br>                    "rule": {<br>                          "action":"in"， // in 回家， out 离家<br>                          "radius": 500, // 以经纬度为中心的范围半径（米）<br>                          "area": "深圳市南山区百度大厦", // 日出地区名称<br>                          "lon": "xx.xxxxxx", // 经度<br>                          "lat": "xx.xxxxxx", //纬度<br>                        },<br>                    "createTime": "2025-07-10 18:03:09",<br>                    "updateTime": "2025-07-10 18:03:09" <br>                }<br>            ]<br>        },<br>        {<br>            "intell": {<br>                "id": 83,<br>                "intellId": "INTELL_9bsss8c7d6e522f",<br>                "familyId": "04c7e7c514401300",<br>                "name": "智能灯光场景",<br>                "type": 1,<br>                "intentType": "AUTO",<br>                "iconUrl": "/icons/lighting.png",<br>               "roomIds": [<br>                    "ROOM_987654321",<br>                    "12312312312"<br>                ],<br>                "enable": 1,<br>                "period": {<br>                    "day": [],<br>                    "circleType": 0,<br>                    "periodType": 1,<br>                    "startTime": "12:01",<br>                    "endTime": "12:03"<br>                },<br>                "createTime": "2025-07-10 18:04:16",<br>                "updateTime": "2025-07-10 18:04:16",<br>                "valid": 1<br>            },<br>            "actions": [<br>                {<br>                    "id": 35,<br>                    "actionName": "1234132",<br>                    "intellActionId": "AwCTION_1a2b3c42d52e",<br>                    "intellId": "INTELL_9bsss8c7d6e522f",<br>                    "familyId": "FAMILY_1234567890",<br>                    "targetId": "DEVICE_123456789",<br>                    "targetType": 0,<br>                    "actionCommand": "execFunc",<br>                    "actionParams": {<br>                        "properties": {<br>                            "onoff": "on"<br>                        }<br>                    },<br>                    "delayTime": 0,<br>                    "CreateTime": "2025-07-10 18:04:16",<br>                    "UpdateTime": "2025-07-10 18:04:16" <br>                },<br>                {<br>                    "id": 36,<br>                    "actionName": "1234132",<br>                    "intellActionId": "ACTwION_1a2b3c2422d52e",<br>                    "intellId": "INTELL_9bsss8c7d6e522f",<br>                    "familyId": "FAMILY_1234567890",<br>                    "targetId": "DEVICE_123456789",<br>                    "targetType": 0,<br>                    "actionCommand": "execFunc",<br>                    "actionParams": {<br>                        "properties": {<br>                            "onoff": "on"<br>                        }<br>                    },<br>                    "delayTime": 0,<br>                    "createTime": "2025-07-10 18:04:16",<br>                    "updateTime": "2025-07-10 18:04:16" <br>                }<br>            ],<br>            "conditions": [<br>                {<br>                    "id": 24,<br>                    "intellConditionId": "COND_6f5e4d3222c2b",<br>                    "intellId": "INTELL_9bsss8c7d6e522f",<br>                    "familyId": "FAMILY_1234567890",<br>                    "deviceId": "SENSOR_987654321",<br>                    "conditionType": 2,<br>                    "ruleType": 2,<br>                    "rule": {<br>                      "action":"in"， // in 回家， out 离家<br>                      "radius": 500, // 以经纬度为中心的范围半径（米）<br>                      "area": "深圳市南山区百度大厦", // 日出地区名称<br>                      "lon": "xx.xxxxxx", // 经度<br>                      "lat": "xx.xxxxxx", //纬度<br>                 },<br>                   {<br>                    "id": 25,<br>                    "intellConditionId": "COND2_6f252e4d232c2b",<br>                    "intellId": "INTELL_9bsss8c7d6e522f",<br>                    "familyId": "FAMILY_1234567890",<br>                    "deviceId": "SENSOR_987654321",<br>                    "conditionType": 2,<br>                    "ruleType": 2,<br>                    "rule": {<br>                          "action":"in"， // in 回家， out 离家<br>                          "radius": 500, // 以经纬度为中心的范围半径（米）<br>                          "area": "深圳市南山区百度大厦", // 日出地区名称<br>                          "lon": "xx.xxxxxx", // 经度<br>                          "lat": "xx.xxxxxx", //纬度<br>                        },<br>                    "createTime": "2025-07-10 18:04:16",<br>                    "updateTime": "2025-07-10 18:04:16" <br>                }<br>            ]<br>        }<br>    ],<br>    "reqId": "123123123",<br>    "total": 8,<br>    "page": 1,<br>    "pageSize": 10<br>} |
| --- |

24.5 启用自动化 /auto/autoEnable

请求参数：

userId: 用户ID

autoId: 自动化ID

| JSON<br>{   <br>    "reqId": "123123123",<br>    "IntellID":"INTELL_9bsss8c7d6e5f",<br>    "IntellIds":["INTELL_9bsss8c7d6e5f",]<br>    "userId":"083990CDDEC01000"<br> } |
| --- |

响应参数： 

| JSON<br>{<br>    "code": 200,<br>    "msg": "success",<br>    "data": null,<br>    "reqId": "123123123"<br>} |
| --- |

24.6 禁用自动化 /auto/autoDisable

请求参数：

userId: 用户ID

autoId: 自动化ID

| JSON<br>{   <br>    "reqId": "123123123",<br>    "IntellID":"INTELL_9bsss8c7d6e5f",<br>    "IntellIds":["INTELL_9bsss8c7d6e5f",]<br>    "userId":"083990CDDEC01000"<br> } |
| --- |

响应参数： 

| JSON<br>{<br>    "code": 200,<br>    "msg": "success",<br>    "data": null,<br>    "reqId": "123123123"<br>} |
| --- |

24.7 手动执行自动化 （mqtt）

Uri:  /intell/act

topic：v1/family/xxxx/autoAct

xxxx为familyId

请求参数

intellId： 自动化id

| JSON<br>{   <br>    "reqId": "123123123",<br>    "sourceType":"device", //app或device<br>    "sourceId": "04d77ffce7801501",<br>    "intellId":"9bsss8c7d6e5f"<br> } |
| --- |

响应参数： 

| JSON<br>{<br>    "code": 200,<br>    "msg": "success",<br>    "reqId": "123123123"<br>} |
| --- |

24.8 电子围栏上报 （mqtt)

/intell/reportFence

topic：v1/family/xxxx/reportFence

xxxx为familyId

请求参数

action： 围栏动作（out：出围栏，in：进围栏）

familyId：家庭id

| JSON<br>{   <br>    "reqId": "123123123",<br>    "familyId":"adfasfsaeeedd", //mqtt的family广播可以不传<br>    "sourceType":"app", //app或device<br>    "sourceId": "04d77ffce7801502",<br>    "action":"in"<br> } |
| --- |

响应参数： 

| JSON<br>{<br>    "code": 200,<br>    "msg": "success",<br>    "reqId": "123123123"<br>} |
| --- |

25. 设备组管理

25.1 创建设备组 (intent = dgAdd)

请求参数：

userId: 用户ID

familyId: 家庭ID

groupName: 组名称

deviceList: 设备ID列表

响应参数：设备组对象

25.2 编辑设备组 (intent = dgEdit)

请求参数：

userId: 用户ID

groupId: 组ID

groupName: 新名称

deviceList: 新设备列表

响应参数：更新后的设备组

25.3 删除设备组 (intent = dgDel)

请求参数：

userId: 用户ID

groupId: 组ID

响应参数：无单独参数

25.4 查询设备组 (intent = dgQuery)

请求参数：

famiyId: 家庭ID

uid/userId: 网关或用户ID

updateTimestamp: 增量查询时间戳（毫秒）

响应参数：

| JSON<br>{<br>  "groupList": [<br>    {设备组对象1},<br>    {设备组对象2}<br>  ]<br>} |
| --- |

26. 图片或文件上传和删除（https）

26.1 上传图片或文件

Uri: /file/upload

Content-Type：multipart/form-data

请求参数：

file： 文件 (支持格式：bmp, gif, jpg, jpeg, png, doc, docx, xls, xlsx, ppt, pptx, html, htm, txt, rar, zip, gz, bz2, mp4, avi, rmvb, pdf)

返回参数：

| JSON<br>{<br>    "code": 200,<br>    "msg": null,<br>    "data": {<br>        "name": "2024_Predator_option_02_3840x2400_20250704154913A001.jpg",<br>        "url": "https://admin.huigxc-test.com:8043/statics/2025/07/04/2024_Predator_option_02_3840x2400_20250704154913A001.jpg"<br>    }<br>} |
| --- |

26.1 删除图片或文件

Uri: /file/del

请求参数：

| JSON<br>{<br>    "fileUrl":"https://admin.huigxc-test.com:8043/statics/2025/07/04/2024_Predator_option_02_3840x2400_20250704154913A001.jpg"<br>} |
| --- |

返回参数：

| JSON<br>{<br>    "code": 200,<br>    "msg": null,<br>    "data": null<br>} |
| --- |

27. 服务器通知 (intent = serverNotify)

Topic:  v1/family/{familyId}/serverNotify

v1/{mid}/serverNotify

推送参数：

notifyType: String 通知类型

"dataUpdata"：数据更新通知

"ota":  ota相关通知

triggerType 触发通知来源类型， 取值为device、server、app

triggerId 触发通知来源id， 取值为设备uid、aspId （triggerType=device或app时，有该字段）

data：通知数据json结构, 根据notifyType值不同，有不同的字段和含义

27.1 数据更新通知

notifyType="dataUpdata"：

dataType: 数据类型list

["device"] : 设备数据更新

["family"]： 家庭数据更新

["deviceProps"]：设备属性更新

["userInfo"]：用户信息更新

["intell"]：自动化数据更新

["room"]：房间数据更新

["floor"]：楼层数据更新

["tags"]：标签更新

["deviceParams"] 设备参数

["mem"] ：家庭成员更新

["intellCtrl"] ：表示单次定时全部执行完后自动禁用，触发的intell变化通知，此时不通知"intell", 只通知"intellCtrl"

lastUpdateTime： 增量更新查询时间戳（毫秒）， 0表示全量查询

triggerType：非必填，取值包括device、app、server

triggerId：非必填，取值包括uid， aspId

| JSON<br>{<br>  "notifyType": "dataUpdate", <br>  "data":{<br>      "dataType": ["device", "intell"], //通知更新的表<br>      "lastUpdateTime": 11111111111111 // 增量更新查询时间戳（毫秒）<br>  }<br>  "triggerType": "device",<br>  "triggerId":"${uid}"<br>} |
| --- |

| JSON<br>{<br>  "notifyType": "dataUpdate", <br>  "data":{<br>      "dataType": ["intellCtrl"], //表示单次定时全部执行完后自动禁用时的intell变化通知<br>      "lastUpdateTime": 11111111111111 // 增量更新查询时间戳（毫秒）<br>  }<br>  "triggerType": "server"<br>} |
| --- |

27.2 OTA通知

notifyType = "ota"：

dataType: 数据分类list

["result"]: OTA升级结果通知

["newVer"]: OTA新版本通知

status : 升级结果通知, 状态：0-待升级，1-下载中，2-下载完成，3-验证中，4-升级中，5-成功，6-失败

ver: 新版本版本号 （新版本通知）

fileUrl： 新版本下载地址 （新版本通知）

| JSON<br>{<br>  "notifyType": "ota",   <br>  "data":{<br>      "dataType": ["newVer"],<br>      "ver":"v2.3.1",<br>      "fileUrl": "xxx"<br>  }<br>  "triggerType": "server"<br>} |
| --- |

27.3 日志上传开关通知

notifyType = "logSwitchOn"：

| JSON<br>{<br>  "notifyType": "logSwitchOn",   <br>  "triggerType": "server"<br>} |
| --- |

27.4 服务器事件通知

notifyType = "serverEvent"：

eventName = "firstLogin"， 设备首次登录(判断服务器存储的retTag=null)：

| JSON<br>{<br>  "notifyType": "serverEvent",<br>  "data":{<br>      "eventName":"firstLogin",<br>      "uid":"xxx"<br>  }<br>} |
| --- |

eventName = "resetDone"， 设备重置服务器处理完成：

| JSON<br>{<br>  "notifyType": "serverEvent",<br>  "data":{<br>      "eventName":"resetDone",<br>      "uid":"xxx"<br>  }<br>} |
| --- |

eventName = "thirdException"，第三方异常事件通知

| JSON<br>{<br>  "notifyType": "serverEvent",<br>  "data":{<br>      "eventName":"thirdException",<br>      "code": 10020, //追觅token失效错误码<br>      "userId":"xxx"<br>  }<br>} |
| --- |

27.5 天气更新通知

| JSON<br>{<br>  "notifyType": "weather", <br>  "data":{<br>       //天气请求<br>       "request":{"reqId":"reqId42830","location":"114.0683,22.5455"},<br>       //天气内容<br>       "result":{"cloud":"2","dew":"6","feelsLike":"17","humidity":"44","icon":"100","obsTime":"2026-01-05 15:40:00","precip":"0.0","pressure":"1012","temp":"20","text":"晴","vis":"19","wind360":"45","windDir":"东北风","windScale":"4","windSpeed":"20"}<br>  }<br>  "triggerType": "device",<br>  "triggerId":"${uid}"<br>} |
| --- |

28. 设备品类管理（https）

28.1 添加设备品类

Uri: /mgr/productCategories/add

请求参数：

| JSON<br>{<br>    "reqId": "57fb756ba9a540088a9179383a420a24",<br>    "data": [<br>        {<br>          "deviceType": "string",  // 产品一级品类<br>          "subDeviceType": "string",  // 产品二级品类<br>          "categoryName": "string",  // 品类名称<br>          "categoryCode": "string",  // 品类编码<br>          "parentCategoryId": integer,  // 父品类ID，一级品类时为NULL<br>          "sortOrder": integer,  // 排序<br>          "standardFunctions": "string",  // 标准功能定义，包含标准UI、语音功能定义<br>          "description": "string"  // 品类描述<br>        },<br>        {<br>          "deviceType": "string",  // 产品一级品类<br>          "subDeviceType": "string",  // 产品二级品类<br>          "categoryName": "string",  // 品类名称<br>          "categoryCode": "string",  // 品类编码<br>          "parentCategoryId": integer,  // 父品类ID，一级品类时为NULL<br>          "sortOrder": integer,  // 排序<br>          "standardFunctions": "string",  // 标准功能定义，包含标准UI、语音功能定义<br>          "description": "string"  // 品类描述<br>        }<br>  ]<br>} |
| --- |

响应参数： 

| JSON<br>{<br>  "msg": "success",<br>  "code": 200,<br>  "reqId": "57fb756ba9a540088a9179383a420a24",<br>  "data": [<br>        {<br>          "id": 1,<br>          "deviceType": "string",  // 产品一级品类<br>          "subDeviceType": "string",  // 产品二级品类<br>          "categoryName": "string",  // 品类名称<br>          "categoryCode": "string",  // 品类编码<br>          "parentCategoryId": integer,  // 父品类ID，一级品类时为NULL<br>          "sortOrder": integer,  // 排序<br>          "standardFunctions": "string",  // 标准功能定义，包含标准UI、语音功能定义<br>          "description": "string" ,<br>          "createTime": "2025-06-05 18:34:30",<br>          "updateTime": "2025-06-05 18:35:30",<br>          "valid": 1<br>        },<br>        {<br>          "id": 2,<br>           "deviceType": "string",  // 产品一级品类<br>          "subDeviceType": "string",  // 产品二级品类<br>          "categoryName": "string",  // 品类名称<br>          "categoryCode": "string",  // 品类编码<br>          "parentCategoryId": integer,  // 父品类ID，一级品类时为NULL<br>          "sortOrder": integer,  // 排序<br>          "standardFunctions": "string",  // 标准功能定义，包含标准UI、语音功能定义<br>          "description": "string" ,<br>          "createTime": "2025-06-05 18:34:30",<br>          "updateTime": "2025-06-05 18:35:30",<br>          "valid": 1<br>        }<br>  ]<br>} |
| --- |

28.2 编辑设备品类

Uri: /mgr/productCategories/edit

请求参数：

| JSON<br>{<br>    "reqId": "57fb756ba9a540088a9179383a420a24",<br>    "data": [<br>       {<br>          "id": 1,<br>          "deviceType": "string",  // 产品一级品类<br>          "subDeviceType": "string",  // 产品二级品类<br>          "categoryName": "string",  // 品类名称<br>          "categoryCode": "string",  // 品类编码<br>          "parentCategoryId": integer,  // 父品类ID，一级品类时为NULL<br>          "sortOrder": integer,  // 排序<br>          "standardFunctions": "string",  // 标准功能定义，包含标准UI、语音功能定义<br>          "description": "string" <br>        },<br>        {<br>          "id": 2,<br>           "deviceType": "string",  // 产品一级品类<br>          "subDeviceType": "string",  // 产品二级品类<br>          "categoryName": "string",  // 品类名称<br>          "categoryCode": "string",  // 品类编码<br>          "parentCategoryId": integer,  // 父品类ID，一级品类时为NULL<br>          "sortOrder": integer,  // 排序<br>          "standardFunctions": "string",  // 标准功能定义，包含标准UI、语音功能定义<br>          "description": "string"<br>        }<br>  ]<br>} |
| --- |

响应参数： 

data: 设备参数列表

| JSON<br>{<br>   "reqId": "57fb756ba9a540088a9179383a420a24",<br>  "msg": "success",<br>  "code": 200,<br>    "data": [<br>         {<br>          "id": 1,<br>          "deviceType": "string",  // 产品一级品类<br>          "subDeviceType": "string",  // 产品二级品类<br>          "categoryName": "string",  // 品类名称<br>          "categoryCode": "string",  // 品类编码<br>          "parentCategoryId": integer,  // 父品类ID，一级品类时为NULL<br>          "sortOrder": integer,  // 排序<br>          "standardFunctions": "string",  // 标准功能定义，包含标准UI、语音功能定义<br>          "description": "string" <br>        },<br>        {<br>          "id": 2,<br>           "deviceType": "string",  // 产品一级品类<br>          "subDeviceType": "string",  // 产品二级品类<br>          "categoryName": "string",  // 品类名称<br>          "categoryCode": "string",  // 品类编码<br>          "parentCategoryId": integer,  // 父品类ID，一级品类时为NULL<br>          "sortOrder": integer,  // 排序<br>          "standardFunctions": "string",  // 标准功能定义，包含标准UI、语音功能定义<br>          "description": "string"<br>        }<br>  ]<br>} |
| --- |

28.3 删除设备品类

Uri: /mgr/productCategories/del

请求参数：

| JSON<br>{<br>    "reqId": "57fb756ba9a540088a9179383a420a24",<br>  "id": 1,<br>  "deviceType": "string",  // 产品一级品类<br>  "subDeviceType": "string",  // 产品二级品类<br>  "categoryName": "string",  // 品类名称<br>  "categoryCode": "string",  // 品类编码<br>} |
| --- |

响应参数： 

| JSON<br>{<br>"reqId": "57fb756ba9a540088a9179383a420a24",<br>  "msg": "success",<br>  "code": 200<br>} |
| --- |

28.4 查询设备品类

Uri: /mgr/productCategories/query

请求参数：

| JSON<br>{<br>    "reqId": "57fb756ba9a540088a9179383a420a24",<br>  "id": 1,<br>  "deviceType": "string",  // 产品一级品类<br>  "subDeviceType": "string",  // 产品二级品类<br>  "categoryName": "string",  // 品类名称<br>  "categoryCode": "string",  // 品类编码<br>} |
| --- |

响应参数： 

| JSON<br>{<br>  "msg": "success",<br>  "code": 200,<br>  "reqId": "57fb756ba9a540088a9179383a420a24",<br>  "data": [<br>       {<br>          "id": 1,<br>          "deviceType": "string",  // 产品一级品类<br>          "subDeviceType": "string",  // 产品二级品类<br>          "categoryName": "string",  // 品类名称<br>          "categoryCode": "string",  // 品类编码<br>          "parentCategoryId": integer,  // 父品类ID，一级品类时为NULL<br>          "sortOrder": integer,  // 排序<br>          "standardFunctions": "string",  // 标准功能定义，包含标准UI、语音功能定义<br>          "description": "string" ,<br>          "createTime": "2025-06-05 18:34:30",<br>          "updateTime": "2025-06-05 18:35:30",<br>          "valid": 1<br>        },<br>        {<br>          "id": 2,<br>           "deviceType": "string",  // 产品一级品类<br>          "subDeviceType": "string",  // 产品二级品类<br>          "categoryName": "string",  // 品类名称<br>          "categoryCode": "string",  // 品类编码<br>          "parentCategoryId": integer,  // 父品类ID，一级品类时为NULL<br>          "sortOrder": integer,  // 排序<br>          "standardFunctions": "string",  // 标准功能定义，包含标准UI、语音功能定义<br>          "description": "string" ,<br>          "createTime": "2025-06-05 18:34:30",<br>          "updateTime": "2025-06-05 18:35:30",<br>          "valid": 1<br>        }<br>   ]<br><br>} |
| --- |

29. 产品型号管理（https）

29.1 添加产品型号

Uri: /mgr/products/add

请求参数：

| JSON<br>{<br>    "reqId": "57fb756ba9a540088a9179383a420a24",<br>    "data": [<br>        {<br>          "productName": "string",  // 产品名称<br>          "deviceType": "string",  // 产品一级品类<br>          "subDeviceType": "string",  // 产品二级品类<br>          "pid": "string",  // 产品型号<br>          "brand": "string",  // 品牌<br>          "productImage": "string",  // 产品图片<br>          "deviceCategory": byte,  // 设备类型(1网关类设备, 2网关子设备, 3普通设备)<br>          "communicationMethod": byte,  // 通讯方式(1WiFi, 2zigbee, 3以太网, 4蓝牙)<br>          "modelId": "string",  // 唯一标识，根据规则生成<br>          "status": integer  // 状态(0.新建,1. 测试中,2.已发布)<br>        },<br>        {<br>          "productName": "string",  // 产品名称<br>          "deviceType": "string",  // 产品一级品类<br>          "subDeviceType": "string",  // 产品二级品类<br>          "pid": "string",  // 产品型号<br>          "brand": "string",  // 品牌<br>          "productImage": "string",  // 产品图片<br>          "deviceCategory": byte,  // 设备类型(1网关类设备, 2网关子设备, 3普通设备)<br>          "communicationMethod": byte,  // 通讯方式(1WiFi, 2zigbee, 3以太网, 4蓝牙)<br>          "modelId": "string",  // 唯一标识，根据规则生成<br>          "status": integer,  // 状态(0.新建,1. 测试中,2.已发布)<br>        }<br>  ]<br>} |
| --- |

响应参数： 

| JSON<br>{<br>  "msg": "success",<br>  "code": 200,<br>  "reqId": "57fb756ba9a540088a9179383a420a24",<br>  "data": [<br>        {<br>          "productName": "string",  // 产品名称<br>          "deviceType": "string",  // 产品一级品类<br>          "subDeviceType": "string",  // 产品二级品类<br>          "pid": "string",  // 产品型号<br>          "brand": "string",  // 品牌<br>          "productImage": "string",  // 产品图片<br>          "deviceCategory": byte,  // 设备类型(1网关类设备, 2网关子设备, 3普通设备)<br>          "communicationMethod": byte,  // 通讯方式(1WiFi, 2zigbee, 3以太网, 4蓝牙)<br>          "modelId": "string",  // 唯一标识，根据规则生成<br>          "status": integer,  // 状态(0.新建,1. 测试中,2.已发布)<br>          "valid": 1<br>        },<br>        {<br>          "productName": "string",  // 产品名称<br>          "deviceType": "string",  // 产品一级品类<br>          "subDeviceType": "string",  // 产品二级品类<br>          "pid": "string",  // 产品型号<br>          "brand": "string",  // 品牌<br>          "productImage": "string",  // 产品图片<br>          "deviceCategory": byte,  // 设备类型(1网关类设备, 2网关子设备, 3普通设备)<br>          "communicationMethod": byte,  // 通讯方式(1WiFi, 2zigbee, 3以太网, 4蓝牙)<br>          "modelId": "string",  // 唯一标识，根据规则生成<br>          "status": integer,  // 状态(0.新建,1. 测试中,2.已发布)<br>          "valid": 1<br>        }<br>  ]<br>} |
| --- |

29.2 编辑产品型号

Uri: /mgr/products/edit

请求参数：

| JSON<br>{<br>    "reqId": "57fb756ba9a540088a9179383a420a24",<br>    "data": [<br>       {<br>          "id": 1,<br>          "productName": "string",  // 产品名称<br>          "deviceType": "string",  // 产品一级品类<br>          "subDeviceType": "string",  // 产品二级品类<br>          "pid": "string",  // 产品型号<br>          "brand": "string",  // 品牌<br>          "productImage": "string",  // 产品图片<br>          "deviceCategory": byte,  // 设备类型(1网关类设备, 2网关子设备, 3普通设备)<br>          "communicationMethod": byte,  // 通讯方式(1WiFi, 2zigbee, 3以太网, 4蓝牙)<br>          "modelId": "string",  // 唯一标识，根据规则生成<br>          "status": integer,  // 状态(0.新建,1. 测试中,2.已发布)<br>          "valid": 1<br>        },<br>        {<br>          "id": 2,<br>           "productName": "string",  // 产品名称<br>          "deviceType": "string",  // 产品一级品类<br>          "subDeviceType": "string",  // 产品二级品类<br>          "pid": "string",  // 产品型号<br>          "brand": "string",  // 品牌<br>          "productImage": "string",  // 产品图片<br>          "deviceCategory": byte,  // 设备类型(1网关类设备, 2网关子设备, 3普通设备)<br>          "communicationMethod": byte,  // 通讯方式(1WiFi, 2zigbee, 3以太网, 4蓝牙)<br>          "modelId": "string",  // 唯一标识，根据规则生成<br>          "status": integer,  // 状态(0.新建,1. 测试中,2.已发布)<br>          "valid": 1<br>        }<br>  ]<br>} |
| --- |

响应参数： 

data: 设备参数列表

| JSON<br>{<br>   "reqId": "57fb756ba9a540088a9179383a420a24",<br>  "msg": "success",<br>  "code": 200,<br>    "data": [<br>         {<br>          "id": 1,<br>          "productName": "string",  // 产品名称<br>          "deviceType": "string",  // 产品一级品类<br>          "subDeviceType": "string",  // 产品二级品类<br>          "pid": "string",  // 产品型号<br>          "brand": "string",  // 品牌<br>          "productImage": "string",  // 产品图片<br>          "deviceCategory": byte,  // 设备类型(1网关类设备, 2网关子设备, 3普通设备)<br>          "communicationMethod": byte,  // 通讯方式(1WiFi, 2zigbee, 3以太网, 4蓝牙)<br>          "modelId": "string",  // 唯一标识，根据规则生成<br>          "status": integer,  // 状态(0.新建,1. 测试中,2.已发布)<br>          "valid": 1<br>        },<br>        {<br>          "id": 2,<br>           "productName": "string",  // 产品名称<br>          "deviceType": "string",  // 产品一级品类<br>          "subDeviceType": "string",  // 产品二级品类<br>          "pid": "string",  // 产品型号<br>          "brand": "string",  // 品牌<br>          "productImage": "string",  // 产品图片<br>          "deviceCategory": byte,  // 设备类型(1网关类设备, 2网关子设备, 3普通设备)<br>          "communicationMethod": byte,  // 通讯方式(1WiFi, 2zigbee, 3以太网, 4蓝牙)<br>          "modelId": "string",  // 唯一标识，根据规则生成<br>          "status": integer,  // 状态(0.新建,1. 测试中,2.已发布)<br>          "valid": 1<br>        }<br>  ]<br>} |
| --- |

29.3 删除产品型号

Uri: /mgr/products/del

请求参数：

| JSON<br>{<br>  "reqId": "57fb756ba9a540088a9179383a420a24",<br>  "id": 1,<br>  "deviceType": "string",  // 产品一级品类<br>  "subDeviceType": "string",  // 产品二级品类<br>  "pid": "string" // 品类名称<br>} |
| --- |

响应参数： 

| JSON<br>{<br>"reqId": "57fb756ba9a540088a9179383a420a24",<br>  "msg": "success",<br>  "code": 200<br>} |
| --- |

29.4 查询产品型号

Uri: /mgr/products/query

请求参数：

| JSON<br>{<br>  "reqId": "57fb756ba9a540088a9179383a420a24",<br>  "id": 1,<br>  "deviceType": "string",  // 产品一级品类<br>  "subDeviceType": "string",  // 产品二级品类<br>  "pid": "string" // 品类名称<br>} |
| --- |

响应参数： 

| JSON<br>{<br>  "msg": "success",<br>  "code": 200,<br>  "reqId": "57fb756ba9a540088a9179383a420a24",<br>  "data": [<br>       {<br>          "id": 1,<br>          "productName": "string",  // 产品名称<br>          "deviceType": "string",  // 产品一级品类<br>          "subDeviceType": "string",  // 产品二级品类<br>          "pid": "string",  // 产品型号<br>          "brand": "string",  // 品牌<br>          "productImage": "string",  // 产品图片<br>          "deviceCategory": byte,  // 设备类型(1网关类设备, 2网关子设备, 3普通设备)<br>          "communicationMethod": byte,  // 通讯方式(1WiFi, 2zigbee, 3以太网, 4蓝牙)<br>          "modelId": "string",  // 唯一标识，根据规则生成<br>          "status": integer,  // 状态(0.新建,1. 测试中,2.已发布)<br>          "createTime": "2025-06-05 18:34:30",<br>          "updateTime": "2025-06-05 18:35:30",<br>          "valid": 1<br>        },<br>        {<br>          "id": 2,<br>           "deviceType": "string",  // 产品一级品类<br>          "productName": "string",  // 产品名称<br>          "deviceType": "string",  // 产品一级品类<br>          "subDeviceType": "string",  // 产品二级品类<br>          "pid": "string",  // 产品型号<br>          "brand": "string",  // 品牌<br>          "productImage": "string",  // 产品图片<br>          "deviceCategory": byte,  // 设备类型(1网关类设备, 2网关子设备, 3普通设备)<br>          "communicationMethod": byte,  // 通讯方式(1WiFi, 2zigbee, 3以太网, 4蓝牙)<br>          "modelId": "string",  // 唯一标识，根据规则生成<br>          "status": integer,  // 状态(0.新建,1. 测试中,2.已发布)<br>          "createTime": "2025-06-05 18:34:30",<br>          "updateTime": "2025-06-05 18:35:30",<br>          "valid": 1<br>        }<br>   ]<br><br>} |
| --- |

30. 产品配置管理（https）

30.1 添加产品配置

Uri: /mgr/productConfigurations/add

请求参数：

| JSON<br>{<br>    "reqId": "57fb756ba9a540088a9179383a420a24",<br>    "data": [<br>        {<br>          "productId": integer,  // 产品ID, 对应products表中的id字段<br>          "deviceType": "string",  // 产品一级品类<br>          "subDeviceType": "string",  // 产品二级品类<br>          "pid": "string",  // 产品型号<br>          "functionDefinition": "string",  // 功能定义<br>          "objectModelDefinition": "string",  // 物模型定义<br>          "networkGuide": "string",  // 配网引导<br>          "multilingualConfig": "string",  // 多语言配置<br>          "sceneLinkageConfig": "string",  // 场景联动配置<br>          "voiceFunctionConfig": "string",  // 语音功能定义<br>          "uiComponentConfig": "string",  // UI组件配置<br>          "productManual": "string",  // 产品说明书<br>          "usageHelp": "string",  // 使用帮助<br>          "faq": "string",  // 常见问题<br>        },<br>        {<br>          "productId": integer,  // 产品ID, 对应products表中的id字段<br>          "deviceType": "string",  // 产品一级品类<br>          "subDeviceType": "string",  // 产品二级品类<br>          "pid": "string",  // 产品型号<br>          "functionDefinition": "string",  // 功能定义<br>          "objectModelDefinition": "string",  // 物模型定义<br>          "networkGuide": "string",  // 配网引导<br>          "multilingualConfig": "string",  // 多语言配置<br>          "sceneLinkageConfig": "string",  // 场景联动配置<br>          "voiceFunctionConfig": "string",  // 语音功能定义<br>          "uiComponentConfig": "string",  // UI组件配置<br>          "productManual": "string",  // 产品说明书<br>          "usageHelp": "string",  // 使用帮助<br>          "faq": "string",  // 常见问题<br>        }<br>  ]<br>} |
| --- |

响应参数： 

| JSON<br>{<br>  "msg": "success",<br>  "code": 200,<br>  "reqId": "57fb756ba9a540088a9179383a420a24",<br>  "data": [<br>        {<br>          "id": 1,<br>          "productId": integer,  // 产品ID, 对应products表中的id字段<br>          "deviceType": "string",  // 产品一级品类<br>          "subDeviceType": "string",  // 产品二级品类<br>          "pid": "string",  // 产品型号<br>          "functionDefinition": "string",  // 功能定义<br>          "objectModelDefinition": "string",  // 物模型定义<br>          "networkGuide": "string",  // 配网引导<br>          "multilingualConfig": "string",  // 多语言配置<br>          "sceneLinkageConfig": "string",  // 场景联动配置<br>          "voiceFunctionConfig": "string",  // 语音功能定义<br>          "uiComponentConfig": "string",  // UI组件配置<br>          "productManual": "string",  // 产品说明书<br>          "usageHelp": "string",  // 使用帮助<br>          "faq": "string",  // 常见问题<br>          "createTime": "yyyy-MM-ddTHH:mm:ss",  // 创建时间<br>          "updateTime": "yyyy-MM-ddTHH:mm:ss",  // 更新时间<br>          "valid": byte  // 是否有效(0-无效,1-有效)<br>        },<br>        {<br>          "id": 2,<br>          "productId": integer,  // 产品ID, 对应products表中的id字段<br>           "deviceType": "string",  // 产品一级品类<br>          "subDeviceType": "string",  // 产品二级品类<br>          "pid": "string",  // 产品型号<br>          "functionDefinition": "string",  // 功能定义<br>          "objectModelDefinition": "string",  // 物模型定义<br>          "networkGuide": "string",  // 配网引导<br>          "multilingualConfig": "string",  // 多语言配置<br>          "sceneLinkageConfig": "string",  // 场景联动配置<br>          "voiceFunctionConfig": "string",  // 语音功能定义<br>          "uiComponentConfig": "string",  // UI组件配置<br>          "productManual": "string",  // 产品说明书<br>          "usageHelp": "string",  // 使用帮助<br>          "faq": "string",  // 常见问题<br>          "createTime": "yyyy-MM-ddTHH:mm:ss",  // 创建时间<br>          "updateTime": "yyyy-MM-ddTHH:mm:ss",  // 更新时间<br>          "valid": byte  // 是否有效(0-无效,1-有效)<br>        }<br>  ]<br>} |
| --- |

30.2 编辑产品配置

Uri: /mgr/productConfigurations/edit

请求参数：

| JSON<br>{<br>    "reqId": "57fb756ba9a540088a9179383a420a24",<br>    "data": [<br>       {<br>          "id": 1,<br>          "productId": integer,  // 产品ID, 对应products表中的id字段<br>          "deviceType": "string",  // 产品一级品类<br>          "subDeviceType": "string",  // 产品二级品类<br>          "pid": "string",  // 产品型号<br>          "functionDefinition": "string",  // 功能定义<br>          "objectModelDefinition": "string",  // 物模型定义<br>          "networkGuide": "string",  // 配网引导<br>          "multilingualConfig": "string",  // 多语言配置<br>          "sceneLinkageConfig": "string",  // 场景联动配置<br>          "voiceFunctionConfig": "string",  // 语音功能定义<br>          "uiComponentConfig": "string",  // UI组件配置<br>          "productManual": "string",  // 产品说明书<br>          "usageHelp": "string",  // 使用帮助<br>          "faq": "string",  // 常见问题<br>        },<br>        {<br>          "id": 2,<br>          "productId": integer,  // 产品ID, 对应products表中的id字段<br>          "deviceType": "string",  // 产品一级品类<br>          "subDeviceType": "string",  // 产品二级品类<br>          "pid": "string",  // 产品型号<br>          "functionDefinition": "string",  // 功能定义<br>          "objectModelDefinition": "string",  // 物模型定义<br>          "networkGuide": "string",  // 配网引导<br>          "multilingualConfig": "string",  // 多语言配置<br>          "sceneLinkageConfig": "string",  // 场景联动配置<br>          "voiceFunctionConfig": "string",  // 语音功能定义<br>          "uiComponentConfig": "string",  // UI组件配置<br>          "productManual": "string",  // 产品说明书<br>          "usageHelp": "string",  // 使用帮助<br>          "faq": "string",  // 常见问题<br>        }<br>  ]<br>} |
| --- |

响应参数： 

data: 设备参数列表

| JSON<br>{<br>   "reqId": "57fb756ba9a540088a9179383a420a24",<br>  "msg": "success",<br>  "code": 200,<br>    "data": [<br>        {<br>          "id": 1,<br>          "productId": integer,  // 产品ID, 对应products表中的id字段<br>          "deviceType": "string",  // 产品一级品类<br>          "subDeviceType": "string",  // 产品二级品类<br>          "pid": "string",  // 产品型号<br>          "functionDefinition": "string",  // 功能定义<br>          "objectModelDefinition": "string",  // 物模型定义<br>          "networkGuide": "string",  // 配网引导<br>          "multilingualConfig": "string",  // 多语言配置<br>          "sceneLinkageConfig": "string",  // 场景联动配置<br>          "voiceFunctionConfig": "string",  // 语音功能定义<br>          "uiComponentConfig": "string",  // UI组件配置<br>          "productManual": "string",  // 产品说明书<br>          "usageHelp": "string",  // 使用帮助<br>          "faq": "string",  // 常见问题<br>        },<br>        {<br>          "id": 2,<br>          "productId": integer,  // 产品ID, 对应products表中的id字段<br>          "deviceType": "string",  // 产品一级品类<br>          "subDeviceType": "string",  // 产品二级品类<br>          "pid": "string",  // 产品型号<br>          "functionDefinition": "string",  // 功能定义<br>          "objectModelDefinition": "string",  // 物模型定义<br>          "networkGuide": "string",  // 配网引导<br>          "multilingualConfig": "string",  // 多语言配置<br>          "sceneLinkageConfig": "string",  // 场景联动配置<br>          "voiceFunctionConfig": "string",  // 语音功能定义<br>          "uiComponentConfig": "string",  // UI组件配置<br>          "productManual": "string",  // 产品说明书<br>          "usageHelp": "string",  // 使用帮助<br>          "faq": "string",  // 常见问题<br>        }<br>  ]<br>} |
| --- |

30.3 删除产品配置

Uri: /mgr/productConfigurations/del

请求参数：

| JSON<br>{<br>      "reqId": "57fb756ba9a540088a9179383a420a24",<br>      "id": 1,<br>      "deviceType": "string",  // 产品一级品类<br>      "subDeviceType": "string",  // 产品二级品类<br>      "pid": "string",  // 产品型号<br>} |
| --- |

响应参数： 

| JSON<br>{<br>"reqId": "57fb756ba9a540088a9179383a420a24",<br>  "msg": "success",<br>  "code": 200<br>} |
| --- |

30.4 查询产品配置

Uri: /mgr/productConfigurations/query

请求参数：

| JSON<br>{<br>    "reqId": "57fb756ba9a540088a9179383a420a24",<br>      "id": 1,<br>      "deviceType": "string",  // 产品一级品类<br>      "subDeviceType": "string",  // 产品二级品类<br>      "pid": "string",  // 产品型号<br>} |
| --- |

响应参数： 

| JSON<br>{<br>  "msg": "success",<br>  "code": 200,<br>  "reqId": "57fb756ba9a540088a9179383a420a24",<br>  "data": [<br>       {<br>          "id": 1,<br>          "productId": integer,  // 产品ID, 对应products表中的id字段<br>          "deviceType": "string",  // 产品一级品类<br>          "subDeviceType": "string",  // 产品二级品类<br>          "pid": "string",  // 产品型号<br>          "functionDefinition": "string",  // 功能定义<br>          "objectModelDefinition": "string",  // 物模型定义<br>          "networkGuide": "string",  // 配网引导<br>          "multilingualConfig": "string",  // 多语言配置<br>          "sceneLinkageConfig": "string",  // 场景联动配置<br>          "voiceFunctionConfig": "string",  // 语音功能定义<br>          "uiComponentConfig": "string",  // UI组件配置<br>          "productManual": "string",  // 产品说明书<br>          "usageHelp": "string",  // 使用帮助<br>          "faq": "string",  // 常见问题<br>          "createTime": "2025-06-05 18:34:30",<br>          "updateTime": "2025-06-05 18:35:30",<br>          "valid": 1<br>        },<br>        {<br>          "id": 2,<br>          "productId": integer,  // 产品ID, 对应products表中的id字段<br>          "deviceType": "string",  // 产品一级品类<br>          "subDeviceType": "string",  // 产品二级品类<br>          "pid": "string",  // 产品型号<br>          "functionDefinition": "string",  // 功能定义<br>          "objectModelDefinition": "string",  // 物模型定义<br>          "networkGuide": "string",  // 配网引导<br>          "multilingualConfig": "string",  // 多语言配置<br>          "sceneLinkageConfig": "string",  // 场景联动配置<br>          "voiceFunctionConfig": "string",  // 语音功能定义<br>          "uiComponentConfig": "string",  // UI组件配置<br>          "productManual": "string",  // 产品说明书<br>          "usageHelp": "string",  // 使用帮助<br>          "faq": "string",  // 常见问题<br>          "createTime": "2025-06-05 18:34:30",<br>          "updateTime": "2025-06-05 18:35:30",<br>          "valid": 1<br>        }<br>   ]<br><br>} |
| --- |

31. 产测接口（https）

31.1 获取证书(产测工具/app)

Uri: /auth/ca/cert

设备管理后台uri：/ca/cert

请求参数：

| JSON<br>{<br>    "uid":"abc", <br>    "mac":"aad",<br>    //取值hex/string等，传string，则证书cert字段返回为字符串格式，不传默认hex格式<br>    "certFormat": "string",  <br>    "derType": false, // true 时返回der格式证书，不传返回pem格式<br>    //reqFile 为申请证书请求文件的十六进制表示，非必填，如果不填，服务器自动生成秘钥对 <br>    //reqFile生成方式： openssl req -key c1.key -new -out c1.req -subj /CN="[mac:uuid]"<br>    "reqFile":"2D2D2D2D2D424547494E20434552544946494341544520524551554553542D2D2D2D2D0A4D49484F4D48594341514177464445534D424147413155454177774A573246685A447068596D4E644D466B77457759484B6F5A497A6A3043415159494B6F5A490A7A6A3044415163445167414542665278495833704C6B6A6676624A4B55795736694F514A346175337A556A57557856473538734476635A5258416D41387279470A4E44546B3066646342334948666F36664B6E457243486758346834584D58596F556141414D416F4743437147534D343942414D43413067414D455543494279780A45524265627A53512F554B39472F464F5031626255307A656A38707A50596B7661654B2B765A4B55416945417154474443335A45446F6E4D3948416C334959440A43664F446D415A4C767A343957464F706775516A51396B3D0A2D2D2D2D2D454E4420434552544946494341544520524551554553542D2D2D2D2D0A",<br>    "reqId":"dddeeeaddd"<br>} |
| --- |

响应参数： 

| JSON<br>{<br>    "code": 200,<br>    "msg": "SUCCESS",<br>    "reqId": "dddeeeaddd",<br>    "data": {<br>        "cert": "2D2D2D2D2D424547494E2043455254494649434154452D2D2D2D2D0D0A4D4949426444434341526D6741774942416749554C7A44745533696835694A5962465A6E747557436C745A79457A6777436759494B6F5A497A6A3045417749770D0A475445584D425547413155454177774F534564595131394454456C46546C5266513045774942634E4D6A55774E6A49334D4463774E7A4535576867504D6A45790D0A4E5441324D444D774E7A41334D546C614D425178456A415142674E5642414D4D435674685957513659574A6A5854425A4D424D4742797147534D3439416745470D0A43437147534D3439417745484130494142495067364D345061494C6777785939756E317871327174414A427977776D6F5A59486D676F54795A4362396678786C0D0A4255424138544169647448315A4753306C7768316A636158774B62464E484B547478574F4678536A516A42414D4230474131556444675157424253534F49744F0D0A414C6F39466F4D6B374F3359776B4342334E326B3054416642674E5648534D454744415767425361387A546A4E3642475362514B427137483355796A6B4E4A410D0A4F54414B42676771686B6A4F5051514441674E4A41444247416945416F6D6C444748775251322B2B412F5771744B2B4D493955754F777262666B3748675073460D0A42305077717949434951434D6B5474566432584A48375933527966736D4935666D4F3539492F32454F75615268394878684B324D34513D3D0D0A2D2D2D2D2D454E442043455254494649434154452D2D2D2D2D0D0A",<br>        "certSerial": "2f30ed5378a1e622586c5667b6e58296d6721338",<br>        //当请求参数reqFile有值时，返回服务器生成的： 密钥对key和公私钥keyInfo<br>        "key": "2D2D2D2D2D424547494E20454320504152414D45544552532D2D2D2D2D0D0A42676771686B6A4F50514D4242773D3D0D0A2D2D2D2D2D454E4420454320504152414D45544552532D2D2D2D2D0D0A2D2D2D2D2D424547494E2045432050524956415445204B45592D2D2D2D2D0D0A4D4863434151454549436978455453596C325645356A61576A54516B3532725370685554353552772B384B664D754E4A54544B796F416F4743437147534D34390D0A417745486F55514451674145672B446F7A67396F67754444466A323666584772617130416B484C444361686C6765614368504A6B4A76312F48475546514544780D0A4D434A323066566B5A4C53584348574E787066417073553063704F334659345846413D3D0D0A2D2D2D2D2D454E442045432050524956415445204B45592D2D2D2D2D0D0A",<br>        "keyInfo": {<br>            "privateKeyHex": "28B1113498976544E636968D3424E76AD2A61513E79470FBC29F32E3494D32B2",<br>            "publicKeyHex": "0483E0E8CE0F6882E0C3163DBA7D71AB6AAD009072C309A86581E68284F26426FD7F1C65054040F1302276D1F56464B49708758DC697C0A6C5347293B7158E1714"<br>        }<br>    }<br>} |
| --- |

31.2 校验证书（pad或app鉴权证书）

Uri: /auth/ca/certVerify

设备管理后台uri：/ca/certVerify

请求参数：

| JSON<br>{<br>    "uid":"abc", <br>    "mac":"aad",<br>    //证书文件十六进制<br>    "cert":"2D2D2D2D2D424547494E2043455254494649434154452D2D2D2D2D0D0A4D494942636A434341526D6741774942416749554C7A44745533696835694A5962465A6E747557436C745A79457A6F77436759494B6F5A497A6A3045417749770D0A475445584D425547413155454177774F534564595131394454456C46546C5266513045774942634E4D6A55774E6A49334D4463784E7A5130576867504D6A45790D0A4E5441324D444D774E7A45334E4452614D425178456A415142674E5642414D4D435674685957513659574A6A5854425A4D424D4742797147534D3439416745470D0A43437147534D3439417745484130494142415830635346393653354933373279536C4D6C756F6A6B4365477274383149316C4D565275664C413733475556774A0D0A67504B38686A5130354E4833584164794233364F6E7970784B776834462B4965467A46324B46476A516A42414D4230474131556444675157424251645453466C0D0A416B796862706B75556A594B4D374A567169786A417A416642674E5648534D454744415767425361387A546A4E3642475362514B427137483355796A6B4E4A410D0A4F54414B42676771686B6A4F5051514441674E4841444245416942724A626B56426C78624D395338646B385569536337446334654E4943326C5A4F36657957740D0A44526F4A436749674553433573426A6653366373634E4B57532F315632514F5A2F63724A2B696E64675A6E475A4553665444773D0D0A2D2D2D2D2D454E442043455254494649434154452D2D2D2D2D0D0A",<br>    "reqId":"dddeeeaddde"<br>} |
| --- |

响应参数： 

| JSON<br>{<br>    "code": 200,<br>    "msg": "SUCCESS",<br>    "reqId": "dddeeeaddde",<br>    "data": {<br>        //证书编号<br>        "certSerial": "2f30ed5378a1e622586c5667b6e58296d672133a",<br>        //校验结果，证书校验成功判断： code=200且verifyResult=true<br>        "verifyResult": true,<br>        "mac": "aad",<br>        "uid": "abc"<br>    }<br>} |
| --- |

31.3 查询证书列表（界面展示）

Uri: /auth/ca/query?pageNum=1&pageSize=10

设备管理后台uri：/ca/query?pageNum=1&pageSize=10

请求参数：

| JSON<br>{<br>    "uids": ["abcrrree","abcrrreeEEEa"], //非必填<br>    "reqId":"dddeeeaddd"<br>} |
| --- |

响应参数： 

| JSON<br>{<br>    "reqId": "dddeeeaddd",<br>    "msg": "success",<br>    "code": 200,<br>    "data": [<br>        {<br>            "id": 6,<br>            "uid": "abcrrree",<br>            "mac": "aad",<br>            "createTime": "2025-06-30 16:20:15",<br>            "updateTime": "2025-06-30 16:20:15",<br>            "valid": 1,<br>            "ver": null,<br>            "type": "der",<br>            "req": null,<br>            "key": "-----BEGIN EC PARAMETERS-----\r\nBggqhkjOPQMBBw==\r\n-----END EC PARAMETERS-----\r\n-----BEGIN EC PRIVATE KEY-----\r\nMHcCAQEEIA5CCVsRhC4mH+w1Qv9zJdHviqPyXUFWFU4T1VXlScTNoAoGCCqGSM49\r\nAwEHoUQDQgAEpgFhNOMD/ghcyq/SBobwrsfj0rKzQNCsL7MnkTO0DRLR/kRyjFra\r\nq2ggl0Kfbv+b2AGVu3R063sy3gsQHWERgg==\r\n-----END EC PRIVATE KEY-----\r\n",<br>            "cert": "-----BEGIN CERTIFICATE-----\r\nMIIBeTCCAR6gAwIBAgIULzDtU3ih5iJYbFZntuWCltZyE0IwCgYIKoZIzj0EAwIw\r\nGTEXMBUGA1UEAwwOSEdYQ19DTElFTlRfQ0EwIBcNMjUwNjMwMDgyMDEzWhgPMjEy\r\nNTA2MDYwODIwMTNaMBkxFzAVBgNVBAMMDlthYWQ6YWJjcnJyZWVdMFkwEwYHKoZI\r\nzj0CAQYIKoZIzj0DAQcDQgAEpgFhNOMD/ghcyq/SBobwrsfj0rKzQNCsL7MnkTO0\r\nDRLR/kRyjFraq2ggl0Kfbv+b2AGVu3R063sy3gsQHWERgqNCMEAwHQYDVR0OBBYE\r\nFEbNTL9vzsftPkQLgkKLhJkYkQ8xMB8GA1UdIwQYMBaAFJrzNOM3oEZJtAoGrsfd\r\nTKOQ0kA5MAoGCCqGSM49BAMCA0kAMEYCIQCdlSPVuXNtKon/26xZScHZ6BSEFfla\r\n0UX/SxUhYuP2tQIhAOv30FETv6lta+NWgpdzKxfX0REx64lyU10jO9a8qQWi\r\n-----END CERTIFICATE-----\r\n",<br>            "priKey": "0E42095B11842E261FEC3542FF7325D1EF8AA3F25D4156154E13D555E549C4CD",<br>            "pubKey": "04A6016134E303FE085CCAAFD20686F0AEC7E3D2B2B340D0AC2FB3279133B40D12D1FE44728C5ADAAB682097429F6EFF9BD80195BB7474EB7B32DE0B101D611182",<br>            "serial": "2f30ed5378a1e622586c5667b6e58296d6721342",<br>            "derCert": "308201793082011EA00302010202142F30ED5378A1E622586C5667B6E58296D6721342300A06082A8648CE3D04030230193117301506035504030C0E484758435F434C49454E545F43413020170D3235303633303038323031335A180F32313235303630363038323031335A30193117301506035504030C0E5B6161643A61626372727265655D3059301306072A8648CE3D020106082A8648CE3D03010703420004A6016134E303FE085CCAAFD20686F0AEC7E3D2B2B340D0AC2FB3279133B40D12D1FE44728C5ADAAB682097429F6EFF9BD80195BB7474EB7B32DE0B101D611182A3423040301D0603551D0E0416041446CD4CBF6FCEC7ED3E440B82428B849918910F31301F0603551D230418301680149AF334E337A04649B40A06AEC7DD4CA390D24039300A06082A8648CE3D04030203490030460221009D9523D5B9736D2A89FFDBAC5949C1D9E8148415F95AD145FF4B152162E3F6B5022100EBF7D05113BFA96D6BE3568297732B17D7D11131EB8972535D233BD6BCA905A2",<br>            "dver": null,<br>            "dtype": null<br>        },<br>        {<br>            "id": 7,<br>            "uid": "abcrrreeEEEa",<br>            "mac": "aad",<br>            "createTime": "2025-06-30 06:23:23",<br>            "updateTime": "2025-06-30 06:23:23",<br>            "valid": 1,<br>            "ver": null,<br>            "type": "pem",<br>            "req": null,<br>            "key": "-----BEGIN EC PARAMETERS-----\r\nBggqhkjOPQMBBw==\r\n-----END EC PARAMETERS-----\r\n-----BEGIN EC PRIVATE KEY-----\r\nMHcCAQEEICzFjXl8W6HGdjbgSfTuUoCQHkZX0cVx7tj1cTwwC7+8oAoGCCqGSM49\r\nAwEHoUQDQgAE3sH7R3rBzNOzcCniziBwdIlaEXwAaPBo0COA+7K55JcpsYQ/mztv\r\nVxP+CP9isUaSNV8BEZ2zBCW37K37ietCQg==\r\n-----END EC PRIVATE KEY-----\r\n",<br>            "cert": "-----BEGIN CERTIFICATE-----\r\nMIIBfDCCASKgAwIBAgIULzDtU3ih5iJYbFZntuWCltZyE0MwCgYIKoZIzj0EAwIw\r\nGTEXMBUGA1UEAwwOSEdYQ19DTElFTlRfQ0EwIBcNMjUwNjMwMDgyMzIxWhgPMjEy\r\nNTA2MDYwODIzMjFaMB0xGzAZBgNVBAMMElthYWQ6YWJjcnJyZWVFRUVhXTBZMBMG\r\nByqGSM49AgEGCCqGSM49AwEHA0IABN7B+0d6wczTs3Ap4s4gcHSJWhF8AGjwaNAj\r\ngPuyueSXKbGEP5s7b1cT/gj/YrFGkjVfARGdswQlt+yt+4nrQkKjQjBAMB0GA1Ud\r\nDgQWBBT+GRnHO4WV33U1nlx8GvvpfoC0ojAfBgNVHSMEGDAWgBSa8zTjN6BGSbQK\r\nBq7H3UyjkNJAOTAKBggqhkjOPQQDAgNIADBFAiAO2+KmI7Pk4qE4uHjlfC+WF/nE\r\nEoHBxWXBby4ygXECPAIhALarfGkxjMCsPiQxDqMRD4iNoW5SJNBFS3kQ0bZU3Ase\r\n-----END CERTIFICATE-----\r\n",<br>            "priKey": "2CC58D797C5BA1C67636E049F4EE5280901E4657D1C571EED8F5713C300BBFBC",<br>            "pubKey": "04DEC1FB477AC1CCD3B37029E2CE207074895A117C0068F068D02380FBB2B9E49729B1843F9B3B6F5713FE08FF62B14692355F01119DB30425B7ECADFB89EB4242",<br>            "serial": "2f30ed5378a1e622586c5667b6e58296d6721343",<br>            "derCert": "3082017C30820122A00302010202142F30ED5378A1E622586C5667B6E58296D6721343300A06082A8648CE3D04030230193117301506035504030C0E484758435F434C49454E545F43413020170D3235303633303038323332315A180F32313235303630363038323332315A301D311B301906035504030C125B6161643A6162637272726565454545615D3059301306072A8648CE3D020106082A8648CE3D03010703420004DEC1FB477AC1CCD3B37029E2CE207074895A117C0068F068D02380FBB2B9E49729B1843F9B3B6F5713FE08FF62B14692355F01119DB30425B7ECADFB89EB4242A3423040301D0603551D0E04160414FE1919C73B8595DF75359E5C7C1AFBE97E80B4A2301F0603551D230418301680149AF334E337A04649B40A06AEC7DD4CA390D24039300A06082A8648CE3D040302034800304502200EDBE2A623B3E4E2A138B878E57C2F9617F9C41281C1C565C16F2E328171023C022100B6AB7C69318CC0AC3E24310EA3110F888DA16E5224D0454B7910D1B654DC0B1E",<br>            "dver": null,<br>            "dtype": null<br>        }<br>    ],<br>    "total": 2,<br>    "page": 1,<br>    "pageSize": 10<br>} |
| --- |

31.4 批量生成设备

Uri: /mgr/gateway/batchGen

设备管理后台uri：/mgr/gateway/batchGen

请求参数：

| JSON<br>{<br>    "order": "订单号",  //订单号，必填<br>    "material": "料号",  //料号，必填<br>    "batchSize": 1000,  //设备数量，必填<br>    "pid": "20000000001",  //设备型号，必填<br>    "snProductType": "A",  //设备型号，必填<br>    "deviceType": "pad",  //设备类型，必填<br>    "reqId":"dddeeeaddd"<br>} |
| --- |

snProductType：见智能家居系统 产品条码管理规范中的【四.2.d】 ： 产品大类代码

A（中控屏）

B（开关）

C（插座）

D（窗帘电机）

E（传感器）

F（筒灯）

G（射灯）

H（面板灯）

I（磁吸轨道灯）

J（风扇灯）

K（温控器）

响应参数： 

| JSON<br>{<br>    "reqId": "dddeeeaddd",<br>    "msg": "success",<br>    "code": 200<br>} |
| --- |

31.5 查询设备列表

Uri: /mgr/gateway/query?pageNum=1&pageSize=10

设备管理后台uri：/mgr/gateway/query?pageNum=1&pageSize=10

URL排序参数：isAsc，orderByColumn

 isAsc：desc（降序）/asc（升序）

 orderByColumn: id/create_time/update_time

按id降序url示例：/mgr/gateway/query?pageNum=2&pageSize=10&isAsc=desc&orderByColumn=id

请求参数：

| JSON<br>{<br>    "order": "订单号", //订单号， 非必填<br>    "material": "料号", //料号， 非必填<br>    "pid": "20000000001",  //设备型号， 非必填<br>    "deviceType": "pad",  //设备类型， 非必填<br>    "beginTime":"2025-10-24 11:10:25",  //开始时间， 非必填<br>    "endTime": "2025-10-24 11:10:27", //结束时间， 非必填<br>    "reqId":"dddeeeaddd"<br>} |
| --- |

响应参数： 

| JSON<br>{<br>    "reqId": "dddeeeaddd",<br>    "msg": "success",<br>    "code": 200,<br>    "data": [<br>        {<br>            "id": 3,<br>            "uid": "04d772267cc05700",<br>            "pwd": "cbfa159cada44e80a67b9d5f739d4e76",<br>            "mac": "9a0ca04e0030",<br>            "createTime": "2025-06-30 06:56:47",<br>            "updateTime": "2025-06-30 06:56:47",<br>            "valid": 1,<br>            "ver": null,<br>            "firmwareVersion": null,<br>            "retTag": null,<br>            "deviceType": "pad",<br>            "subDeviceType": null,<br>            "pid": "20000000001",<br>            "modelId": null,<br>            "ip": null,<br>            "localIp": null,<br>            "os": null,<br>            "roomId": null,<br>            "floorId": null,<br>            "familyId": null,<br>            "city": null,<br>            "province": null,<br>            "country": null,<br>            "lon": null,<br>            "lat": null,<br>            "sn": "HG00125063000100006",<br>            "batchName": "batch01"<br>        },<br>        {<br>            "id": 4,<br>            "uid": "04d772267d005700",<br>            "pwd": "902111beb93e4a40b2b4208debf82c0a",<br>            "mac": "7a05a03e0130",<br>            "createTime": "2025-06-30 06:56:47",<br>            "updateTime": "2025-06-30 06:56:47",<br>            "valid": 1,<br>            "ver": null,<br>            "firmwareVersion": null,<br>            "retTag": null,<br>            "deviceType": "pad",<br>            "subDeviceType": null,<br>            "pid": "20000000001",<br>            "modelId": null,<br>            "ip": null,<br>            "localIp": null,<br>            "os": null,<br>            "roomId": null,<br>            "floorId": null,<br>            "familyId": null,<br>            "city": null,<br>            "province": null,<br>            "country": null,<br>            "lon": null,<br>            "lat": null,<br>            "sn": "HG00125063000100014",<br>            "batchName": "batch01"<br>        },<br>        {<br>            "id": 5,<br>            "uid": "04d772267d005701",<br>            "pwd": "96c0ae0798e34b03b9bcaa7356473c8e",<br>            "mac": "0a00a00e0230",<br>            "createTime": "2025-06-30 06:56:47",<br>            "updateTime": "2025-06-30 06:56:47",<br>            "valid": 1,<br>            "ver": null,<br>            "firmwareVersion": null,<br>            "retTag": null,<br>            "deviceType": "pad",<br>            "subDeviceType": null,<br>            "pid": "20000000001",<br>            "modelId": null,<br>            "ip": null,<br>            "localIp": null,<br>            "os": null,<br>            "roomId": null,<br>            "floorId": null,<br>            "familyId": null,<br>            "city": null,<br>            "province": null,<br>            "country": null,<br>            "lon": null,<br>            "lat": null,<br>            "sn": "HG00125063000100022",<br>            "batchName": "batch01"<br>        }<br>    ],<br>    "total": 1000,<br>    "page": 1,<br>    "pageSize": 3<br>} |
| --- |

31.6 更新设备信息

Uri: /mgr/gateway/edit

设备管理后台uri：/mgr/gateway/edit

请求参数：

| JSON<br>{<br>    "reqId":"dddeeeaddd",<br>    "data": [<br>        {<br>            "id": 3,<br>            "mac": "9a0ca04e0030"<br>        },<br>        {<br>            "id": 4,<br>            "mac": "7a05a03e0131"<br>        }<br>    ]<br>} |
| --- |

响应参数： 

| JSON<br>{<br>    "reqId": "dddeeeaddd",<br>    "msg": "success",<br>    "code": 200,<br>    "data": [<br>        {<br>            "id": 3,<br>            "mac": "9a0ca04e0030"<br>        },<br>        {<br>            "id": 4,<br>            "mac": "7a05a03e0131"<br>        }<br>    ]<br>} |
| --- |

32. 标签管理（https）

 字段含义见：数据库表设计 第20项 【标签表】

32.1 添加标签

Uri: /family/tags/add

增量新增，tags内容按key新增或覆盖，不会覆盖其他key

请求参数：

| JSON<br>{<br>    "reqId": "57fb756ba9a540088a9179383a420a23",<br>    "data": [<br>        {<br>          "familyId": "aabbcc123", <br>          "objectType": 0,   //目标类型（0:device,1:family,2:room,3:pid,4:）<br>          "objectId": "device123aabbcc",<br>          "tags": "{\"alias\":\"downlight\",\"deletedMeta\":\"房间 \| 设备名\"}",  //tag 内容（自定义），这里为示例<br>        },<br>         {<br>          "familyId": "aabbcc123", <br>          "objectType": 0,  <br>          "objectId": "device123aabbce",<br>          "tags":"{\"alias\":\"downlight\"}", <br>        }<br>  ]<br>} |
| --- |

其中tags为：json字符串格式； 

alias 别名字段的取值如下：

点击图片可查看完整电子表格

响应参数： 

| JSON<br>{<br>    "reqId": "57fb756ba9a540088a9179383a420a23",<br>    "msg": "success",<br>    "code": 200,<br>    "data": [<br>        {<br>            "id": 1,<br>            "familyId": "aabbcc123",<br>            "objectType": 0, <br>            "objectId": "device123aabbcc",<br>            "tags": "{\"alias\":\"downlight\"}"<br>        },<br>        {<br>            "id": 2,<br>            "familyId": "aabbcc123",<br>            "objectType": 0,<br>            "objectId": "device123aabbce",<br>            "tags": "{\"alias\":\"downlight\"}"<br>        }<br>    ]<br>} |
| --- |

32.2 编辑标签

Uri: /family/tags/edit

tags内容全覆盖

请求参数：

| JSON<br>{<br>    "reqId": "aaddee",<br>     "data": [<br>        {<br>            "id": 1,<br>            "familyId": "aabbcc123",<br>            "objectType": 0,<br>            "objectId": "device123aabbcc",<br>            "tags": "{\"alias\":\"downlight\"}"<br>        },<br>        {<br>            "id": 2,<br>            "familyId": "aabbcc123",<br>            "objectType": 0,<br>            "objectId": "device123aabbce",<br>            "tags": "{\"alias\":\"downlight\"}"<br>        }<br>    ]<br>       <br>} |
| --- |

响应参数： 

data: 设备参数列表

| JSON<br>{<br>    "reqId": "aaddee",<br>    "msg": "success",<br>    "code": 200,<br>    "data": [<br>        {<br>            "id": 1,<br>            "familyId": "aabbcc123",<br>            "objectType": 0,<br>            "objectId": "device123aabbcc",<br>            "tags": "{\"alias\":\"downlight\"}"<br>        },<br>        {<br>            "id": 2,<br>            "familyId": "aabbcc123",<br>            "objectType": 0,<br>            "objectId": "device123aabbce",<br>            "tags": "{\"alias\":\"downlight\"}"<br>        }<br>    ]<br>} |
| --- |

32.3 删除标签

Uri: /family/tags/del

请求参数：

| JSON<br>{<br>    "reqId": "aaabbbccc22",<br>    //"ids":[1,2,3]<br>    "id": 1 <br>} |
| --- |

响应参数： 

| JSON<br>{<br>    "reqId": "aaabbbccc22",<br>    "msg": "success",<br>    "code": 200<br>} |
| --- |

32.4 查询标签

Uri: /family/tags/query?pageNum=1&pageSize=3

请求参数：

reqId：String //必填 请求id

familyId：String //必填 家庭id

objectTypes：int数组 // 批量筛选标签类型objecType， 非必填，0:device,1:family,2:room,3:pid；4.设备遗言

| JSON<br>{<br>    "familyId":"aabbcc123", //必填<br>    "reqId":"aabbcc123",<br>    "objectTypes":[0,1,2,3] // 非必填<br>} |
| --- |

响应参数： 

| JSON<br>{<br>    "msg": "success",<br>    "code": 200,<br>    "data": [<br>        {<br>            "id": 1,<br>            "familyId": "aabbcc123",<br>            "objectType": 0,<br>            "objectId": "device123aabbcc",<br>            "tags": "{\"alias\":\"downlight\"}"<br>            "createTime": "2025-08-18 14:06:19",<br>            "updateTime": "2025-08-18 14:06:19",<br>            "valid": 1<br>        },<br>        {<br>            "id": 2,<br>            "familyId": "aabbcc123",<br>            "objectType": 0,<br>            "objectId": "device123aabbce",<br>            "tags": "{\"alias\":\"downlight\"}"<br>            "createTime": "2025-08-18 14:06:19",<br>            "updateTime": "2025-08-18 14:06:19",<br>            "valid": 1<br>        }<br>    ],<br>    "total": 2,<br>    "page": 1,<br>    "pageSize": 3<br>} |
| --- |

33. 虚拟设备组控制

请求参数：

properties: 控制属性(JSON对象)

ctrlType: 控制类型，如setProp设置属性， execFunc 执行方法等

Topic：v1/family/${familyId}/virtualGroupCtrl

基于某种规则去执行，后续可扩展为按照某种规则，查询出设备后，去做统一控制指令

写属性

| JSON<br>代码块<br>{<br>  "reqId": "dsadfaadsfvasfsa",<br>  "roomId": "1748328523123",<br>  "ctrlType":"setProp",<br>  "properties": {<br>    "onoff": "on"<br>  },<br>  "deviceTypes":{"curtain":[],"relay":["light.*"]},<br>  "sourceType":"app",<br>  "aspId": "1748328523125"<br>}<br><br>发命令  示例窗帘开<br>{<br>  "reqId": "dsadfaadsfvasfsa",<br>  "roomId": "1748328523123",<br>  "ctrlType":"execFunc",<br>  "commands": {<br>    "name": "action",<br>    "args":"open"<br>  },<br>  "deviceTypes":{"curtain":[],"relay":["light.*"]},<br>  "sourceType":"app",<br>  "aspId": "1748328523125"<br>} |
| --- |

34. 传感器设备或事件记录（https）

 字段含义见：数据库表设计 第21项 【传感器设备或事件记录表】

34.1 记录查询

Uri: /mgr/event/record/query?pageNum=1&pageSize=30

familyId: 家庭id

deviceId: 设备id

name: 事件或属性名称，如光照强度illumination，人存状态presenceState

reqId: 请求id

请求参数：

| JSON<br>{<br>    "reqId":"aabbcc123", //必填<br>    "familyId":"aabbcc123", //必填<br>    "deviceId":"aabbcc123", //必填<br>    "beginTime": "2025-12-16 00:00:00", //非必填<br>    "endTime": "2025-12-16 23:59:59", //非必填<br>    "name": "illumination" //必填<br>} |
| --- |

响应参数： 

| JSON<br>{<br>    "msg": "success",<br>    "code": 200,<br>    "data": [<br>        {<br>            "id": 31415926,<br>            "device_type": "xxx",<br>            "device_id": "25I02A102000032",<br>            "family_id": "F123456789",<br>            "name": "illumination",<br>            "val": "24", //光照强度lux，如name=presenceState，那么val=nobody，somebody<br>            "localtimestamp": 123445555555,<br>            "create_time": "2025-12-15 17:45:31",<br>            "update_time": "2025-12-15 17:45:31",<br>            "valid": 1<br>        },<br>        {<br>            "id": 323,<br>            "device_type": "xxx",<br>            "device_id": "xxx",<br>            "family_id": "F123456789",<br>            "name": "illumination",<br>            "val": "27",<br>            "localtimestamp": 123445555555,<br>            "create_time": "2025-12-15 17:45:31",<br>            "update_time": "2025-12-15 17:45:31",<br>            "valid": 1<br>        }<br>    ],<br>    "total": 2,<br>    "page": 1,<br>    "pageSize": 30<br>} |
| --- |

35.红外码库接口（https）

35.1 获取遥控码（家电）类型

Uri: /mgr/ir/listCategories

请求参数：

无

| JSON<br>{<br>  "reqId": "57fb756ba9a540088a9179383a420a24"<br>} |
| --- |

响应参数： 

| JSON<br>{<br>  "msg": "success",<br>  "code": 200,<br>  "reqId": "57fb756ba9a540088a9179383a420a24",<br>  "data": [<br>        {<br>            "id": 1,<br>            "name": "空调",<br>            "status": 1,<br>            "updateTime": "2016-11-27 11:00:00",<br>            "nameEn": "AC",<br>            "nameTw": "空調",<br>            "contributor": "strawmanbobi@irext.net"<br>        },<br>        {<br>            "id": 2,<br>            "name": "电视机",<br>            "status": 1,<br>            "updateTime": "2016-11-27 11:00:00",<br>            "nameEn": "TV",<br>            "nameTw": "電視機",<br>            "contributor": "strawmanbobi@irext.net"<br>        },<br>        {<br>            "id": 3,<br>            "name": "机顶盒",<br>            "status": 1,<br>            "updateTime": "2016-11-27 11:00:00",<br>            "nameEn": "STB",<br>            "nameTw": "機上盒",<br>            "contributor": "strawmanbobi@irext.net"<br>        }<br>        // ... 更多类型<br>   ]<br><br>} |
| --- |

35.2 获取遥控码（家电）品牌 

Uri: /mgr/ir/listBrands

请求参数：

点击图片可查看完整电子表格

| JSON<br>{<br>  "reqId": "57fb756ba9a540088a9179383a420a24",<br>  "categoryId": 2<br>} |
| --- |

响应参数： 

| JSON<br>{<br>  "msg": "success",<br>  "code": 200,<br>  "reqId": "57fb756ba9a540088a9179383a420a24",<br>  "data": [<br>        {<br>            "id": 17,<br>            "name": "创维",<br>            "categoryId": 2,<br>            "categoryName": "电视机",<br>            "status": 1,<br>            "updateTime": "2016-11-27 11:00:00",<br>            "priority": 1,<br>            "nameEn": "Skyworth",<br>            "nameTw": "創維",<br>            "contributor": "strawmanbobi@irext.net"<br>        },<br>        {<br>            "id": 22,<br>            "name": "海信",<br>            "categoryId": 2,<br>            "categoryName": "电视机",<br>            "status": 1,<br>            "updateTime": "2016-11-27 11:00:00",<br>            "priority": 2,<br>            "nameEn": "HISENSE",<br>            "nameTw": "海信",<br>            "contributor": "strawmanbobi@irext.net"<br>        }<br>   ]<br><br>} |
| --- |

35.3 列出所有省份

Uri: /mgr/ir/listProvinces

请求参数：

无

| JSON<br>{<br>  "reqId": "57fb756ba9a540088a9179383a420a24"<br>} |
| --- |

响应参数： 

| JSON<br>{<br>  "msg": "success",<br>  "code": 200,<br>  "reqId": "57fb756ba9a540088a9179383a420a24",<br>  "data": [<br>        {<br>            "id": 1,<br>            "code": "110000",<br>            "name": "北京市",<br>            "longitude": 116.3979471,<br>            "latitude": 39.9081726,<br>            "status": 1,<br>            "nameTw": "北京市"<br>        },<br>        {<br>            "id": 21,<br>            "code": "120000",<br>            "name": "天津市",<br>            "longitude": 117.2523808,<br>            "latitude": 39.1038561,<br>            "status": 1,<br>            "nameTw": "天津市"<br>        }<br>        // ... 更多省份<br>   ]<br><br>} |
| --- |

35.4 根据省份编码前缀列出地级市

Uri: /mgr/ir/listCities

请求参数：

点击图片可查看完整电子表格

| JSON<br>{<br>  "reqId": "57fb756ba9a540088a9179383a420a24",<br>  "provincePrefix": "42"<br>} |
| --- |

响应参数： 

| JSON<br>{<br>  "msg": "success",<br>  "code": 200,<br>  "reqId": "57fb756ba9a540088a9179383a420a24",<br>  "data": [<br>        {<br>            "id": 1709,<br>            "code": "420100",<br>            "name": "武汉市",<br>            "longitude": 114.3814194,<br>            "latitude": 30.5611616,<br>            "status": 2,<br>            "nameTw": "武漢市"<br>        },<br>        {<br>            "id": 1723,<br>            "code": "420200",<br>            "name": "黄石市",<br>            "longitude": 115.0385177,<br>            "latitude": 30.1996564,<br>            "status": 1,<br>            "nameTw": "黃石市"<br>        }<br>        // ... 更多城市<br>   ]<br><br>} |
| --- |

35.5 根据城市编码列出广电运营商

Uri: /mgr/ir/listOperators

请求参数：

点击图片可查看完整电子表格

| JSON<br>{<br>  "reqId": "57fb756ba9a540088a9179383a420a24",<br>  "cityCode": "420600"<br>} |
| --- |

响应参数： 

| JSON<br>{<br>  "msg": "success",<br>  "code": 200,<br>  "reqId": "57fb756ba9a540088a9179383a420a24",<br>  "data": [<br>          {<br>            "id": 218,<br>            "operatorId": "1292",<br>            "operatorName": "楚天襄阳有线",<br>            "cityCode": "420600",<br>            "cityName": "襄阳市",<br>            "status": 1,<br>            "operatorNameTw": ""<br>        },<br>        {<br>            "id": 219,<br>            "operatorId": "2547",<br>            "operatorName": "襄阳电信IPTV",<br>            "cityCode": "420600",<br>            "cityName": "襄阳市",<br>            "status": 1,<br>            "operatorNameTw": ""<br>        },<br>        {<br>            "id": 1063,<br>            "operatorId": "86313559",<br>            "operatorName": "湖北广电",<br>            "cityCode": "420600",<br>            "cityName": "襄阳市",<br>            "status": 1<br>        }<br>   ]<br><br>} |
| --- |

35.6 获取遥控码索引

Uri: /mgr/ir/listRemoteIndexes

请求参数：

点击图片可查看完整电子表格

| JSON<br>{<br>  "reqId": "57fb756ba9a540088a9179383a420a24",<br>  "brandId": 17,<br>  "categoryId": 3,<br>  "cityCode": "420600",<br>  "operatorId": "1292"<br>} |
| --- |

响应参数： 

| JSON<br>{<br>  "msg": "success",<br>  "code": 200,<br>  "reqId": "57fb756ba9a540088a9179383a420a24",<br>  "data": [<br>       {<br>            "id": 13111,<br>            "categoryId": 2,<br>            "categoryName": "电视机",<br>            "brandId": 17,<br>            "brandName": "创维",<br>            "protocol": "upd6121g",<br>            "remote": "remote_tv_collected_20",<br>            "status": 1,<br>            "priority": 5,<br>            "remoteNumber": "20",<br>            "binaryMd5": "7b46d491b8472f994fb487588ef9cec2",<br>            "contributor": "strawmanbobi@irext.net",<br>            "updateTime": "2025-10-15 21:22:00"<br>        }<br>        // ... 更多索引<br>   ]<br><br>} |
| --- |

35.7 在线解码

Uri: /mgr/ir/decodeIR

请求参数：

点击图片可查看完整电子表格

| JSON<br>{<br>  "reqId": "57fb756ba9a540088a9179383a420a24",<br>  "keyCode": 0,<br>  "indexId": 12261<br>} |
| --- |

响应参数： 

| JSON<br>{<br>  "msg": "success",<br>  "code": 200,<br>  "reqId": "57fb756ba9a540088a9179383a420a24",<br>  "data": [<br>        {<br>        "keyCode":0,<br>        "indexId": 12261<br>        "value": [9000, 4500, 560, 1690, 560, 565, 560, 565, 560, 565, 560, 565, 560, 565, 560, 565, 560, 565, 560, 1690, 560, 565, 560, 1690, 560, 1690, 560, 1690, 560, 1690, 560, 1690, 560, 1690, 560, 565, 560, 565, 560, 1690, 560, 1690, 560, 1690, 560, 565, 560, 1690, 560, 1690, 560, 1690, 560, 1690, 560, 565, 560, 565, 560, 565, 560, 1690, 560, 565, 560, 565, 560]<br>        }<br>   ]<br><br>} |
| --- |

35.8 获取IR的二进制码库

Uri: /mgr/ir/getIRBinaries

请求参数：

点击图片可查看完整电子表格

| JSON<br>{<br>  "reqId": "57fb756ba9a540088a9179383a420a24",<br>  "indexId": 12261<br>} |
| --- |

响应参数： 

| JSON<br>{<br>  "msg": "success",<br>  "code": 200,<br>  "reqId": "57fb756ba9a540088a9179383a420a24",<br>  "data": [<br>        {<br>            "indexId": 12261,<br>            "name":"xxx.bin",<br>            "value":"001d090010001800....." //file hex/base64? deviceType?  categoryId<br>            "value":[0,29,9,0,16,0,24,0,...]    // data file<br>        }<br>  ]<br>} |
| --- |